# Get-MachineData-EDR-SOAR-ActionsOnMachine
author: Kloudynet Technologies

This Playbook is for sending Microsoft Teams notification when an alert is generated by Defender for endpoint. Teams notifications should also include data about:
-	Machine Vulnerabilities
-	Missing KBs
-	Security Recommendations
-	Alerts
-	Software Inventory

Also should be able to perform some actions like:
-	App Execution
-	Start AV scan

## Prerequisites
1. Defender for Endpoint / MDATP / EDR
2. Microsoft SharePoint online
3. Microsoft Teams
4. Azure AD App registerd with the following permissions under "WindowsDefenderATP"
    - Alert.Read.Add
    - Alert.ReadWrite.All
    - Machine.Read.All
    - Machine.RestrictExecution
    - Machine.Scan
    - SecurityRecommendation.Read.All
    - Software.Read.All
    - Vulnerability.Read.All
5. Azure Keyvault - To store the App Secret of the Azure AD Application

## Setup
1. Create an Azure AD App from Azure AD App Registrations
2. Configure the App API Permissions
    - Refer above permissions mentioned under Prerequisites, point (4)
3. Generate a secret and store it in the Azure Keyvault
4. Deploy ARM template
5. Edit Playbook Configure connectors
    - Ensure all functions have been configured with their appropriate connectors
    - Setup HTTP connector - Provide the Tenant ID, client/app ID of the app you registered
    - Azure Key Vault - Provide the connection for the Azure Keyvault in which the client secret of the Azure AD App
    - SharePoint connection - To store all the reports
    - Teams connection - To send the notification
