{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "7184f2f2-6f37-4171-b1aa-d5808dc978b5",
            "version": "KqlParameterItem/1.0",
            "name": "Help",
            "type": 10,
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": []
            },
            "jsonData": "[\r\n    {\"value\": \"Yes\", \"label\": \"Yes\", \"selected\":true},\r\n    {\"value\": \"No\", \"label\": \"No\"}\r\n]",
            "timeContext": {
              "durationMs": 86400000
            },
            "label": "Guide"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "Parameters: Help"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "crossComponentResources": [
          "value::selected"
        ],
        "parameters": [
          {
            "id": "3218e2b0-1bcc-46d4-affa-d298e0cf90f6",
            "version": "KqlParameterItem/1.0",
            "name": "DefaultSubscription_Internal",
            "type": 1,
            "isRequired": true,
            "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| take 1\r\n| project subscriptionId",
            "crossComponentResources": [
              "value::selected"
            ],
            "isHiddenWhenLocked": true,
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "e6ded9a1-a83c-4762-938d-5bf8ff3d3d38",
            "version": "KqlParameterItem/1.0",
            "name": "Subscription",
            "type": 6,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "summarize by subscriptionId\r\n| project value = strcat(\"/subscriptions/\", subscriptionId), label = subscriptionId, selected = iff(subscriptionId =~ '{DefaultSubscription_Internal}', true, false)",
            "crossComponentResources": [
              "value::selected"
            ],
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "e3225ed0-6210-40a1-b2d0-66e42ffa71d6",
            "version": "KqlParameterItem/1.0",
            "name": "Workspace",
            "type": 5,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "resources\r\n| where type =~ 'microsoft.operationalinsights/workspaces'\r\n| order by name asc\r\n| summarize Selected = makelist(id, 10), All = makelist(id, 1000)\r\n| mvexpand All limit 100\r\n| project value = tostring(All), label = tostring(All), selected = iff(Selected contains All, true, false)",
            "crossComponentResources": [
              "{Subscription}"
            ],
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "15b2c181-7397-43c1-900a-28e175ae8a6f",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "type": 4,
            "isRequired": true,
            "value": {
              "durationMs": 5184000000
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 2592000000
                },
                {
                  "durationMs": 5184000000
                },
                {
                  "durationMs": 7776000000
                }
              ],
              "allowCustom": true
            }
          }
        ],
        "style": "pills",
        "queryType": 1,
        "resourceType": "microsoft.resourcegraph/resources"
      },
      "name": "Parameter Selectors"
    },
    {
      "type": 1,
      "content": {
        "json": "## What is Zero Trust?\r\nInstead of assuming everything behind the corporate firewall is safe, the Zero Trust model assumes breach and verifies each request as though it originates from an open network. Regardless of where the request originates or what resource it accesses, Zero Trust teaches us to ‚Äúnever trust, always verify‚Äù. For more information, see the üí°[Microsoft Zero Trust Model](https://www.microsoft.com/security/business/zero-trust).\r\n\r\n## What is Trusted Internet Connections (TIC 3.0)?\r\nThe Trusted Internet Connections (TIC) initiative, since its establishment in 2007, has moved the government from a period of uncontrolled and unmonitored internet connections to a controlled state, reducing the .GOV‚Äôs attack surface. In accordance with the Office of Management and Budget (OMB) Memorandum (M) 19-26: Update to the TIC Initiative, TIC 3.0 expands on the original initiative to drive security standards and leverage advances in technology to secure a wide spectrum of agency network architectures. This new version of TIC is highly iterative, which means the guidance will better reflect modern processes and technological innovations compared to previous iterations of the program. TIC 3.0 recognizes shifts in modern cybersecurity and pushes agencies toward adoption, while recognizing their challenges and constraints in modernizing IT infrastructure. For more information, see the CISA: Trusted Internet Connections üí°[Core Guidance Documents](https://www.cisa.gov/trusted-internet-connections).\r\n\r\n## Is Zero Trust Equivalent to TIC 3.0?\r\nNo, Zero Trust is a best practice model and TIC 3.0 is a security initiative to secure data, networks, and boundaries while providing visibility into traffic, including cloud communications. Zero Trust has core principles, but the specifics are often defined differently between organizations, workloads, and applications. This workbook demonstrates the overlap between Zero Trust principles and TIC 3.0 Security Capabilities with Microsoft offering overlays. \r\n\r\n ### Legend\r\nüìó Definitions & Guides\r\n\r\nüìò Controls Covered: Microsoft/Shared Responsibility (Technical Controls, Best Practice Recommendations etc.)\r\n\r\nüìï Controls Not Covered: Customer Responsibility (Policy, Assessment, Administrative Process etc.)\r\n\r\nüî∑ Requirement / Required Log Source\r\n\r\n‚ú≥Ô∏è Get Started with Microsoft Products\r\n\r\nüîÑ [Microsoft Security Portals, Features, & Admin Centers](https://docs.microsoft.com/microsoft-365/security/defender/portals)\r\n\r\nüí°    Reference \r\n\r\nüîé Recommended RBAC Role: [SecurityReader](https://docs.microsoft.com/azure/role-based-access-control/built-in-roles) or higher\r\n\r\n#### Disclaimer\r\nThe Azure Sentinel Zero Trust (TIC 3.0) Workbook demonstrates best practice guidance, but Microsoft does not guarantee nor imply compliance. All TIC requirements, validations, and controls are governed by the üí° [Cybersecurity & Infrastructure Security Agency](https://www.cisa.gov/trusted-internet-connections). This workbook provides visibility and situational awareness for security capabilities delivered with Microsoft technologies in predominantly cloud-based environments. Customer experience will vary by user and some panels may require additional configurations for operation. Recommendations do not imply coverage of respective controls as they are often one of several courses of action for approaching requirements which is unique to each customer. Recommendations should be considered a starting point for planning full or partial coverage of respective requirements. ",
        "style": "success"
      },
      "conditionalVisibility": {
        "parameterName": "Help",
        "comparison": "isEqualTo",
        "value": "Yes"
      },
      "name": "What is Zero Trust?",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "{\"version\":\"1.0.0\",\"content\":\"[\\r\\n\\t{ \\\"Section\\\": \\\"Overview\\\", \\\"tab\\\": \\\"Overview\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Universal Security Capabilities\\\", \\\"tab\\\": \\\"Universal Security Capabilities\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Files\\\", \\\"tab\\\": \\\"Files\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Email\\\", \\\"tab\\\": \\\"Email\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Web\\\", \\\"tab\\\": \\\"Web\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Networking\\\", \\\"tab\\\": \\\"Networking\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Resiliency\\\", \\\"tab\\\": \\\"Resiliency\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"DNS\\\", \\\"tab\\\": \\\"DNS\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Intrusion Detection\\\", \\\"tab\\\": \\\"Intrusion Detection\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Enterprise\\\", \\\"tab\\\": \\\"Enterprise\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Unified Communications & Collaboration\\\", \\\"tab\\\": \\\"Unified Communications & Collaboration\\\" },\\r\\n\\t{ \\\"Section\\\": \\\"Data Protection\\\", \\\"tab\\\": \\\"Data Protection\\\" }\\r\\n]\",\"transformers\":null}",
        "size": 3,
        "title": "TIC 3.0 Capabilities",
        "exportMultipleValues": true,
        "exportedParameters": [
          {
            "fieldName": "tab",
            "parameterName": "Tab",
            "parameterType": 1
          }
        ],
        "queryType": 8,
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "tab",
              "formatter": 5
            }
          ],
          "filter": true
        }
      },
      "name": "Capabilities Selector"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "cec6c07e-2856-4c77-8b48-98935f2c1218",
            "version": "KqlParameterItem/1.0",
            "name": "isOverviewVisible",
            "type": 1,
            "value": "false",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "Overview",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "eab3e5a8-66c3-4304-8c2b-43264e858ba8",
            "version": "KqlParameterItem/1.0",
            "name": "isUniversalSecurityCapabilitiesVisible",
            "type": 1,
            "value": "false",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "Universal Security Capabilities",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isFilesVisible",
            "type": 1,
            "value": "false",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "Files",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "67de7a24-1840-4fc5-94d5-a6b5d7520a7c"
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isEmailVisible",
            "type": 1,
            "value": "false",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "Email",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "ec480379-6561-4a30-b005-7533da78ed14"
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isWebVisible",
            "type": 1,
            "value": "false",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "Web",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "2919b971-fb14-440c-ab42-50304df3ceab"
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isNetworkingVisible",
            "type": 1,
            "value": "false",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "Networking",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "38d5c68b-fce9-479b-b8dd-acb7a97d85e7"
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isResiliencyVisible",
            "type": 1,
            "value": "false",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "Resiliency",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "bc580025-4494-49cc-97cb-99730da0b441"
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isDNSVisible",
            "type": 1,
            "value": "false",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "DNS",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "1dcbeafd-44c9-4362-b11c-5d82d12dd817"
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isIntrusionDetectionVisible",
            "type": 1,
            "value": "false",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "Intrusion Detection",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "e09d0049-3288-400d-afc6-9b141fb5ca18"
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isEnterpriseVisible",
            "type": 1,
            "value": "false",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "Enterprise",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "c661e5bc-4486-462f-8197-df4f46086d61"
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isUnifiedCommunicationsCollaborationVisible",
            "type": 1,
            "value": "false",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "Unified Communications & Collaboration",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "b7398798-5c1f-4189-ad8b-0167e4a7a5e4"
          },
          {
            "version": "KqlParameterItem/1.0",
            "name": "isDataProtectionVisible",
            "type": 1,
            "value": "false",
            "isHiddenWhenLocked": true,
            "criteriaData": [
              {
                "criteriaContext": {
                  "leftOperand": "Tab",
                  "operator": "contains",
                  "rightValType": "static",
                  "rightVal": "Data Protection",
                  "resultValType": "static",
                  "resultVal": "true"
                }
              },
              {
                "criteriaContext": {
                  "operator": "Default",
                  "rightValType": "param",
                  "resultValType": "static",
                  "resultVal": "false"
                }
              }
            ],
            "timeContext": {
              "durationMs": 86400000
            },
            "id": "eea98301-7966-4574-a652-26fbf88665b2"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "isVisible Navigation"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "6bfcedfc-612f-44b8-ac25-5caff3ac6821",
            "cellValue": "Zero Trust Model",
            "linkTarget": "step",
            "linkLabel": "Microsoft Zero Trust Architecture",
            "style": "link"
          },
          {
            "id": "38383ad2-4d0b-475c-b98d-2343b883c912",
            "cellValue": "Trusted Internet Connections 3.0",
            "linkTarget": "step",
            "linkLabel": "Trusted Internet Connections (TIC 3.0)",
            "style": "link"
          },
          {
            "id": "a502f983-efbe-4031-ae7a-bf4878afc8ad",
            "cellValue": "Microsoft Offerings Overlay",
            "linkTarget": "step",
            "linkLabel": "Microsoft Offerings Overlay",
            "style": "link"
          },
          {
            "id": "f0923ff0-948f-47fc-8ec5-d4df8b814ec4",
            "cellValue": "Microsoft Security Portals, Features, & Admin Centers",
            "linkTarget": "step",
            "linkLabel": "Microsoft Security Portals, Features, & Admin Centers",
            "style": "link"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isOverviewVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Overview Navigation"
    },
    {
      "type": 1,
      "content": {
        "json": "## Microsoft Zero Trust Architecture\r\n![Image Name](https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE4KvMM?ver=13f6&q=0&m=6&h=600&w=1600&b=%23FFFFFFFF&u=t&l=f&f=jpg&o=t&aim=true  \"Security Policy Enforcement\")\r\n\r\n## Microsoft Zero Trust Principles, Pillars, & Strategies\r\n| <em> Principles  </em> |\r\n|¬†:¬†|¬†: | \r\n| <strong> Verify Explicitly </strong> \t\t| Always authenticate and authorize based on all available data points, including user identity, location, endpoint health, service or workload, data classification, and anomalies. |\r\n| <strong> Use Least Privileged Access </strong> \t| Limit user access with just-in-time and just-enough-access (JIT/JEA), risk-based adaptive polices, and data protection to help secure both data and productivity. |\r\n| <strong> Assume Breach </strong> | Minimize blast radius for breaches and prevent lateral movement by segmenting access by network, user, endpoints, and app awareness. Verify all sessions are encrypted end to end. Use analytics to get visibility, drive threat detection, and improve defenses. |\r\n| <em> Pillars </em> |\r\n| <strong> Identity </strong> | Identities‚Äîwhether they represent people, services, or IoT devices‚Äîdefine the Zero Trust control plane. When an identity attempts to access a resource, verify that identity with strong authentication, and ensure access is compliant and typical for that identity. For more information, see üí°[Securing Identity with Zero Trust](https://docs.microsoft.com/security/zero-trust/identity) |\r\n| <strong> Endpoints </strong> | Once an identity has been granted access to a resource, data can flow to a variety of different endpoints‚Äîfrom IoT devices to smartphones, BYOD to partner-managed devices, and on-premises workloads to cloud-hosted servers. This diversity creates a massive attack surface area. Monitor and enforce device health and compliance for secure access. For more information, see üí°[Secure Endpoints with Zero Trust](https://docs.microsoft.com/security/zero-trust/endpoints) |\r\n| <strong> Data </strong> | Ultimately, security teams are protecting data. Where possible, data should remain safe even if it leaves the devices, apps, infrastructure, and networks the organization controls. Classify, label, and encrypt data, and restrict access based on those attributes. For more information, see üí°[Secure Data with Zero Trust](https://docs.microsoft.com/security/zero-trust/data) |\r\n| <strong> Apps </strong> | Applications and APIs provide the interface by which data is consumed. They may be legacy on-premises, lifted-and-shifted to cloud workloads, or modern SaaS applications. Apply controls and technologies to discover shadow IT, ensure appropriate in-app permissions, gate access based on real-time analytics, monitor for abnormal behavior, control user actions, and validate secure configuration options. For more information, see üí°[Secure Applications with Zero Trust](https://docs.microsoft.com/security/zero-trust/applications) |\r\n| <strong> Infrastructure </strong> | Infrastructure‚Äîwhether on-premises servers, cloud-based VMs, containers, or micro-services‚Äîrepresents a critical threat vector. Assess for version, configuration, and JIT access to harden defense. Use telemetry to detect attacks and anomalies, and automatically block and flag risky behavior and take protective actions. For more information, see üí°[Secure Infrastructure with Zero Trust](https://docs.microsoft.com/security/zero-trust/infrastructure) |\r\n| <strong> Network </strong> | All data is ultimately accessed over network infrastructure. Networking controls can provide critical controls to enhance visibility and help prevent attackers from moving laterally across the network. Segment networks (and do deeper in-network micro-segmentation) and deploy real-time threat protection, end-to-end encryption, monitoring, and analytics. For more information, see üí°[Secure Networks with Zero Trust](https://docs.microsoft.com/security/zero-trust/networks) |\r\n| <strong> Visibility, Automation, and Orchestration </strong> | In our Zero Trust guides, we define the approach to implement an end-to-end Zero Trust methodology across identities, endpoints and devices, data, apps, infrastructure, and network. These activities increase your visibility, which gives you better data for making trust decisions. With each of these individual areas generating their own relevant alerts, we need an integrated capability to manage the resulting influx of data to better defend against threats and validate trust in a transaction. For more information, see üí°[Visibility, Automation, and Orchestration with Zero Trust](https://docs.microsoft.com/security/zero-trust/visibility-automation-orchestration) |\r\n| <em> Strategies </em> |\r\n| <strong> Strategy #1 ‚Äì Use Identities to Control Access </strong> | Identities‚Äîrepresenting people, services, and IoT devices‚Äîare the common denominator across networks, endpoints, and applications. In a Zero Trust security model, they function as a powerful, flexible, and granular way to control access to data. When any identity attempts to access any resource, security controls should verify the identity with strong authentication, ensure access is compliant and typical for that identity, and confirm that the identity follows least privilege access principles. |\r\n| <strong> Strategy #2 ‚Äì Elevate Authentication </strong> | Incorporating multifactor authentication or continuous authentication into your identity management strategy can substantially improve your organization‚Äôs information security posture. One roundtable participant shared that by extending identity management with continuous authentication capabilities, their organization can now validate identity when a user‚Äôs IP address or routine behavior pattern changes. |\r\n| <strong> Strategy #3 ‚Äì Incorporate Passwordless Authentication </strong> | Passwordless authentication replaces the traditional password with two or more verification factors secured with a cryptographic key pair. When registered, the device creates a public and private key. The private key can be unlocked using a local gesture, such as a PIN or biometric authentication (fingerprint scan, facial recognition, or iris recognition). |\r\n| <strong> Strategy #4 ‚Äì Segment Your Corporate Network </strong> | Network segmentation can be a pain point for business IT because firewalls represent early segmentation, and this can complicate development and testing. Ultimately, the IT team relies more on security teams to fix networking connectivity and access issues. However, segmenting networks and conducting deeper in-network micro-segmentation is important for Zero Trust because in a mobile- and cloud-first world, all business-critical data is accessed over network infrastructure. Networking controls provide critical functionality to enhance visibility and help prevent attackers from moving laterally across the network. |\r\n| <strong> Strategy #5 ‚Äì Secure Your Devices </strong> | With the Zero Trust model, the same security policies are applied whether the device is corporately owned or a personally owned phone or tablet, also called a ‚Äúbring your own device‚Äù (BYOD). Corporate, contractor, partner, and guest devices are treated the same whether the device is fully managed by IT or only the apps and data are secured. And this is true whether these endpoints‚ÄîPC, Mac, smartphone, tablet, wearable, or IoT device‚Äîare connected using the secure corporate network, home broadband, or public internet. |\r\n| <strong> Strategy #6 ‚Äì Segment Your Applications </strong> | Benefitting fully from cloud apps and services requires finding the right balance between providing access and maintaining control to ensure that apps, and the data they contain, are protected. Apply controls and technologies to discover shadow IT, ensure appropriate in-app permissions, gate access based on real-time analytics, monitor for abnormal behavior, restrict user actions, and validate secure configuration options. |\r\n| <strong> Strategy #7 ‚Äì Define Roles and Access Controls </strong> | With the rapid rise in remote work, organizations must consider alternative ways of achieving modern security controls. It‚Äôs useful to operationalize roles and tie them to a policy as part of authorization, single sign-on, passwordless access, and segmentation. However, each role defined must be managed now and, in the future, so be selective about how many roles you create so there aren‚Äôt management challenges later. |\r\n\r\nFor more information, see the üí°[Microsoft Zero Trust Model](https://www.microsoft.com/security/business/zero-trust), üí°[Zero Trust Deployment Center](https://docs.microsoft.com/security/zero-trust/), üí°[Zero Trust: 7 Adoption Strategies From Security Leaders](https://www.microsoft.com/security/blog/2021/03/31/zero-trust-7-adoption-strategies-from-security-leaders/)  and üí°[Microsoft Zero Trust Video](https://www.microsoft.com/videoplayer/embed/RE4J3ms)\r\n",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "isOverviewVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Zero Trust Model",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "## Trusted Internet Connections 3.0\r\n\r\n| <em> Security Objectives </em> |\r\n|¬†:¬†|¬†: | \r\n| <strong> Manage Traffic </strong>| Observe, validate, and filter data connections to align with authorized activities; least privilege and default deny |\r\n| <strong> Protect Traffic Confidentiality </strong>| Ensure only authorized parties can discern the contents of data in transit; sender and receiver identification and enforcement |\r\n| <strong> Protect Traffic Integrity </strong>| Prevent alteration of data in transit; detect altered data in transit |\r\n| <strong> Ensure Service Resiliency </strong>| Promote resilient application and security services for continuous operation as the technology and threat landscape evolve |\r\n| <strong> Ensure Effective Response </strong>| Promote timely reaction and adapt future response to discovered threats; policies defined and implemented; simplified adoption of new countermeasures |\r\n| <em> Key Program Documents </em> |\r\n|¬†<strong> Policy Memorandum </strong> | Beginning with the TIC policy memorandum, OMB M-19-26 lays the foundation for the program. It outlines the OMB expectations for TIC to provide flexibilities necessary for modern architectures, remove barriers to cloud adoption, and establish a process that promotes continuous review and updates to the TIC initiative. CISA is responsible for articulating the expectations outlined in the memorandum through the subsequent documents. For more information, see the CISA: Trusted Internet Connections üí°[Core Guidance Documents](https://www.cisa.gov/trusted-internet-connections) |\r\n| <strong> Volume 1: Program Guidebook </strong> | The Program Guidebook begins to articulate CISA‚Äôs translation of the OMB M-19-26 into concrete TIC guidance. The guidebook describes core modifications to the TIC program, provides historical context of the TIC program, and illustrates how agencies can implement TIC 3.0 as they adopt modern architectures. The Program Guidebook also clarifies the relationship that TIC has to other initiatives, programs, and entities in the Federal Government, such as the NIST CSF, FedRAMP, and the NCPS program. For more information, see üí°[Program Guidebook (Volume 1)](https://www.cisa.gov/sites/default/files/publications/CISA_TIC%203.0%20Vol.%201%20Program%20Guidebook.pdf) |\r\n| <strong> Volume 2: Reference Architecture </strong> | The Reference Architecture builds on the Program Guidebook, detailing the key concepts of the program to guide and constrain the instantiations of the TIC use cases. The Reference Architecture describes the baseline implementation of TIC 3.0, in which all agency traffic flows through a physical TIC access point. The Reference Architecture also describes how PEPs and security capabilities must be in place for scenarios in which traffic may not flow through a physical TIC access point. For more information, see üí°[Reference Architecture (Volume 2)](https://www.cisa.gov/sites/default/files/publications/CISA_TIC%203.0%20Vol.%202%20Reference%20Architecture.pdf) |\r\n| <strong> Volume 3: Security Capabilities Catalog </strong> | Complementary to the Reference Architecture, the Security Capabilities Catalog features an index of security capabilities applicable to the TIC security objectives. The TIC security capabilities include universal security capabilities, which are applicable at the enterprise level, and PEP security capabilities that can be applied at several PEPs. TIC security capabilities are mapped to the NIST Cybersecurity Framework. Guidance for implementing security capabilities will be provided in TIC use cases. For more information, see üí°[Security Capabilities Catalog (Volume 3)](https://www.cisa.gov/sites/default/files/publications/CISA_TIC%203.0%20Vol.%203%20Security%20Capabilities%20Catalog.pdf) |\r\n| <strong> Volume 4: TIC Use Case Handbook and Use Cases </strong> | The Reference Architecture and the Security Capabilities Catalog create the foundation for the TIC use cases. The use cases provide examples of architectures and provide guidance on the secure implementation and application of security capabilities to applications, services, and environments. TIC use cases give cybersecurity guidance to accommodate the use of cloud, mobile, and other computing environments in the Federal Government. For more information, see üí°[Use Case Handbook (Volume 4)](https://www.cisa.gov/sites/default/files/publications/CISA_TIC%203.0%20Vol.%204%20Use%20Case%20Handbook.pdf)|\r\n| <strong> Volume 5: Overlay Handbook </strong> | The Overlay Handbook gives guidance on how vendors and agencies can develop TIC overlays. Agencies can use the resulting overlays to assess the capabilities of the vendors, to make decisions on the procurement of products and services, and to identify any potential security capability gaps that need to be addressed. For more information, see üí°[Overlay Handbook (Volume 5)](https://www.cisa.gov/sites/default/files/publications/CISA_TIC%203.0%20Vol.%205%20Overlay%20Handbook.pdf) |\r\n\r\nFor more information, see the CISA: Trusted Internet Connections üí°[Core Guidance Documents](https://www.cisa.gov/trusted-internet-connections)\r\n",
        "style": "success"
      },
      "conditionalVisibility": {
        "parameterName": "isOverviewVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Trusted Internet Connections 3.0",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "### Microsoft Offerings Overlay to TIC Capabilities\r\n| <strong> Microsoft Offerings </strong> | <strong> Usage % Across TIC Capabilities  </strong> | <strong> Usage #  Across TIC Capabilities  </strong> | \r\n| : | : | : | \r\n| ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center) | 26% | 20 |\r\n| ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender) | 18% | 14 |\r\n| ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) | 16% | 12 |\r\n| ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) | 15% | 11 |\r\n| ‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/) | 15% | 11 |\r\n| ‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender) | 15% | 11 |\r\n| ‚ú≥Ô∏è [Windows Virtual Desktop]( https://azure.microsoft.com/services/virtual-desktop/)  | 14% | 10 |\r\n| ‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/) | 8% | 6 |\r\n| ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/) | 8% | 6 |\r\n| ‚ú≥Ô∏è [Azure Defender]( https://azure.microsoft.com/services/azure-defender/) | 7% | 5 |\r\n| ‚ú≥Ô∏è [Microsoft 365 Defender]( https://www.microsoft.com/microsoft-365/security/microsoft-365-defender) | 7% | 5 |\r\n| ‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security) | 7% | 5 |\r\n| ‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/) | 5% | 4 |\r\n| ‚ú≥Ô∏è [Automation]( https://azure.microsoft.com/services/automation/) | 4% | 3 |\r\n| ‚ú≥Ô∏è [Azure DDoS Protection]( https://azure.microsoft.com/services/ddos-protection/) | 4% | 3 |\r\n| ‚ú≥Ô∏è [Microsoft Defender for Identity]( https://www.microsoft.com/microsoft-365/security/identity-defender) | 4% | 3 |\r\n| ‚ú≥Ô∏è [Azure Logic Apps](https://azure.microsoft.com/services/logic-apps/) | 4% | 3 |\r\n| ‚ú≥Ô∏è [Microsoft Teams](https://www.microsoft.com/microsoft-teams/group-chat-software) | 4% | 3 |\r\n| ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph) | 4% | 3 | \r\n| ‚ú≥Ô∏è [Azure Blueprints]( https://azure.microsoft.com/services/blueprints/) | 3% | 2 | \r\n| ‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) | 3% | 2 | \r\n| ‚ú≥Ô∏è [Customer Lockbox]( https://docs.microsoft.com/azure/security/fundamentals/customer-lockbox-overview) | 3% | 2 | \r\n| ‚ú≥Ô∏è [Azure Availability Zones]( https://azure.microsoft.com/global-infrastructure/availability-zones/) | 3% | 2 | \r\n| ‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/) | 3% | 2 | \r\n| ‚ú≥Ô∏è [Azure Virtual Machine Scale Sets]( https://azure.microsoft.com/services/virtual-machine-scale-sets/) | 3% | 2 | \r\n| ‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/) | 3% | 2 | \r\n| ‚ú≥Ô∏è [VPN Gateway]( https://azure.microsoft.com/services/vpn-gateway/) | 3% | 2 | \r\n| ‚ú≥Ô∏è [Azure Backup](https://azure.microsoft.com/services/backup/)  | 1% | 1 | \r\n| ‚ú≥Ô∏è [Azure Defender for IoT](https://azure.microsoft.com/services/azure-defender-for-iot/)   | 1% | 1 | \r\n| ‚ú≥Ô∏è [Microsoft 365 Compliance: Advanced eDiscovery](https://www.microsoft.com/microsoft-365/business/compliance-solutions)  | 1% | 1 |\r\n| ‚ú≥Ô∏è [Microsoft 365 Compliance: Insider Risk Management](https://www.microsoft.com/microsoft-365/business/compliance-solutions)  | 1% | 1 |\r\n| ‚ú≥Ô∏è [Microsoft 365 Compliance: Communications Compliance](https://www.microsoft.com/microsoft-365/business/compliance-solutions)  | 1% | 1 |\r\n| ‚ú≥Ô∏è [Azure Automation]( https://azure.microsoft.com/services/automation/) | 1% | 1 |\r\n| ‚ú≥Ô∏è [Azure Purview]( https://azure.microsoft.com/services/purview/) | 1% | 1 |\r\n| ‚ú≥Ô∏è [Azure Lighthouse](https://azure.microsoft.com/services/azure-lighthouse/) | 1% | 1 |\r\n| ‚ú≥Ô∏è [Azure Availability Zones]( https://azure.microsoft.com/global-infrastructure/availability-zones/) | 1% | 1 |\r\n| ‚ú≥Ô∏è [Virtual Machines]( https://azure.microsoft.com/services/virtual-machines/) | 1% | 1 |\r\n| ‚ú≥Ô∏è [Microsoft Endpoint Manager]( https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager) | 1% |  1 |\r\n| ‚ú≥Ô∏è [Application Gateway]( https://azure.microsoft.com/services/application-gateway/) | 1% |  1 |\r\n| ‚ú≥Ô∏è [Azure Arc](https://azure.microsoft.com/services/azure-arc/) | 1% |  1 |\r\n| ‚ú≥Ô∏è [Traffic Manager]( https://azure.microsoft.com/services/traffic-manager/) | 1% |  1 |\r\n| ‚ú≥Ô∏è [Azure ExpressRoute]( https://azure.microsoft.com/services/expressroute/) | 1% |  1 |\r\n| ‚ú≥Ô∏è [Microsoft 365  Enterprise]( https://www.microsoft.com/microsoft-365/enterprise) | 1% |  1 |\r\n| ‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management) | 1% |  1 |\r\n| ‚ú≥Ô∏è [Azure DNS]( https://azure.microsoft.com/services/dns/) | 1% |  1 |\r\n| ‚ú≥Ô∏è [Network Watcher](https://azure.microsoft.com/services/network-watcher/)  | 1% |  1 |\r\n| ‚ú≥Ô∏è [Microsoft Graph Security tiIndicators API](https://docs.microsoft.com/graph/api/resources/tiindicator) | 1% |  1 |\r\n| ‚ú≥Ô∏è [Microsoft Security Intelligence](https://www.microsoft.com/wdsi) | 1% |  1 |\r\n| ‚ú≥Ô∏è [MSTICPy](https://github.com/Microsoft/msticpy)| 1% |  1 |\r\n| ‚ú≥Ô∏è [Privileged Access Workstations](https://docs.microsoft.com/security/compass/privileged-access-devices) | 1% |  1 |\r\n",
        "style": "info"
      },
      "conditionalVisibility": {
        "parameterName": "isOverviewVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Microsoft Offerings Overlay",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "### Microsoft Security Portals & Admin Centers (Included in Workbook)\r\nüîÑ [Azure Portal](https://portal.azure.com/) \r\n\r\nüîÑ [Microsoft Defender for Identity Portal](https://portal.atp.azure.com/)\r\n\r\nüîÑ [Microsoft 365 Compliance Center](https://compliance.microsoft.com/) \r\n\r\nüîÑ [Microsoft 365 Admin Center](https://admin.microsoft.com/) \r\n\r\nüîÑ [Microsoft 365 Security Center](https://security.microsoft.com/) \r\n\r\nüîÑ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/) \r\n\r\nüîÑ [Microsoft Defender Security Center](https://securitycenter.microsoft.com/) \r\n\r\nüîÑ [Microsoft Defender Security Intelligence Portal](https://microsoft.com/wdsi) \r\n\r\nüîÑ [Microsoft Endpoint Manager Admin Center](https://devicemanagement.microsoft.com/) \r\n\r\nüîÑ [Microsoft Intune Portal](https://endpoint.microsoft.com/#blade/Microsoft_Intune_DeviceSettings/DevicesMenu/overview) \r\n\r\nüîÑ [Security & Compliance Center](https://protection.office.com/) \r\n\r\nüí° [Microsoft Security Portals & Admin Centers](https://docs.microsoft.com/microsoft-365/security/defender/portals)\r\n\r\n### Azure Feature Offerings (Included in Workbook)\r\nüîÑ [Application Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks) \r\n\r\nüîÑ [Automation Accounts](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Automation%2FAutomationAccounts) \r\n\r\nüîÑ [Availability Sets](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FavailabilitySets) \r\n\r\nüîÑ [Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)\r\n\r\nüîÑ [Azure Arc](https://portal.azure.com/#blade/Microsoft_Azure_HybridCompute/AzureArcCenterBlade/overview) \r\n\r\nüîÑ [Azure Defender for IoT](https://portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard/Getting_Started) \r\n\r\nüîÑ [Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade) \r\n\r\nüîÑ [Azure Lighthouse](https://portal.azure.com/#blade/Microsoft_Azure_CustomerHub/LighthouseBlade) \r\n\r\nüîÑ [Azure Monitor](https://portal.azure.com/#blade/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/overview) \r\n\r\nüîÑ [Azure Policy](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyMenuBlade/Overview)\r\n \r\nüîÑ [Azure Resource Graph Explorer](https://portal.azure.com/#blade/HubsExtension/ArgQueryBlade) \r\n\r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)\r\n \r\nüîÑ [Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) \r\n\r\nüîÑ [Azure SQL](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Sql%2Fazuresql) \r\n\r\nüîÑ [Backup Vaults](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyMenuBlade/Overview) \r\n\r\nüîÑ [Blueprints](https://portal.azure.com/#blade/Microsoft_Azure_Policy/BlueprintsMenuBlade/GetStarted) \r\n\r\nüîÑ [Customer Lockbox for Microsoft Azure](https://portal.azure.com/#blade/Microsoft_Azure_Lockbox/LockboxMenu/Overview) \r\n\r\nüîÑ [DDoS Protection Plans](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FddosProtectionPlans) \r\n\r\nüîÑ [ExpressRoute Circuits](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FexpressRouteCircuits) \r\n \r\nüîÑ [Firewalls](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FazureFirewalls) \r\n\r\nüîÑ [Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview)\r\n \r\nüîÑ [Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FfirewallPolicies)\r\n\r\nüîÑ [Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults) \r\n\r\nüîÑ [Load Balancer](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)\r\n\r\nüîÑ [Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups) \r\n\r\nüîÑ [Network Watcher](https://portal.azure.com/#blade/Microsoft_Azure_Network/NetworkWatcherMenuBlade/overview)\r\n\r\nüîÑ [Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart) \r\n\r\nüîÑ [Recovery Services Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.RecoveryServices%2Fvaults) \r\n\r\nüîÑ [Resource Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResourceGroups) \r\n\r\nüîÑ [Traffic Manager Profiles](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2Ftrafficmanagerprofiles)\r\n\r\nüîÑ [Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines) \r\n\r\nüîÑ [Virtual Machine Scale Sets](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Compute%2FvirtualMachineScaleSets)  \r\n\r\nüîÑ [Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks) \r\n\r\nüîÑ [Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways) \r\n \r\nüîÑ [Web Application Firewall Policies](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)  \r\n\r\nüîÑ [Windows Virtual Desktop](https://portal.azure.com/#blade/Microsoft_Azure_WVD/WvdManagerMenuBlade/overview) ",
        "style": "success"
      },
      "conditionalVisibility": {
        "parameterName": "isOverviewVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Microsoft Security Portals, Features, & Admin Centers",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##¬†Universal Security Capabilities\r\nUniversal capabilities are enterprise-level capabilities that outline guiding principles for TIC use cases. Universal capabilities are selected to be broadly applicable; the same list of capabilities apply to every use case. However, certain use cases may provide unique guidance on specific capabilities where necessary.\r\nAgencies have significant discretion regarding how to meet the individual security capability requirements and address their particular needs. Agencies are free to determine the level of rigor necessary for applying universal capabilities based on federal guidelines and risk tolerance. While it is expected that agencies may often be able to employ a common solution to fulfill multiple roles or serve multiple purposes, the selection of an appropriate set of solutions is left to each agency. \r\n\r\n|¬†<em> TIC 3.0 vs Zero Trust </em> |\r\n|¬†:¬†|¬†: | : | : |\r\n|¬†<strong> Capabilities¬†</strong> | <strong> Microsoft Controls¬†</strong> |¬†<strong> Zero Trust Principles </strong>  | <strong> Zero Trust Pillars </strong>  |\r\n|¬†Backup and Recovery¬†|¬†‚ú≥Ô∏è [Azure Backup](https://azure.microsoft.com/services/backup/)  ‚ú≥Ô∏è [Azure Site Recovery]( https://azure.microsoft.com/services/site-recovery/) ‚ú≥Ô∏è [Azure Blueprints]( https://azure.microsoft.com/services/blueprints/) ‚ú≥Ô∏è [Azure Defender]( https://azure.microsoft.com/services/azure-defender/)  | Assume Breach | Data, Infrastructure | \r\n|¬†Central Log Management with Analysis¬†|¬†‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)  ‚ú≥Ô∏è [Azure Lighthouse](https://azure.microsoft.com/services/azure-lighthouse/)  | Use Least Privileged Access, Assume Breach | Identities, Endpoints, Data, Apps, Infrastructure, Network | \r\n|¬†Configuration Management¬†|¬†‚ú≥Ô∏è [Automation]( https://azure.microsoft.com/services/automation/) ‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)  ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/) | Verify Explicitly, Use Least Privileged Access, Assume Breach | Endpoints, Apps, Infrastructure, Network | \r\n|¬†Incident Response Plan and Incident Handling¬†|¬†‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft 365 Compliance: Advanced eDiscovery](https://www.microsoft.com/microsoft-365/business/compliance-solutions) ‚ú≥Ô∏è [Microsoft 365 Compliance: Insider Risk Managemment](https://www.microsoft.com/microsoft-365/business/compliance-solutions)| Assume Breach | Identities, Endpoints, Data, Apps, Infrastructure, Network | \r\n|¬†Inventory¬†|¬†‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/) ‚ú≥Ô∏è [Azure Defender]( https://azure.microsoft.com/services/azure-defender/) ‚ú≥Ô∏è [Automation]( https://azure.microsoft.com/services/automation/) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)  ‚ú≥Ô∏è [Azure Arc](https://azure.microsoft.com/services/azure-arc/) | Verify Explicitly, Use Least Privileged Access, Assume Breach | Endpoints, Data, Apps, Infrastructure, Network | \r\n|¬†Least Privilege¬†|¬†‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)  | Verify Explicitly, Use Least Privileged Access | Identities | \r\n|¬†Secure Administration¬†|¬†‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) ‚ú≥Ô∏è [Customer Lockbox]( https://docs.microsoft.com/azure/security/fundamentals/customer-lockbox-overview) ‚ú≥Ô∏è [Privileged Access Workstations](https://docs.microsoft.com/security/compass/privileged-access-devices) | Verify Explicitly, Use Least Privileged Access | Identities | \r\n|¬†Strong Authentication¬†| ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/) ‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/) | Verify Explicitly, Use Least Privileged Access | Identities | \r\n|¬†Time Synchronization¬†|¬†‚ú≥Ô∏è [Azure](https://azure.microsoft.com/)  | Assume Breach | Identities, Endpoints, Data, Apps, Infrastructure, Network | \r\n|¬†Vulnerability Management¬†|¬†‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)  ‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)  | Assume Breach | Endpoints, Apps, Infrastructure, Network | \r\n|¬†Patch Management¬†|¬†‚ú≥Ô∏è [Azure Automation]( https://azure.microsoft.com/services/automation/) ‚ú≥Ô∏è [Virtual Machines]( https://azure.microsoft.com/services/virtual-machines/) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)| Verify Explicitly, Use Least Privileged Access, Assume Breach | Endpoints, Apps, Infrastructure, Network |  \r\n|¬†Auditing and Accounting¬†|¬†‚ú≥Ô∏è [Azure Monitor]( https://azure.microsoft.com/services/monitor/)  ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)  | Verify Explicitly, Use Least Privileged Access, Assume Breach | Identities, Endpoints, Data, Apps, Infrastructure, Network |   \r\n|¬†Resilience¬†|¬†‚ú≥Ô∏è [Azure DDoS Protection]( https://azure.microsoft.com/services/ddos-protection/) ‚ú≥Ô∏è [Azure Availability Zones]( https://azure.microsoft.com/global-infrastructure/availability-zones/) ‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/) ‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/) ‚ú≥Ô∏è [Azure Virtual Machine Scale Sets]( https://azure.microsoft.com/services/virtual-machine-scale-sets/)  |  Assume Breach | Data, Apps, Infrastructure, Network | \r\n|¬†Enterprise Threat Intelligence¬†|¬†‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft Security Intelligence](https://www.microsoft.com/wdsi) ‚ú≥Ô∏è [Microsoft Graph Security tiIndicators API](https://docs.microsoft.com/graph/api/resources/tiindicator) ‚ú≥Ô∏è [MSTICPy](https://github.com/Microsoft/msticpy)  | Assume Breach | Visibility & Analytics | \r\n|¬†Situational Awareness¬†|¬†‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Azure Defender]( https://azure.microsoft.com/services/azure-defender/)  ‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)  ‚ú≥Ô∏è [Microsoft Defender for Identity]( https://www.microsoft.com/microsoft-365/security/identity-defender)  ‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender) ‚ú≥Ô∏è [Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender) ‚ú≥Ô∏è [Microsoft 365 Defender]( https://www.microsoft.com/microsoft-365/security/microsoft-365-defender) ‚ú≥Ô∏è [Network Watcher](https://azure.microsoft.com/services/network-watcher/) | Assume Breach | Visibility & Analytics | \r\n|¬†Dynamic Threat Discovery¬†|¬†‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)  |  Assume Breach | Visibility & Analytics | \r\n|¬†Policy Enforcement Parity¬†|¬†‚ú≥Ô∏è [Azure Policy]( https://azure.microsoft.com/services/azure-policy/) ‚ú≥Ô∏è [Azure Blueprints]( https://azure.microsoft.com/services/blueprints/)  ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) | Verify Explicitly, Use Least Privileged Access, Assume Breach | Identities, Endpoints, Data, Apps, Infrastructure, Network | \r\n|¬†Effective Use of Shared Services¬†|¬†‚ú≥Ô∏è [Azure Lighthouse]( https://azure.microsoft.com/services/azure-lighthouse/) ‚ú≥Ô∏è [Customer Lockbox]( https://docs.microsoft.com/azure/security/fundamentals/customer-lockbox-overview) ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) | Verify Explicitly, Use Least Privileged Access | Data, Apps |\r\n|¬†Integrated Desktop, Mobile, and Remote Policies¬†|¬†‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) ‚ú≥Ô∏è [Microsoft Endpoint Manager]( https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)  | Verify Explicitly, Use Least Privileged Access, Assume Breach | Identities, Endpoints, Data, Apps, Infrastructure, Network | \r\nFor more information, see the CISA: Trusted Internet Connections üí°[Core Guidance Documents](https://www.cisa.gov/trusted-internet-connections) and Microsoft's üí°[Why Zero Trust](https://www.microsoft.com/security/business/zero-trust)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "isUniversalSecurityCapabilitiesVisible",
          "comparison": "isEqualTo",
          "value": "true"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Universal Security Capabilities Guide",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "c93e24ce-ec5c-4a5a-a505-f69f222f1c57",
            "cellValue": "Backup and Recovery",
            "linkTarget": "step",
            "linkLabel": "Backup and Reccovery",
            "style": "secondary"
          },
          {
            "id": "bac9107f-354e-46ac-b4ad-a3e6e0f55cb0",
            "cellValue": "Central Log Management with Analysis",
            "linkTarget": "step",
            "linkLabel": "Central Log Management with Analysis",
            "style": "secondary"
          },
          {
            "id": "4ffc1b21-56f5-450b-8eff-0ad8878d145b",
            "cellValue": "Configuration Management",
            "linkTarget": "step",
            "linkLabel": "Configuration Management",
            "style": "secondary"
          },
          {
            "id": "8d000886-a46f-4445-ab37-3f8d85d1a03c",
            "cellValue": "Incident Response Plan and Incident Handling",
            "linkTarget": "step",
            "linkLabel": "Incident Response Plan and Incident Handling",
            "style": "secondary"
          },
          {
            "id": "5716dd9a-2dc4-49b6-8159-6ecb38cae5b8",
            "cellValue": "Inventory",
            "linkTarget": "step",
            "linkLabel": "Inventory",
            "style": "secondary"
          },
          {
            "id": "fd99b1dd-8ab6-458a-9750-9bea08680143",
            "cellValue": "Least Privilege",
            "linkTarget": "step",
            "linkLabel": "Least Privilege",
            "style": "secondary"
          },
          {
            "id": "e44f9cc8-c90d-4180-bc5b-05ea686c2a48",
            "cellValue": "Secure Administration",
            "linkTarget": "step",
            "linkLabel": "Secure Administration",
            "style": "secondary"
          },
          {
            "id": "3d6bbb2b-5f84-45e1-840b-d5751ae01724",
            "cellValue": " Strong Authentication",
            "linkTarget": "step",
            "linkLabel": "Strong Authentication",
            "style": "secondary"
          },
          {
            "id": "39eeaf42-397f-4f0b-9ecb-6094cb499da5",
            "cellValue": "Time Synchronization",
            "linkTarget": "step",
            "linkLabel": "Time Synchronization",
            "style": "secondary"
          },
          {
            "id": "7a410392-0071-45de-bd44-6c1a302099bf",
            "cellValue": "Vulnerability Management",
            "linkTarget": "step",
            "linkLabel": "Vulnerability Management",
            "style": "secondary"
          },
          {
            "id": "85947fdc-7b1e-4ccf-b381-e14c481d44b2",
            "cellValue": "Patch Management",
            "linkTarget": "step",
            "linkLabel": "Patch Management",
            "style": "secondary"
          },
          {
            "id": "c785c05b-3c23-440c-880e-d137a5129d57",
            "cellValue": "Auditing and Accounting",
            "linkTarget": "step",
            "linkLabel": "Auditing and Accounting",
            "style": "secondary"
          },
          {
            "id": "c05f7400-cd07-4f88-8b83-01e7a423b212",
            "cellValue": "Resilience",
            "linkTarget": "step",
            "linkLabel": "Resilience",
            "style": "secondary"
          },
          {
            "id": "e1e208ec-51b4-4a92-b4c0-3b642dad5710",
            "cellValue": "Enterprise Threat Intelligence",
            "linkTarget": "step",
            "linkLabel": "Enterprise Threat Intelligence",
            "style": "secondary"
          },
          {
            "id": "ea9cabf5-fb7c-4243-82bf-ec8bc27d563e",
            "cellValue": "Situational Awareness",
            "linkTarget": "step",
            "linkLabel": "Situational Awareness",
            "style": "secondary"
          },
          {
            "id": "cca8efec-9930-4851-8245-6624c437608e",
            "cellValue": "Dynamic Threat Discovery",
            "linkTarget": "step",
            "linkLabel": "Dynamic Threat Discovery",
            "style": "secondary"
          },
          {
            "id": "af1e2514-78fd-4553-b883-e7e509081cd4",
            "cellValue": "Policy Enforcement Parity",
            "linkTarget": "step",
            "linkLabel": "Policy Enforcement Parity",
            "style": "secondary"
          },
          {
            "id": "e728fd6f-9b96-46e7-b657-7b94a4333060",
            "cellValue": "Effective Use of Shared Services",
            "linkTarget": "step",
            "linkLabel": "Effective Use of Shared Services",
            "style": "secondary"
          },
          {
            "id": "51a146f0-a041-43d3-8ed8-f2d03ce3a40b",
            "cellValue": "Integrated Desktop, Mobile, and Remote Policies",
            "linkTarget": "step",
            "linkLabel": "Integrated Desktop, Mobile, and Remote Policies",
            "style": "secondary"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Universal Security Capabilities Navigation"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Backup and Recovery\r\n\r\n### TIC 3.0 Guidance\r\nKeeping copies of configuration and data, as needed, to allow for the quick restoration of service in the event of malicious incidents, system failures, or corruption.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Security Center for Backup Recommendations\r\n\t‚Ä¢ Leverage Azure Backups & Recovery Services Vault to Backup Workloads\r\n\t‚Ä¢ Use Security Baselines for Configuration & Recovery\r\n\t‚Ä¢ Use Azure Blueprints to Maintain Configuration Settings\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityRecommendation(Azure Security Center) ‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/security-center/) \r\nüî∑ AzureDiagnostics¬†(Azure Backup) ‚ú≥Ô∏è [Get Started with Azure Backup](https://azure.microsoft.com/services/backup/)\r\n\r\n### Navigate \r\n\t‚Ä¢ Backup Vaults\r\n\t‚Ä¢ Recovery Services Vaults\r\n\t‚Ä¢ Blueprints\r\n\t‚Ä¢ Security Center > Recommendations\t\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Backup Vaults](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyMenuBlade/Overview) \r\nüîÑ [Recovery Services Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.RecoveryServices%2Fvaults) \r\nüîÑ [Blueprints](https://portal.azure.com/#blade/Microsoft_Azure_Policy/BlueprintsMenuBlade/GetStarted) \r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[What is the Azure Backup Service?](https://docs.microsoft.com/azure/backup/backup-overview)\r\nüí° [Review Your Security Recommendations](https://docs.microsoft.com/azure/security-center/security-center-recommendations)\r\nüí°¬†[Recovery Services Vaults Overview](https://docs.microsoft.com/azure/backup/backup-azure-recovery-services-vault-overview)\r\nüí°¬†[What is Azure Blueprints?](https://docs.microsoft.com/azure/governance/blueprints/overview)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.BE\r\n\t‚Ä¢ PR.IP\r\n\t‚Ä¢ PR.DS\r\n\t‚Ä¢ RS.MI\r\n\t‚Ä¢ RC.RP\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 0",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationName contains \"back\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†RecommendationName\r\n|¬†render¬†areachart¬†",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Security Center: Recommendations for Backups",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 2 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityBaseline\r\n| where Description == \"Ensure \\'Back up files and directories\\' is configured\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†Description\r\n|¬†render¬†areachart¬†",
              "size": 0,
              "showAnalytics": true,
              "title": "Configured Backups",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Backups & Recovery Services Vault to Backup Workloads\r\n![Image¬†Name](https://docs.microsoft.com/azure/backup/media/backup-overview/azure-backup-overview.png¬†¬†\"Azure Backup Service\")¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Backup](https://azure.microsoft.com/services/backup/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Use Azure Blueprints to Maintain Configuration Settings\r\n![Image¬†Name](https://docs.microsoft.com/azure/governance/blueprints/media/create-blueprint-portal/create-blueprint-button.png¬†¬†\"Azure Blueprints\")¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Blueprints](https://azure.microsoft.com/services/blueprints/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Backup and Recovery",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Central Log Management with Analysis\r\n\r\n### TIC 3.0 Guidance\r\nCollecting, storing, and analyzing telemetry, where the collection and storage are designed to facilitate data fusion and the security analysis aids in discovery and response to malicious activity.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Configure Audit Logging for All Assets via Diagnostic Settings\r\n\t‚Ä¢ Track Logging Recommendations with Azure Security Center\r\n\t‚Ä¢ Manage Multi-Tenant Subscription Logging with Azure Lighthouse\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityRecommendation (Azure Security Center) ‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/security-center/)\r\nüî∑ Usage (Log Analytics) ‚ú≥Ô∏è [Get Started with Azure Monitor](https://azure.microsoft.com/services/monitor/)\r\nüî∑ AzureActivity (Azure Lighthouse) ‚ú≥Ô∏è [Get Started with Azure Lighthouse](https://azure.microsoft.com/services/azure-lighthouse)\r\n\r\n### Navigate \r\n\t‚Ä¢ Resource Groups > Select Azure Resource > Diagnostic Settings > Add Diagnostic Setting > Select Desired Configurations > Send to Log Analytics \r\n\t‚Ä¢ Security Center > Recommendations \r\n    ‚Ä¢ Azure Lighthouse > Manage Your Customers \r\n\t\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Resource Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResourceGroups) \r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) \r\nüîÑ [Azure Lighthouse](https://portal.azure.com/#blade/Microsoft_Azure_CustomerHub/LighthouseBlade) \r\n\r\n###¬†Microsoft¬†Reference¬†\r\nüí° [Create Diagnostic Settings to Send Platform Logs and Metrics to Different Destinations](https://docs.microsoft.com/azure/azure-monitor/platform/diagnostic-settings)\r\nüí°¬†[Use Azure Security Center Recommendations to Enhance Security](https://docs.microsoft.com/azure/security-center/security-center-using-recommendations)\r\nüí°¬†[What is Azure Lighthouse?](https://docs.microsoft.com/azure/lighthouse/overview)\r\n\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.AM\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ DE.AE\r\n    ‚Ä¢ RS.AN"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Usage\r\n| summarize¬†count()¬†by¬†DataType\r\n| sort¬†by¬†count_¬†desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Log Events Count by Log Type",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "DataType",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationDisplayName¬†contains \"agent\" or RecommendationDisplayName contains \"log\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†RecommendationDisplayName\r\n|¬†render¬†areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Security Center: Recommendations for Logging",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "DataType",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "union withsource=_TableName *\r\n| summarize Entries = count(), Size = sum(_BilledSize), last_log = datetime_diff(\"second\",now(), max(TimeGenerated)), estimate  = sumif(_BilledSize, _IsBillable==true)  by _TableName, _IsBillable\r\n| project ['Table Name'] = _TableName, ['Table Size'] = Size, ['Table Entries'] = Entries,\r\n          ['Size per Entry'] = 1.0 * Size / Entries, ['IsBillable'] = _IsBillable\r\n| order by ['Table Size']  desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Log Table Management",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Table Name",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "uninitialized",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Table Size",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "purple"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Entries",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "turquoise"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Size per Entry",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "IsBillable",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "True",
                          "representation": "2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "False",
                          "representation": "success",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Important",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ],
                "sortBy": [
                  {
                    "itemKey": "$gen_thresholds_IsBillable_4",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "$gen_thresholds_IsBillable_4",
                  "sortOrder": 2
                }
              ],
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "DataType",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "union withsource=_TableName *\r\n| summarize count() , Size = sum(_BilledSize) by bin(_TimeReceived, 1m), Type, _IsBillable\r\n| extend counttemp =count_ / 60\r\n| summarize \r\n           ['Current EPS Average']=avg(counttemp), ['Minimum EPS']=min(counttemp),\r\n           ['Maximum EPS']=max(counttemp)\r\n  by ['Table Name']=Type\r\n| order  by ['Current EPS Average'] desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Log Table Events Per Second (EPS) Management",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Table Name",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "uninitialized",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Current EPS Average",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "blueDark"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  },
                  {
                    "columnMatch": "Minimum EPS",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "red"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  },
                  {
                    "columnMatch": "Maximum EPS",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "green"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Size",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "purple"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Entries",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "turquoise"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Size per Entry",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "IsBillable",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "True",
                          "representation": "2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "False",
                          "representation": "success",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Important",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ],
                "sortBy": [
                  {
                    "itemKey": "$gen_bar_Current EPS Average_1",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "$gen_bar_Current EPS Average_1",
                  "sortOrder": 2
                }
              ],
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "DataType",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureActivity\r\n| where OperationNameValue contains 'microsoft.managedservices'\r\n| extend message_ = tostring(parse_json(Properties).message)\r\n| where message_ has \"Microsoft.ManagedServices\"\r\n|¬†make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†OperationName\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Lighthouse Joined Multi-Tenant Subscriptions",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Table Name",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "uninitialized",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Current EPS Average",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "blueDark"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  },
                  {
                    "columnMatch": "Minimum EPS",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "red"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": true
                      }
                    }
                  },
                  {
                    "columnMatch": "Maximum EPS",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "green"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Size",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "purple"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Entries",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "turquoise"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Size per Entry",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "IsBillable",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "True",
                          "representation": "2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "False",
                          "representation": "success",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Important",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ],
                "sortBy": [
                  {
                    "itemKey": "$gen_bar_Current EPS Average_1",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "$gen_bar_Current EPS Average_1",
                  "sortOrder": 2
                }
              ],
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "DataType",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query -12",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Central Log Management with Analysis",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Configuration Management\r\n\r\n### TIC 3.0 Guidance\r\nImplementing a formal plan for documenting, managing changes to the environment, and monitoring for deviations, preferably automated.\r\n\r\n### Microsoft Recommendation  \r\n    ‚Ä¢ Monitor & Enforce Security Baselines with Microsoft Defender for Endpoint \r\n    ‚Ä¢ Enable Change Tracking and Inventory from an Automation Account \r\n    ‚Ä¢ Monitor Configurations with Azure Defender Secure Score\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityRecommendation (Azure Security Center) ‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/azure-defender/) üî∑ SecurityBaseline (Microsoft Defender for Endpoint) ‚ú≥Ô∏è [Get Started with Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)\r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Automation Accounts > Add Automation Account > Create > Select Automation Account > Configuration Management > Change Tracking\r\n\t‚Ä¢ Microsoft 365 Security Center\r\n\t‚Ä¢ Security Center > Secure Score\r\n\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Automation Accounts](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Automation%2FAutomationAccounts) \r\nüîÑ [Microsoft 365 Security Center](https://security.microsoft.com/) \r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) \r\n\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Enable Change Tracking and Inventory From an Automation Account](https://docs.microsoft.com/azure/automation/change-tracking/enable-from-automation-account)\r\nüí°¬†[Ensure Your Endpoints Are Configured Properly](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/configure-machines)\r\nüí°¬†[Secure Score in Azure Defender](https://docs.microsoft.com/azure/security-center/secure-score-security-controls)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.BE\r\n\t‚Ä¢ PR.DS\r\n\t‚Ä¢ PR.IP\r\n    ‚Ä¢ PR.MA"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecureScoreControls\r\n| extend Percent=PercentageScore*100\r\n| summarize avg(Percent) by bin(TimeGenerated,1d), ControlName, SubscriptionId=_SubscriptionId\r\n| render timechart",
              "size": 0,
              "aggregation": 1,
              "showAnalytics": true,
              "title": "Azure Security Center: Secure Score Controls (Percentage) Over Time",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Enable Change Tracking and Inventory from an Automation account\r\n![Image¬†Name](https://docs.microsoft.com/azure/automation/change-tracking/media/enable-from-automation-account/enable-feature.png¬†¬†\"Enable Change Tracking and Inventory from an Automation account\r\n\")¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Automation](https://azure.microsoft.com/services/automation/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityBaselineSummary\r\n| summarize count() by Resource, PercentageOfPassedRules, CriticalFailedRules, WarningFailedRules\r\n| project Resource, CriticalFailedRules, WarningFailedRules, PercentageOfPassedRules\r\n| sort by CriticalFailedRules desc\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Monitor & Enforce Security Baselines with Microsoft Defender for Endpoint",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "CriticalFailedRules",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  },
                  {
                    "columnMatch": "WarningFailedRules",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orange"
                    }
                  },
                  {
                    "columnMatch": "PercentageOfPassedRules",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "green"
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Configuration Management",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Incident Response Plan and Incident Handling\r\n\r\n### TIC 3.0 Guidance\r\nDocumenting and implementing a set of instructions, procedures, or technical capabilities to sense and detect, respond to, limit consequences of malicious cyberattacks, and restore the integrity of the network and associated systems.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Detect & Report Incidents with Azure Sentinel: Incidents\r\n\t‚Ä¢ Document Response Procedures with Azure Sentinel: Notebooks\r\n\t‚Ä¢ Implement Automated Responsees with Azure Sentinel: Playbooks\r\n    ‚Ä¢ Leverage Microsoft 365 Compliance for Advanced eDiscovery\r\n\t‚Ä¢ Leverage Microsoft 365 Compliance for Insider Risk Management\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityIncident (Azure Sentinel) üî∑ AzureActivity (Azure Sentinel Playbooks) ‚ú≥Ô∏è [Get Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)\r\n\r\n### Navigate \r\n    ‚Ä¢ Azure Sentinel > Incidents\r\n\t‚Ä¢ Azure Sentinel > Notebooks\r\n\t‚Ä¢ Azure Sentinel > Playbooks\r\n\t‚Ä¢ Microsoft 365 Compliance Center > Catalog > eDiscovery > View > Open Advanced Solution\r\n\t‚Ä¢ Microsoft 365 Compliance Center > Catalog > Insider Risk Management > View > Open Solution\r\n\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Portal](https://portal.azure.com/) \r\nüîÑ [Microsoft 365 Compliance Center](https://compliance.microsoft.com/) \r\n\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Quickstart: Tutorial: Investigate incidents with Azure Sentinel](https://docs.microsoft.com/azure/sentinel/tutorial-investigate-cases)\r\nüí°¬†[Use Jupyter Notebook to Hunt for Security Threats](https://docs.microsoft.com/azure/sentinel/notebooks)\r\nüí°¬†[Tutorial: Set Up Automated Threat Responses in Azure Sentinel](https://docs.microsoft.com/azure/sentinel/tutorial-respond-threats-playbook)\r\nüí°[Overview of Microsoft 365 Advanced eDiscovery](https://docs.microsoft.com/microsoft-365/compliance/overview-ediscovery-20)\r\nüí°[Learn About Insider Risk Management in Microsoft 365](https://docs.microsoft.com/microsoft-365/compliance/insider-risk-management)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.GV\r\n\t‚Ä¢ ID.RA\r\n\t‚Ä¢ PR.IP\r\n\t‚Ä¢ DE.DP\r\n\t‚Ä¢ DE.AE\r\n\t‚Ä¢ RS.RP\r\n\t‚Ä¢ RS.CO\r\n\t‚Ä¢ RS.AN\r\n\t‚Ä¢ RS.MI"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n|¬†where¬†Severity¬†in¬†('*')¬†or¬†'All'¬†==¬†¬†\"All\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†Severity\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Sentinel Incidents Count",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Sentinel Notebooks to Document/Standardize Incident Response Procedures\r\n![Image¬†Name](https://docs.microsoft.com/azure/sentinel/media/notebooks/sentinel-azure-notebooks-compute-wizard.png¬†¬†\"Azure Sentinel Notebooks\")¬†\r\n\r\n‚ú≥Ô∏è [Get Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureActivity\r\n| where ResourceProvider == \"Microsoft.Logic\"\r\n| summarize count() by Resource\r\n| render piechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Sentinel Playbooks Triggered",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft 365 Compliance: Advanced eDiscovery to Preserve, Collect, Analyze, Review, Analyze, and Export Content \r\n![Image¬†Name](https://docs.microsoft.com/microsoft-365/media/solutions-architecture-center/m365-advanced-ediscovery-architecture.png) \r\n\r\n‚ú≥Ô∏è [Get Started with Microsoft 365 Compliance: Advanced eDiscovery](https://www.microsoft.com/microsoft-365/business/compliance-solutions)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft 365 Compliance: Insider Risk Management to Detect, Investigate, and Act on Malicious/Inadvertent Activities\r\n![Image Name](https://docs.microsoft.com/microsoft-365/media/insider-risk-investigate.png) \r\n\r\n‚ú≥Ô∏è [Get Started with Microsoft 365 Compliance: Insider Risk Management](https://www.microsoft.com/microsoft-365/business/compliance-solutions)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Incident Response Plan and Incident Handling",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Inventory\r\n\r\n### TIC 3.0 Guidance\r\nDeveloping, documenting, and maintaining a current inventory of all systems, networks, and components so that only authorized endpoints are given access, and unauthorized and unmanaged endpoints are found and prevented from gaining access.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Security Center for Asset Inventory \r\n\t‚Ä¢ Use Azure Defender: Network Map to Document Networks & Configurations \r\n\t‚Ä¢ View Installed Software with Azure Automation\r\n\t‚Ä¢ Leverage Windows Virtual Desktop for Asset Inventory \r\n\t‚Ä¢ Leverage Azure Resource Graph for Querying Assets \r\n\t‚Ä¢ Use Azure Arc for Hybrid/On-Prem Asset Management \r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ Heartbeat (Log Analytics) ‚ú≥Ô∏è [Get Started with Azure Monitor](https://azure.microsoft.com/services/monitor/) üî∑ Resources (Azure Resource Graph) ‚ú≥Ô∏è [Get Started with Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/)\r\n\r\n### Navigate \r\n\t‚Ä¢ Security Center > Inventory\r\n\t‚Ä¢ Security Center > Azure Defender > Network Map\r\n\t‚Ä¢ Automation Accounts > Inventory > Configuration Management > Software\r\n\t‚Ä¢ Windows Virtual Desktop > Create a Host Pool\r\n\t‚Ä¢ Resource Graph Explorer\r\n\t‚Ä¢ Azure Arc\t \r\n\t\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) \r\nüîÑ [Automation Accounts](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Automation%2FAutomationAccounts) \r\nüîÑ [Windows Virtual Desktop](https://portal.azure.com/#blade/Microsoft_Azure_WVD/WvdManagerMenuBlade/overview) \r\nüîÑ [Azure Resource Graph Explorer](https://portal.azure.com/#blade/HubsExtension/ArgQueryBlade) \r\nüîÑ [Azure Arc](https://portal.azure.com/#blade/Microsoft_Azure_HybridCompute/AzureArcCenterBlade/overview) \r\n\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Explore and Manage Your Resources With Asset Inventory](https://docs.microsoft.com/azure/security-center/asset-inventory) \r\nüí°¬†[Protect Your Network Resources](https://docs.microsoft.com/azure/security-center/security-center-network-recommendations)\r\nüí°¬†[View Installed Software](https://docs.microsoft.com/azure/automation/automation-tutorial-installed-software#view-installed-software)\r\nüí°¬†[What is Windows Virtual Desktop?](https://docs.microsoft.com/azure/virtual-desktop/overview)\r\nüí°¬†[What is Azure Resource Graph?](https://docs.microsoft.com/azure/governance/resource-graph/overview)\r\nüí°¬†[Azure Arc Overview](https://docs.microsoft.com/azure/azure-arc/overview)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.AM\r\n\t‚Ä¢ PR.AC\r\n\t‚Ä¢ PR.DS\r\n\t‚Ä¢ PR.IP"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "where  type contains \"microsoft\"\r\n| project id,type,location,resourceGroup\r\n| order by location asc",
              "size": 0,
              "showAnalytics": true,
              "title": "Asset Inventory by Azure Resource Graph",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Computer",
                    "formatter": 16,
                    "formatOptions": {
                      "showIcon": true
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "where  type contains \"microsoft\"\r\n| project id,type,location,resourceGroup\r\n| summarize count() by type\r\n| sort by count_ desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Asset Count by Type",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "barchart",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Computer",
                    "formatter": 16,
                    "formatOptions": {
                      "showIcon": true
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "where  type contains \"microsoft\"\r\n| project id,type,location,resourceGroup\r\n| summarize count() by location\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Asset Count by Location",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Computer",
                    "formatter": 16,
                    "formatOptions": {
                      "showIcon": true
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "where  type contains \"microsoft\"\r\n| project id,type,location,resourceGroup\r\n| summarize count()",
              "size": 2,
              "showAnalytics": true,
              "title": "Total Asset Count",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "tiles",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Computer",
                    "formatter": 16,
                    "formatOptions": {
                      "showIcon": true
                    }
                  }
                ]
              },
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "type",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 2,
                      "maximumSignificantDigits": 3
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 8",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "resources\r\n| where type =~ 'microsoft.operationalinsights/workspaces' \r\n| extend state = trim(' ', tostring(properties.provisioningState))\r\n\t\t,sku   = trim(' ', tostring(properties.sku.name))\r\n        ,skuUpdate = trim(' ', tostring(properties.sku.lastSkuUpdate))\r\n\t\t,retentionDays = trim(' ', tostring(properties.retentionInDays))\r\n\t\t,dailyquotaGB  = trim(' ', tostring(properties.workspaceCapping.dailyQuotaGb))\r\n| extend dailyquotaGB = iif(dailyquotaGB !=-1.0, dailyquotaGB,\"Not set\")\r\n| extend skuUpdate    = iif(strlen(skuUpdate) > 0, skuUpdate,\"Unknown\")\r\n| extend sentinel     = iif(toint(retentionDays) < 90,\"If you have Sentinel, you can change your retention to 90days (free)?\",\"\")\r\n| project ['Workspace Name']=id, ['Resource Group']=resourceGroup, location, ['Data Retention(days)']=retentionDays, ['Daily Data Cap']=dailyquotaGB, ['License']=sku",
              "size": 2,
              "showAnalytics": true,
              "title": "Workspace Inventory",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Computer",
                    "formatter": 16,
                    "formatOptions": {
                      "showIcon": true
                    }
                  }
                ],
                "sortBy": [
                  {
                    "itemKey": "$gen_link_Workspace Name_0",
                    "sortOrder": 1
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "$gen_link_Workspace Name_0",
                  "sortOrder": 1
                }
              ],
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "type",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 2,
                      "maximumSignificantDigits": 3
                    }
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 8 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Heartbeat\r\n| where ResourceProvider in (\"Microsoft.Compute\")\r\n| distinct Computer, ComputerIP, OSType, Category, ResourceGroup, ResourceType \r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Asset Inventory: Azure Virtual Machines",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Computer",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "uninitialized",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "OSType",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Windows",
                          "representation": "blue",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Linux",
                          "representation": "red",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "mac",
                          "representation": "magenta",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Category",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "trenddown",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Heartbeat\r\n| where ResourceProvider in (\"Microsoft.HybridCompute\")\r\n| distinct Computer, ComputerIP, OSType, Category, ResourceGroup, ResourceType ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Arc:  Hybrid/On Prem Joined Machines",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Computer",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "uninitialized",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "OSType",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Windows",
                          "representation": "blue",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Linux",
                          "representation": "red",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "contains",
                          "thresholdValue": "mac",
                          "representation": "magenta",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "lightBlue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Category",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "trenddown",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Use Azure Defender: Network Map to Document Networks & Configurations\r\n![Image¬†Name](https://docs.microsoft.com/azure/security-center/media/security-center-network-recommendations/network-map-info.png¬†¬†\"Network Map\")¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Defender](https://azure.microsoft.com/services/azure-defender/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### View Installed Software with Azure Automation\r\n![Image¬†Name](https://docs.microsoft.com/azure/automation/media/automation-tutorial-installed-software/inventory-software.png¬†¬†\"View Installed Software\")¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Automation](https://azure.microsoft.com/services/automation/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Windows Virtual Desktop for Asset Inventory\r\n![Image¬†Name](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/188547iD2BFC36627FB0A1A/image-size/large)¬†\r\n\r\nüí° [Monitoring Windows Virtual Desktop Environments](https://techcommunity.microsoft.com/t5/azure-sentinel/monitoring-windows-virtual-desktop-environments-fall-2019/ba-p/1356632)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Inventory",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Least Privilege\r\n\r\n### TIC 3.0 Guidance\r\nDesigning the security architecture such that each entity is granted the minimum system resources and authorizations that the entity needs to perform its function.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Administer Least Privilege with Azure Active Directory: Role Based Access Control (RBAC)\r\n\t‚Ä¢ Evaluate User Rights with Azure Sentinel: User Entity Behavior Analytics (UEBA)\r\n\t‚Ä¢ Monitor Non-Interactive User Sign-ins with Azure Active Directory\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ AzureActivity¬†(Azure Active Directory) ‚ú≥Ô∏è [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/trial/get-started-active-directory/) \r\nüî∑ UserAccessAnalytics (Azure Sentinel) ‚ú≥Ô∏è [Get Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)\r\nüî∑ AADNonInteractiveUserSignInLogs¬†(Azure Active Directory) ‚ú≥Ô∏è [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/trial/get-started-active-directory/) \r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Active Directory > Roles & Administrators\r\n\t‚Ä¢ Azure Sentinel > User Entity Behavior Analytics\r\n\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) \r\nüîÑ [Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) \r\n\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Administrator roles by admin task in Azure Active Directory](https://docs.microsoft.com/azure/active-directory/roles/delegate-by-task)\r\nüí°¬†[Overview of role-based access control in Azure Active Directory](https://docs.microsoft.com/azure/active-directory/roles/custom-overview)\r\nüí°¬†[Enable User and Entity Behavior Analytics (UEBA) in Azure Sentinel](https://docs.microsoft.com/azure/sentinel/enable-entity-behavior-analytics)\r\nüí°¬†[Azure Active Directory Sign-In Activity](https://docs.microsoft.com/azure/active-directory/reports-monitoring/concept-all-sign-ins)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.AM\r\n\t‚Ä¢ PR.AC\r\n\t‚Ä¢ PR.IP\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ DE.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "UserAccessAnalytics\r\n| project AccessLevel, TimeGenerated\r\n| where AccessLevel <> \"Member\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by AccessLevel\r\n| render timechart",
              "size": 0,
              "showAnalytics": true,
              "title": "Action Count By Role Over Time",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "User",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "info",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Activities",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Action Count By Role Over Time",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureActivity\r\n| summarize Activities = count() by User = Caller\r\n| sort by Activities desc\r\n| take 250",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Active Directory Users by Action Count",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "User",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "info",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Activities",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "UserAccessAnalytics\r\n| summarize count() by AccessLevel\r\n| sort by count_ desc\r\n| render barchart ",
              "size": 0,
              "showAnalytics": true,
              "title": "User Access Analytics: User Roles by Action Count",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "User",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "info",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Activities",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### User Role Assignment Evaluation\r\n![Image¬†Name](https://docs.microsoft.com/azure/active-directory/roles/media/custom-overview/rbac-overview.png¬†¬†\"User Role\")¬†\r\n\r\n‚ú≥Ô∏è [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/trial/get-started-active-directory/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AADNonInteractiveUserSignInLogs\r\n| project AppDisplayName, Identity, TimeGenerated\r\n| summarize count() by Identity\r\n| sort by count_ desc\r\n| render piechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "AAD Non Interactive User Sign-In Logs By Identity",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "User",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "info",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Activities",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "AAD Non Interactive User Sign-In Logs By Identity",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AADNonInteractiveUserSignInLogs\r\n| project AppDisplayName, Identity, TimeGenerated\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by AppDisplayName\r\n| render timechart",
              "size": 0,
              "showAnalytics": true,
              "title": "AAD Non Interactive User Sign-In Logs By Application ",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "User",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "info",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Activities",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "AAD Non Interactive User Sign-In Logs By Application ",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Least Privilege",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Secure Administration\r\n\r\n### TIC 3.0 Guidance\r\nPerforming administrative tasks in a secure manner, using secure protocols.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Separate organizational duties with Azure Active Directory: Roles and Administrators\r\n\t‚Ä¢ Require Split-Delegation of Elevated Rights with Azure Active Directory: Privileged Identity Management \r\n\t‚Ä¢ Leverage Customer Lockbox for Secure Administration Support \r\n\t‚Ä¢ Use Privileged Access Workstations (PAW) for a Highly Restricted Attack Surface\r\n\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ AuditLogs (Privileged Identity Management) ‚ú≥Ô∏è [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/trial/get-started-active-directory/)\r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Active Directory > Manage > Role & Administrators\r\n\t‚Ä¢ Azure Active Directory > Identity Governance > Privileged Identity Management\r\n\t‚Ä¢ Customer Lockbox for Microsoft Azure > Overview\r\n\t‚Ä¢ Privileged Access Workstations\r\n\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) \r\nüîÑ [Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart) \r\nüîÑ [Customer Lockbox for Microsoft Azure](https://portal.azure.com/#blade/Microsoft_Azure_Lockbox/LockboxMenu/Overview) \r\n\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Delegate Administration in Azure Active Directory](https://docs.microsoft.com/azure/active-directory/roles/concept-delegation)¬†\r\nüí°¬†[Start Using Privileged Identity Management](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-getting-started#)¬†\r\nüí°¬†[Customer Lockbox for Microsoft Azure](https://docs.microsoft.com/azure/security/fundamentals/customer-lockbox-overview)¬†\r\nüí°¬†[Securing Devices as Part of the Privileged Access Story](https://docs.microsoft.com/security/compass/privileged-access-devices)¬†\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.MA"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AuditLogs\r\n| where Identity == \"MS-PIM\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by OperationName\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Privileged Identity Management Actions",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Develop a Secure Administration Strategy\r\n![Image¬†Name](https://docs.microsoft.com/security/compass/media/overview/end-to-end-approach.png)¬†\r\n\r\n‚ú≥Ô∏è [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/trial/get-started-active-directory/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Customer Lockbox for Secure Administration Support\r\n![Image¬†Name](https://docs.microsoft.com/azure/security/fundamentals/media/customer-lockbox-overview/customer-lockbox-landing-page.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Customer Lockbox](https://aka.ms/customerlockbox/insiderprogram)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Use Privileged Access Workstations (PAW) for a Highly Restricted Attack Surface\r\n![Image¬†Name](https://docs.microsoft.com/security/compass/media/privileged-access-devices/secure-workstations-levels.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Privileged Access Workstations](https://docs.microsoft.com/security/compass/privileged-access-devices)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "PAW",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Secure Administration",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Strong Authentication\r\n\r\n### TIC 3.0 Guidance\r\nVerifying the identity of users, endpoints, or other entities through rigorous means (e.g. multi-factor authentication) before granting access.\r\n\r\n### Microsoft Recommendation  \r\n    ‚Ä¢ Leverage Azure Active Directory to Apply Multi-Factor Authentication to Privileged/Non-Privileged Accounts\r\n    ‚Ä¢ Monitor Secure Authentications with Azure Security Center Recommendations\r\n    ‚Ä¢ Leverage Azure Key Vault to Securly Store Secrets for SSH Authentication to Linux Machines \r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SigninLogs (Azure Active Directory) ‚ú≥Ô∏è [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/trial/get-started-active-directory/)\r\nüî∑ SecurityRecommendation (Azure Security Center) ‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/security-center/)\r\n\r\n### Navigate \r\n    ‚Ä¢ Azure Active Directory > Users > Multi Factor Authentication\r\n    ‚Ä¢ Security Center > Recommendations > Enable MFA\r\n    ‚Ä¢ Key Vaults\r\n\t\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) \r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) \r\nüîÑ [Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults) \r\n\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Plan an Azure AD Multi-Factor Authentication Deployment](https://docs.microsoft.com/azure/active-directory/authentication/howto)\r\nüí°¬†[How it works: Azure AD Multi-Factor Authentication](https://docs.microsoft.com/azure/active-directory/authentication/concept-mfa-howitworks)\r\nüí°¬†[Remediate recommendations in Azure Security Center](https://docs.microsoft.com/azure/security-center/security-center-remediate-recommendations)\r\nüí° [SecretManagement and Accessing Linux VMs in Azure](https://techcommunity.microsoft.com/t5/itops-talk-blog/secretmanagement-and-accessing-linux-vms-in-azure/ba-p/2278735)\r\nüí° [Eliminate Password-Based Attacks on Azure Linux VMs](https://techcommunity.microsoft.com/t5/azure-security-center/eliminate-password-based-attacks-on-azure-linux-vms/ba-p/2271139)\r\nüí° [Quickstart: Create a Key Vault Using the Azure Portal](https://techcommunity.microsoft.com/t5/itops-talk-blog/secretmanagement-and-accessing-linux-vms-in-azure/ba-p/2278735)\r\n\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n    ‚Ä¢ PR.AC"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationName contains \"MFA\" \r\nor RecommendationName contains \"auth\"\r\nor RecommendationName contains \"privilege\"\r\nor RecommendationName contains \"security hub\"\r\nor RecommendationName contains \"access\"\r\nor RecommendationName contains \"network security group\"\r\nor RecommendationName contains \"management ports\"\r\nor RecommendationName contains \"owner\"\r\nor RecommendationName contains \"root\"\r\nor RecommendationName contains \"certificate\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†RecommendationName\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Security Center: Recommendations for Authentication",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SigninLogs\r\n| extend ResultText = case(isnotempty(ResultDescription), ResultDescription, ResultType == 0 and isempty(ResultDescription), \"Successfull login\", \"unknown\")\r\n| summarize dcount(CorrelationId) by ResultText, bin(TimeGenerated, 1d) // summarize the total Signin events per Description per hour (by unique CorrelationId's)\r\n| render areachart\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Authentication Codes",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Configure Multi Factor Authentication\r\n![Image¬†Name](https://docs.microsoft.com/azure/active-directory/authentication/media/tutorial-enable-azure-mfa/conditional-access-overview.png)¬†\r\n\r\n‚ú≥Ô∏è [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/trial/get-started-active-directory/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Key Vault to Securly Store Secrets for SSH Authentication to Linux Machines\r\n![Image¬†Name](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/272626i0AA840404CC924AD/image-size/large?v=v2&px=999)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Key Vault](https://azure.microsoft.com/services/key-vault/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": " Strong Authentication",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Time Synchronization\r\n\r\n### TIC 3.0 Guidance\r\nCoordinating clocks on all systems (e.g. servers, workstations, network endpoints) to enable accurate comparison of timestamps between systems.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Azure hosts are synchronized to internal Microsoft time servers that take their time from Microsoft-owned Stratum 1 endpoints, with GPS antennas. \r\n\t‚Ä¢ Virtual machines in Azure can either depend on their host to pass the accurate time (host time) on to the VM or the VM can directly get time from a time server, or a combination of both.\r\n\t‚Ä¢ You can monitor Security Baselines to evaluate health status of Windows NTP clients.\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityBaseline (Microsoft Defender for Endpoint) ‚ú≥Ô∏è [Get Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender) \r\n\r\n### Navigate \r\n\t‚Ä¢ Powershell Command: w32tm /dumpreg /subkey:Parameters | findstr /i \"ntpserver\"\r\n\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Portal](https://portal.azure.com/) \r\nüîÑ [Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines) \r\nüîÑ [Microsoft 365 Compliance Center](https://compliance.microsoft.com/) \r\n\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Time Sync for Windows VMs in Azure](https://docs.microsoft.com/azure/virtual-machines/windows/time-sync)\r\n\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.IP"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Time Synchronization",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityBaseline\r\n| where Description == \"Ensure \\'Enable Windows NTP Client\\' is set to \\'Enabled\\'\" or Description == \"Ensure \\'Enable Windows NTP Client\\' is set to \\'Disabled\\'\"\r\n| project Resource, AnalyzeResult, ResourceType, ComputerEnvironment, Computer, CceId, RuleSeverity, TimeGenerated\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AnalyzeResult\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Review Security Baseline for NTP Client Failures",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Time Synchronization",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Vulnerability Management\r\n\r\n### TIC 3.0 Guidance\r\nProactively working to discover vulnerabilities, including the use of both active and passive means of discovery, and taking action to mitigate discovered vulnerabilities.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Assess Vulnerabilities with Azure Security Center: Recommendations\r\n\t‚Ä¢ Monitor Posture with Azure Security Center: Secure Score\r\n\t‚Ä¢ Leverage Microsoft Defender for Endpoint for Vulnerability Management\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityRecommendation (Azure Security Center) ‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/security-center/)\r\nüî∑ SecurityBaseline (Microsoft Defender for Endpoint) ‚ú≥Ô∏è [Get Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)\r\n\r\n### Navigate \r\n\t‚Ä¢ Security Center > Recommendations\r\n\t‚Ä¢ Security Center > Secure Score\r\n\t‚Ä¢ Microsoft 365 Security Center > Threat Vulnerability Management\r\n\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) \r\nüîÑ [Microsoft 365 Compliance Center](https://compliance.microsoft.com/) \r\n\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Use Azure Security Center Recommendations to Enhance Security](https://docs.microsoft.com/azure/security-center/security-center-using-recommendations)\r\nüí°¬†[Secure Score in Azure Defender](https://docs.microsoft.com/azure/security-center/secure-score-security-controls)\r\nüí°¬†[Azure Defender's Integrated Vulnerability Assessment Solution for Azure and Hybrid Machine](https://docs.microsoft.com/azure/security-center/built-in-vulnerability-assessment)\r\nüí°¬†[Threat and Vulnerability Management Walk-Through](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/next-gen-threat-and-vuln-mgt)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.RA\r\n\t‚Ä¢ PR.IP\r\n\t‚Ä¢ DE.AE\r\n\t‚Ä¢ DE.CM\r\n\t‚Ä¢ DE.DP"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationName contains \"vuln\" or RecommendationName contains \"assess\" or RecommendationName contains \"update\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†RecommendationName\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Security Center: Vulnerabilty Management Recommednations",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecureScoreControls\r\n| extend Percent=PercentageScore*100\r\n| summarize avg(Percent) by bin(TimeGenerated,1d), ControlName, SubscriptionId=_SubscriptionId\r\n| render timechart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Security Center: Secure Score",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RemediationDescription contains \"aws\" or RemediationDescription contains \"amazon\" or RemediationDescription contains \"google\" or RemediationDescription contains \"gcp\" or RecommendationDisplayName contains \"AWS\" or RecommendationDisplayName contains \"Amazon\" or RecommendationDisplayName contains \"GCP\" or RecommendationDisplayName contains \"Google\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†RecommendationDisplayName\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Security Center: Multi-Cloud Vulnerability Recommendations",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityBaseline\r\n|project CceId, RuleSeverity, Description, Resource, ComputerEnvironment\r\n|limit 50",
              "size": 0,
              "showAnalytics": true,
              "title": "Priority Securty Baseline Vulnerabilities",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "CceId",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "red",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "RuleSeverity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "contains",
                          "thresholdValue": "Critical",
                          "representation": "redBright",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Resource",
                    "formatter": 16,
                    "formatOptions": {
                      "showIcon": true
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 4",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Vulnerability Management",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Patch Management\r\n\r\n### TIC 3.0 Guidance\r\nIdentifying, acquiring, installing, and verifying patches for products and systems.\r\n\r\n### Microsoft Recommendation  \r\n    ‚Ä¢ Enable Update Management with Azure Automation \r\n    ‚Ä¢ Track Update Recommendations with Azure Security Center\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityRecommendation (Azure Security Center) ‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/security-center/)\r\n### Navigate \r\n    ‚Ä¢ Virtual Machines > Select VMs > Services > Update Management\r\n    ‚Ä¢ Security Center > Recommendations\r\n\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Automation Accounts](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Automation%2FAutomationAccounts) \r\nüîÑ [Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines) \r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) \r\n\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Update Management Overview](https://docs.microsoft.com/azure/automation/update-management/overview)\r\nüí°¬†[Enable Update Management From the Azure Portal](https://docs.microsoft.com/azure/automation/update-management/enable-from-portal)\r\nüí°¬†[Handling Planned Maintenance Notifications Using the Azure Portal](https://docs.microsoft.com/azure/virtual-machines/maintenance-notifications-portal)\r\nüí°¬†[Managing Platform Updates with Maintenance Control](https://docs.microsoft.com/azure/virtual-machines/maintenance-control?toc=/azure/virtual-machines/linux/toc.json&bc=/azure/virtual-machines/linux/breadcrumb/toc.json)\r\nüí°¬†[Scheduling Maintenance Updates with Maintenance Control and Azure Functions](https://github.com/Azure/azure-docs-powershell-samples/tree/master/maintenance-auto-scheduler)\r\nüí° [Use Azure Security Center Recommendations to Enhance Security](https://docs.microsoft.com/azure/security-center/security-center-using-recommendations)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.AM\r\n\t‚Ä¢ PR.IP\r\n\t‚Ä¢ PR.MA"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationName == \"System updates should be installed on your machines\" or RecommendationName contains \"upgrade\" or RecommendationName contains \"update\" or RecommendationName contains \"patch\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†RecommendationDisplayName\r\n|¬†render¬†areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Security Center: Recommendations for Updates",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 4",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Configure Update Management\r\n![Image¬†Name](https://docs.microsoft.com/azure/automation/update-management/media/enable-from-portal/vmlist.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Automation](https://azure.microsoft.com/services/automation/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Update Management to Assess and Apply Security Updates to All Connected Windows & Linux Servers in a Workspace\r\n![Image¬†Name](https://docs.microsoft.com/azure/automation/update-management/media/overview/update-mgmt-updateworkflow.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Automation](https://azure.microsoft.com/services/automation/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Patch Management",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Auditing and Accounting\r\n\r\n### TIC 3.0 Guidance\r\nCapturing business records, including logs and other telemetry, and making them available for auditing and accounting as required. Design of the auditing system should take insider threat into consideration, including separation of duties violation tracking, such that insider abuse or misuse can be detected.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Configure Audit Logging for All Assets via Diagnostic Settings\r\n\t‚Ä¢ Control User Logging Access with Azure Active Directory: Role Based Access Control (RBAC)\r\n\t‚Ä¢ Track Logging Recommendations with Azure Security Center\r\n\t‚Ä¢ Track Abnormal Log Usage with Azure Monitor\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ Usage (Log Analytics) ‚ú≥Ô∏è [Get Started with Azure Monitor](https://azure.microsoft.com/services/monitor/)\r\nüî∑ SigninLogs (Azure Active Directory) ‚ú≥Ô∏è [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/trial/get-started-active-directory/\r\nüî∑ SecurityRecommendation (Azure Security Center) ‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/security-center/)\r\nüî∑ LAQueryLogs (Log Analytics) ‚ú≥Ô∏è [Get Started with Azure Monitor](https://azure.microsoft.com/services/monitor/)\r\n### Navigate \r\n\t‚Ä¢ Resource Groups > Select Azure Resource > Diagnostic Settings > Add Diagnostic Setting > Select Desired Configurations > Send to Log Analytics \r\n\t‚Ä¢ Azure Active Directory > Roles and Administrators\r\n\t‚Ä¢ Security Center > Recommendations\r\n\t‚Ä¢ Azure Sentinel > Logs > Develop LAQueryLogs Query > New Alert Rule > Create Azure Sentinel Alert\r\n\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Resource Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResourceGroups) \r\nüîÑ [Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) \r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) \r\nüîÑ [Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) \r\n\r\n###¬†Microsoft¬†Reference¬†\r\nüí° [Create Diagnostic Settings to Send Platform Logs and Metrics to Different Destinations](https://docs.microsoft.com/azure/azure-monitor/platform/diagnostic-settings)\r\nüí°¬†[Tutorial: Grant a User Access to Azure Resources Using the Azure Portal](https://docs.microsoft.com/azure/role-based-access-control/quickstart-assign-role-user-portal)\r\nüí°¬†[Use Azure Security Center Recommendations to Enhance Security](https://docs.microsoft.com/azure/security-center/security-center-using-recommendations)\r\nüí°¬†[Auditing Azure Sentinel Activities](https://techcommunity.microsoft.com/t5/azure-sentinel/auditing-azure-sentinel-activities/ba-p/1718328)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.SC\r\n\t‚Ä¢ PR.AC\r\n\t‚Ä¢ PR.PT"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Usage\r\n| summarize¬†count()¬†by¬†DataType\r\n| sort¬†by¬†count_¬†desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Log Events Count by Log Source",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "tiles",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "DataType",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationDisplayName¬†contains \"agent\" or RecommendationDisplayName contains \"log\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†RecommendationDisplayName\r\n|¬†render¬†areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Security Center: Recommendations for Logging",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "DataType",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "LAQueryLogs\r\n| summarize events_count=count() by AADEmail\r\n| extend UserPrincipalName = AADEmail, Queries = events_count\r\n| join kind= leftouter (\r\n    SigninLogs)\r\n    on UserPrincipalName\r\n| project UserPrincipalName, Queries\r\n| summarize arg_max(Queries, *) by UserPrincipalName\r\n| sort by Queries desc\r\n| render columnchart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Monitor Abnormal User Log Usage",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "DataType",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "count_",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Auditing and Accounting",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Resilience\r\n\r\n### TIC 3.0 Guidance\r\nEnsuring that systems, services, and protections maintain acceptable performance under adverse conditions.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure DDoS Standard to Maintain Workload Under Adverse Conditions\r\n\t‚Ä¢ Leverage Azure Availability Zones for Redundancy\r\n\t‚Ä¢ Deploy Azure Load Balancer for Distributed Inbound Flows\r\n\t‚Ä¢ Deploy Azure Web Application Firewall for Web App Defense\r\n\t‚Ä¢ Create Virtual Machine Scale Sets for Elastic Expansion\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityAlert¬†(Azure DDoS Standard) ‚ú≥Ô∏è [Get Started with Azure DDoS Protection](https://azure.microsoft.com/services/ddos-protection) \r\nüî∑ SecurityAlert¬†(Azure Web Application Firewall) ‚ú≥Ô∏è [Get Started with Azure Web Application Firewall](https://azure.microsoft.com/services/web-application-firewall/) \r\n\r\n### Navigate \r\n\t‚Ä¢ DDoS Protection Plans > Create\r\n\t‚Ä¢ Availability Sets > Create\r\n\t‚Ä¢ Load Balancers > Add\r\n\t‚Ä¢ Web Application Firewall Policies (WAF) > Create\r\n\t‚Ä¢ Virtual Machine Scale Sets > Add\r\n\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [DDoS Protection Plans](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FddosProtectionPlans) \r\nüîÑ [Availability Sets](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FavailabilitySets) \r\nüîÑ [Load Balancing](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)\r\nüîÑ [Web Application Firewall Policies](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)  \r\nüîÑ [Virtual Machine Scale Sets](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Compute%2FvirtualMachineScaleSets)  \r\n\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Azure DDoS Protection Standard Overview](https://docs.microsoft.com/azure/ddos-protection/ddos-protection-overview)\r\nüí°¬†[Building Solutions for High Availability Using Availability Zones](https://docs.microsoft.com/azure/architecture/high-availability/building-solutions-for-high-availability)¬†\r\nüí°¬†[Azure Infrastructure Availability](https://docs.microsoft.com/azure/security/fundamentals/infrastructure-availability)¬†\r\nüí°¬†[What is Azure Load Balancer?](https://docs.microsoft.com/azure/load-balancer/load-balancer-overview)\r\nüí°¬†[What is Azure Web Application Firewall on Azure Application Gateway?](https://docs.microsoft.com/azure/web-application-firewall/ag/ag-overview)¬†\r\nüí°¬†[What are virtual machine scale sets?](https://docs.microsoft.com/azure/virtual-machine-scale-sets/overview)¬†\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.BE\r\n\t‚Ä¢ PR.PT"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where TimeGenerated > ago(180d)\r\n| where AlertName contains \"DoS\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AlertName\r\n| render areachart \r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "DDoS Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Availability Zones for Security Control Redundancy\r\n![Image¬†Name](https://docs.microsoft.com/azure/architecture/high-availability/images/high-availability-001.png¬†¬†\"Azure infrastructure availability\")¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Regions and Availability Zones](https://docs.microsoft.com/azure/availability-zones/az-overview) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Deploy Azure Load Balancer for Distributed Inbound Flows\r\n![Image¬†Name](https://docs.microsoft.com/azure/load-balancer/media/quickstart-load-balancer-standard-public-portal/resources-diagram.png¬†\"Azure Load Balancer\")¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Load Balancing](https://azure.microsoft.com/products/azure-load-balancing/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where AlertName contains \"WAF\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AlertName\r\n|¬†render¬†areachart\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Web Application Firewall Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Create Virtual Machine Scale Sets for Elastic Expansion\r\n![Image¬†Name](https://docs.microsoft.com/azure/virtual-machine-scale-sets/media/virtual-machine-scale-sets-instance-ids/vmssinstances.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Virtual Machine Scale Sets]( https://azure.microsoft.com/services/virtual-machine-scale-sets/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Resilience",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Enterprise Threat Intelligence\r\n\r\n### TIC 3.0 Guidance\r\nObtaining threat intelligence from private and government sources and implementing mitigations for the identified risks.\r\n\r\n### Microsoft Recommendation  \r\n    ‚Ä¢ Manage Cyber Threat Intelligence with Azure Sentinel: Threat Intelligence Platforms / Threat Intelligence TAXII\r\n    ‚Ä¢ Leverage Microsoft Security Intelligence to Learn About Threats, Get Updates, Report Malicious URLs, Submit Files, and Review Reporting\r\n    ‚Ä¢ Leverage Microsoft Graph Security tiIndicators API for Threat Indicator Ingestion & Sharing\r\n\t‚Ä¢ Leverage MSTICPy for Threat Intelligence Enrichment with Azure Sentinel Notebooks\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ ThreatIntelligenceIndicator (Azure Sentinel) ‚ú≥Ô∏è [Get Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)\r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Sentinel > Data Connectors > Threat Intelligence \r\n\t‚Ä¢ Azure Sentinel > Threat Intelligence\r\n\t‚Ä¢ Microsoft Security Intelligence Portal > Learn About Threats\r\n\t‚Ä¢ Microsoft Graph Security tiIndicators API\r\n\t‚Ä¢ Azure Sentinel > Notebooks\r\n\t\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) \r\nüîÑ [Microsoft Defender Security Intelligence Portal](https://microsoft.com/wdsi)\r\nüîÑ [Resource Graph Queries](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.resourcegraph%2Fqueries) \r\nüîÑ [MSTICpy](https://github.com/Microsoft/msticpy) \r\n\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Connect Data from Threat Intelligence Providers](https://docs.microsoft.com/azure/sentinel/connect-threat-intelligence)\r\nüí°¬†[Microsoft Security Intelligence Portal](https://www.microsoft.com/wdsi)\r\nüí° [Microsoft Graph Security tiIndicators API](https://docs.microsoft.com/graph/api/resources/tiindicator)\r\nüí° [MSTIC Jupyter and Python Security Tools](https://github.com/Microsoft/msticpy)\r\nüí° [Use Jupyter Notebook to Hunt for Security Threats](https://docs.microsoft.com/azure/sentinel/connect-threat-intelligence)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.RA\r\n\t‚Ä¢ DE.AE\r\n\t‚Ä¢ DE.CM\r\n\t‚Ä¢ DE.DP"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ThreatIntelligenceIndicator\r\n| summarize arg_max(TimeGenerated, *) by IndicatorId\r\n| summarize CountOfIndicators = count() by SourceSystem\r\n| order by CountOfIndicators desc \r\n| render barchart kind=unstacked",
              "size": 0,
              "showAnalytics": true,
              "title": "Cyber Threat Intelligence Indicator Counts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft Security Intelligence to Learn About Threats, Get Updates, Report Malicious URLs, Submit Files, and Review Reporting\r\n![Image Name](https://www.microsoft.com/security/blog/wp-content/uploads/2019/02/CTA-feature-1024x729.jpg)\r\n\r\n‚ú≥Ô∏è [Microsoft Security Intelligence](https://www.microsoft.com/wdsi) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Microsoft Security Intelligence",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage MSTICPy for Threat Intelligence Enrichment with Azure Sentinel Notebooks\r\n\r\nMSTICPy is a library for InfoSec investigation and hunting in Jupyter Notebooks. It includes functionality to:\r\n\r\n    ‚Ä¢ Query log data from multiple sources\r\n    ‚Ä¢ Enrich the data with Threat Intelligence, geolocations and Azure resource data\r\n    ‚Ä¢ Extract Indicators of Activity (IoA) from logs and unpack encoded data\r\n    ‚Ä¢ Perform sophisticated analysis such as anomalous session detection and time series decomposition\r\n    ‚Ä¢ Visualize data using interactive timelines, process trees and multi-dimensional Morph Chart\r\n![Image Name](https://github.com/microsoft/msticpy/raw/master/docs/source/visualization/_static/Timeline-08.png)\r\n\r\n‚ú≥Ô∏è [Get Started with MSTICPy](https://github.com/Microsoft/msticpy) \r\nüí°¬†[Use Jupyter Notebook to Hunt for Security Threats](https://docs.microsoft.com/azure/sentinel/connect-threat-intelligence)\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Microsoft Security Intelligence - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Enterprise Threat Intelligence",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Situational Awareness\r\n\r\n### TIC 3.0 Guidance\r\nMaintaining effective awareness, both current and historical, across all components.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Sentinel to Consolidate Security Alerting for Situational Awareness\r\n\t‚Ä¢ Use Network Watcher to Monitor, Diagnose, and Log Azure Virtual Networks \r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityAlert (Azure Sentinel) ‚ú≥Ô∏è [Get Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)\r\nüî∑ SecurityAlert (Azure Defender) ‚ú≥Ô∏è [Get Started with Azure Defender](https://azure.microsoft.com/services/azure-defender/)\r\nüî∑ SecurityAlert (Microsoft Defender for Endpoint) ‚ú≥Ô∏è [Get Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)\r\nüî∑ SecurityAlert (Microsoft Defender for Office 365) ‚ú≥Ô∏è [Get Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)\r\nüî∑ SecurityAlert (Microsoft Defender for Identity) ‚ú≥Ô∏è [Get Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)\r\n### Navigate \r\n\t‚Ä¢ Azure Sentinel > Workbooks > Security Alerts\r\n\t‚Ä¢ Network Watcher\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) \r\nüîÑ [Network Watcher](https://portal.azure.com/#blade/Microsoft_Azure_Network/NetworkWatcherMenuBlade/overview)\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Get Visibility Into Alerts](https://docs.microsoft.com/azure/sentinel/quickstart-get-visibility)\r\nüí° [What is Azure Network Watcher?](https://docs.microsoft.com/graph/api/resources/tiindicator)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.AM\r\n\t‚Ä¢ ID.RA\r\n\t‚Ä¢ PR.DS\r\n\t‚Ä¢ PR.IP\r\n\t‚Ä¢ DE.AE\r\n\t‚Ä¢ DE.CM\r\n\t‚Ä¢ DE.DP\r\n\t‚Ä¢ RS.CO"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where isnotempty(ProviderName)\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†ProviderName, VendorName\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Security Alerts By Source",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Use Network Watcher to Monitor, Diagnose, and Log Azure Virtual Networks\r\n![Image Name](https://docs.microsoft.com/azure/network-watcher/media/network-watcher-monitoring-overview/traffic-analytics.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Network Watcher](https://azure.microsoft.com/services/network-watcher/) "
            },
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Network Watcher"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Situational Awareness",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Dynamic Threat Discovery\r\n\r\n### TIC 3.0 Guidance\r\nUsing dynamic approaches (e.g. heuristics, baselining, etc.) to discover new malicious activity.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Sentinel: Fusion Alerts for Machine Learning Alert Correlations\r\n\t‚Ä¢ Use Azure Sentinel: User Entity Behavior Analytics for Anomaly Detection and Baseline Deviations\r\n\t‚Ä¢ Leverage Azure Security Center for Heuristics Detections\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityAlert (Azure Sentinel) üî∑ BehaviorAnalytics (Azure Sentinel)‚ú≥Ô∏è [Get Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) üî∑ SecurityAlert (Azure Security Center) ‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/security-center/)\r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Sentinel > Analytics > Rule Type > Fusion\r\n\t‚Ä¢ Azure Sentinel > User Entity Behavior Analytics\r\n\t‚Ä¢ Azure Security Center > Alerts\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) \r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Advanced Multistage Attack Detection in Azure Sentinel](https://docs.microsoft.com/azure/sentinel/fusion)\r\nüí°¬†[Enable User and Entity Behavior Analytics (UEBA) in Azure Sentinel](https://docs.microsoft.com/azure/sentinel/enable-entity-behavior-analytics)\r\nüí°¬†[Heuristic Detections in Azure Security Center](https://azure.microsoft.com/blog/heuristic-dns-detections-in-azure-security-center/)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.RA\r\n\t‚Ä¢ DE.AE\r\n\t‚Ä¢ DE.CM\r\n\t‚Ä¢ DE.DP"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let AnomalousSigninActivity = BehaviorAnalytics\r\n    | where ActionType == \"Sign-in\"\r\n    | where (UsersInsights.NewAccount == True or UsersInsights.DormantAccount == True) and (\r\n        ActivityInsights.FirstTimeUserAccessedResource == True and ActivityInsights.ResourceUncommonlyAccessedAmongPeers == True\r\n        or ActivityInsights.FirstTimeUserUsedApp == True and ActivityInsights.AppUncommonlyUsedAmongPeers == False)\r\n    | join (\r\n        SigninLogs | where Status.errorCode == 0 or Status.errorCode == 0 and RiskDetail != \"none\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Successful Logon\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Successful Sign-in with one or more of the following indications: sign by new or recently dormant accounts and sign in with resource for the first time (while none of their peers did) or to an app for the first time (while none of their peers did) or performed by a user with Risk indicaiton from AAD\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet critical = dynamic(['9b895d92-2cd3-44c7-9d02-a6ac2d5ea5c3', 'c4e39bd9-1100-46d3-8c65-fb160da0071f', '158c047a-c907-4556-b7ef-446551a6b5f7', '62e90394-69f5-4237-9190-012177145e10', 'd29b2b05-8046-44ba-8758-1e26182fcf32', '729827e3-9c14-49f7-bb1b-9608f156bbb8', '966707d0-3269-4727-9be2-8c3a10f19b9d', '194ae4cb-b126-40b2-bd5b-6091b380977d', 'fe930be7-5e62-47db-91af-98c3a49a38b1']);\r\nlet high = dynamic(['cf1c38e5-3621-4004-a7cb-879624dced7c', '7495fdc4-34c4-4d15-a289-98788ce399fd', 'aaf43236-0c0d-4d5f-883a-6955382ac081', '3edaf663-341e-4475-9f94-5c398ef6c070', '7698a772-787b-4ac8-901f-60d6b08affd2', 'b1be1c3e-b65d-4f19-8427-f6fa0d97feb9', '9f06204d-73c1-4d4c-880a-6edb90606fd8', '29232cdf-9323-42fd-ade2-1d097af3e4de', 'be2f45a1-457d-42af-a067-6ec1fa63bc45', '7be44c8a-adaf-4e2a-84d6-ab2649e08a13', 'e8611ab8-c189-46e8-94e1-60213ab1f814']);\r\nlet AnomalousRoleAssignment = AuditLogs\r\n    | where TimeGenerated > ago(28d)\r\n    | where OperationName == \"Add member to role\"\r\n    | mv-expand TargetResources\r\n    | extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n    | where isnotempty(RoleId) and RoleId in (critical, high)\r\n    | extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n    | where isnotempty(RoleName)\r\n    | extend TargetId = tostring(TargetResources.id)\r\n    | extend Target = tostring(TargetResources.userPrincipalName)\r\n    | join kind=inner (\r\n        BehaviorAnalytics\r\n        | where ActionType == \"Add member to role\"\r\n        | where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n        )\r\n        on $left._ItemId == $right.SourceRecordId\r\n    | extend AnomalyName = \"Anomalous Role Assignemt\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Account Manipulation\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access.  The query below generates an output of all high Blast Radius users performing Add member to priveleged role, or ones that add users for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, RoleName, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; let LogOns=materialize(\r\n    BehaviorAnalytics\r\n    | where ActivityType == \"LogOn\");\r\nlet AnomalousResourceAccess = LogOns\r\n    | where ActionType == \"ResourceAccess\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | extend AnomalyName = \"Anomalous Resource Access\",\r\n        Tactic = \"Lateral Movement\",\r\n        Technique = \"\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversary may be trying to move through the environment. APT29 and APT32, for example, has used PtH & PtT techniques to lateral move around the network. The query below generates an output of all users performing an resource access (4624:3) to devices for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousRDPActivity = LogOns\r\n    | where ActionType == \"RemoteInteractiveLogon\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | extend AnomalyName = \"Anomalous RDP Activity\",\r\n        Tactic = \"Lateral Movement\",\r\n        Technique = \"\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may use Valid Accounts to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. FIN10, for example, has used RDP to move laterally to systems in the victim environment. The query below generates an output of all users performing a remote interactive logon (4624:10) to a device for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousLogintoDevices = LogOns\r\n    | where ActionType == \"InteractiveLogon\"\r\n    | where ActivityInsights.FirstTimeUserLoggedOnToDevice == true\r\n    | where UsersInsights.DormantAccount == true or DevicesInsights.LocalAdmin == true\r\n    | extend AnomalyName = \"Anomalous Login To Devices\",\r\n        Tactic = \"Privilege Escalation\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access and privilege escalation. The query below generates an output of all administator users performing an interactive logon (4624:2) to a device for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousPasswordReset = BehaviorAnalytics\r\n    | where ActionType == \"Reset user password\"\r\n    | where ActivityInsights.FirstTimeUserPerformedAction == \"True\"\r\n    | join (\r\n        AuditLogs\r\n        | where OperationName == \"Reset user password\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | mv-expand TargetResources\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Password Reset\",\r\n        Tactic = \"Impact\",\r\n        Technique = \"Account Access Removal\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (ex: changed credentials) to remove access to accounts. LockerGoga, for example, has been observed changing account passwords and logging off current users. The query below generates an output of all users performing Reset user password for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority\r\n    | sort by TimeGenerated desc;\r\nlet AnomalousGeoLocationLogon = BehaviorAnalytics\r\n    | where ActionType == \"Sign-in\"\r\n    | where ActivityInsights.FirstTimeUserConnectedFromCountry == True and (ActivityInsights.FirstTimeConnectionFromCountryObservedInTenant == True or ActivityInsights.CountryUncommonlyConnectedFromAmongPeers == True)\r\n    | join (\r\n        SigninLogs\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Successful Logon\",\r\n        Tactic = \"Initial Access\",\r\n        Technique = \"Valid Accounts\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may steal the credentials of a specific user or service account using Credential Access techniques or capture credentials earlier in their reconnaissance process through social engineering for means of gaining Initial Access. APT33, for example, has used valid accounts for initial access. The query below generates an output of successful Sign-in performed by a user from a new geo location he has never connected from before, and none of his peers as well.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousFailedLogon = BehaviorAnalytics\r\n    | where ActivityType == \"LogOn\"\r\n    | where UsersInsights.BlastRadius == \"High\"\r\n    | join (\r\n        SigninLogs  \r\n        | where Status.errorCode == 50126\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Failed Logon\",\r\n        Tactic = \"Credential Access\",\r\n        Technique = \"Brute Force\",\r\n        SubTechnique = \"Password Guessing\",\r\n        Description = \"Adversaries with no prior knowledge of legitimate credentials within the system or environment may guess passwords to attempt access to accounts. Emotet, for example, has been observed using a hard coded list of passwords to brute force user accounts. The query below generates an output of all users with 'High' BlastRadius that perform failed Sign-in:Invalid username or password.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"Evidence\"]=ActivityInsights, ResourceDisplayName, AppDisplayName, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; \r\nlet AnomalousAADAccountManipulation = AuditLogs\r\n    | where OperationName == \"Update user\"\r\n    | mv-expand AdditionalDetails\r\n    | where AdditionalDetails.key == \"UserPrincipalName\"\r\n    | mv-expand TargetResources\r\n    | extend RoleId = tostring(TargetResources.modifiedProperties[0].newValue)\r\n    | where isnotempty(RoleId) and RoleId in (critical, high)\r\n    | extend RoleName = tostring(TargetResources.modifiedProperties[1].newValue)\r\n    | where isnotempty(RoleName)\r\n    | extend TargetId = tostring(TargetResources.id)\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | join kind=inner ( \r\n        BehaviorAnalytics\r\n        | where ActionType == \"Update user\"\r\n        | where UsersInsights.BlasrRadius == \"High\" or ActivityInsights.FirstTimeUserPerformedAction == true\r\n        )\r\n        on $left._ItemId == $right.SourceRecordId\r\n    | extend UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName) \r\n    | extend AnomalyName = \"Anomalous Account Manipulation\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Account Manipulation\",\r\n        SubTechnique = \"\",\r\n        Description = \"Adversaries may manipulate accounts to maintain access to victim systems. These actions include adding new accounts to high privilleged groups. Dragonfly 2.0, for example, added newly created accounts to the administrators group to maintain elevated access. The query below generates an output of all high Blast Radius users performing 'Update user' (name change) to priveleged role, or ones that changed users for the first time.\"\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, RoleName, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority; let AnomalousAADAccountCreation = BehaviorAnalytics\r\n    | where ActionType == \"Add user\"\r\n    | where ActivityInsights.FirstTimeUserPerformedAction == True or ActivityInsights.FirstTimeActionPerformedInTenant == True or ActivityInsights.ActionUncommonlyPerformedAmongPeers == true\r\n    | join(\r\n        AuditLogs\r\n        | where OperationName == \"Add user\"\r\n        )\r\n        on $left.SourceRecordId == $right._ItemId\r\n    | mv-expand TargetResources\r\n    | extend Target =  iff(tostring(TargetResources.userPrincipalName) contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(TargetResources.userPrincipalName, \"#\")[0])), TargetResources.userPrincipalName), tostring(TargetResources.userPrincipalName)\r\n    | extend DisplayName = tostring(UsersInsights.AccountDisplayName),\r\n        UserPrincipalName = iff(UserPrincipalName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserPrincipalName),\r\n        UserName = iff(UserName contains \"#EXT#\", replace(\"_\", \"@\", tostring(split(UserPrincipalName, \"#\")[0])), UserName)\r\n    | extend AnomalyName = \"Anomalous Account Creation\",\r\n        Tactic = \"Persistence\",\r\n        Technique = \"Create Account\",\r\n        SubTechnique = \"Cloud Account\",\r\n        Description = \"Adversaries may create a cloud account to maintain access to victim systems. With a sufficient level of access, such accounts may be used to establish secondary credentialed access that does not require persistent remote access tools to be deployed on the system. The query below generates an output of all the users performing user creation for the first time and the target users that were created.\"\t\r\n    | project TimeGenerated, AnomalyName, Tactic, Technique, SubTechnique, Description, UserName, UserPrincipalName, UsersInsights, ActivityType, ActionType, [\"TargetUser\"]=Target, [\"Evidence\"]=ActivityInsights, SourceIPAddress, SourceIPLocation, SourceDevice, DevicesInsights, [\"Anomaly Score\"]=InvestigationPriority\r\n    | sort by TimeGenerated desc;\r\nlet AnomalyTable = union kind=outer AnomalousSigninActivity, AnomalousRoleAssignment, AnomalousResourceAccess, AnomalousRDPActivity, AnomalousPasswordReset, AnomalousLogintoDevices, AnomalousGeoLocationLogon, AnomalousAADAccountManipulation, AnomalousAADAccountCreation, AnomalousFailedLogon;\r\nlet TopUsersByAnomalies = AnomalyTable\r\n    | summarize hint.strategy = shuffle AnomalyCount=count() by UserName, UserPrincipalName, tostring(UsersInsights.OnPremSid), tostring(UsersInsights.AccountObjectId)\r\n    | project Name=tolower(UserName), UPN=tolower(UserPrincipalName), AadUserId=UsersInsights_AccountObjectId, Sid=UsersInsights_OnPremSid, AnomalyCount\r\n    | sort by AnomalyCount desc;\r\nlet TopUsersByIncidents = SecurityIncident\r\n    | summarize hint.strategy = shuffle arg_max(LastModifiedTime, *) by IncidentNumber\r\n    | where Status == \"New\" or Status == \"Active\"\r\n    | mv-expand AlertIds\r\n    | extend AlertId = tostring(AlertIds)\r\n    | join kind= innerunique ( \r\n        SecurityAlert \r\n        )\r\n        on $left.AlertId == $right.SystemAlertId\r\n    | summarize hint.strategy = shuffle arg_max(TimeGenerated, *), NumberOfUpdates = count() by SystemAlertId\r\n    | mv-expand todynamic(Entities)\r\n    | where Entities[\"Type\"] =~ \"account\"\r\n    | extend Name = tostring(tolower(Entities[\"Name\"])), NTDomain = tostring(Entities[\"NTDomain\"]), UPNSuffix = tostring(Entities[\"UPNSuffix\"]), AadUserId = tostring(Entities[\"AadUserId\"]), AadTenantId = tostring(Entities[\"AadTenantId\"]), \r\n        Sid = tostring(Entities[\"Sid\"]), IsDomainJoined = tobool(Entities[\"IsDomainJoined\"]), Host = tostring(Entities[\"Host\"])\r\n    | extend UPN = iff(Name != \"\" and UPNSuffix != \"\", strcat(Name, \"@\", UPNSuffix), \"\")\r\n    | union TopUsersByAnomalies\r\n    | extend \r\n        AadPivot = iff(isempty(AadUserId), iff(isempty(Sid), Name, Sid), AadUserId),\r\n        SidPivot = iff(isempty(Sid), iff(isempty(AadUserId), Name, AadUserId), Sid),\r\n        UPNExists = iff(isempty(UPN), false, true),\r\n        NameExists = iff(isempty(Name), false, true),\r\n        SidExists = iff(isempty(Sid), false, true),\r\n        AADExists = iff(isempty(AadUserId), false, true)\r\n    | summarize hint.strategy = shuffle IncidentCount=dcount(IncidentNumber, 4), AlertCount=dcountif(AlertId, isnotempty(AlertId), 4), AnomalyCount=sum(AnomalyCount), any(Title, Severity, Status, StartTime, IncidentNumber, IncidentUrl, Owner), UPNAnchor=anyif(UPN, UPNExists == true), NameAnchor=anyif(Name, NameExists == true), AadAnchor=anyif(AadUserId, AADExists == true), SidAnchor=anyif(Sid, SidExists == true), any(SidPivot) by AadPivot\r\n    | summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount), AlertCount=sum(AlertCount), AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false), NameAnchor=anyif(NameAnchor, isempty(NameAnchor) == false), AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_Title, any_Severity, any_StartTime, any_IncidentNumber, any_IncidentUrl) by any_SidPivot\r\n    | summarize hint.strategy = shuffle IncidentCount=sum(IncidentCount), AlertCount=sum(AlertCount), AnomalyCount=sum(AnomalyCount), UPNAnchor=anyif(UPNAnchor, isempty(UPNAnchor) == false), AadAnchor=anyif(AadAnchor, isempty(AadAnchor) == false), SidAnchor=anyif(SidAnchor, isempty(SidAnchor) == false), any(any_any_Title, any_any_Severity, any_any_StartTime, any_any_IncidentNumber, any_any_IncidentUrl) by NameAnchor\r\n    | project [\"UserName\"]=NameAnchor, IncidentCount, AlertCount, AnomalyCount, [\"AadUserId\"]=AadAnchor, [\"OnPremSid\"]=SidAnchor, [\"UserPrincipalName\"]=UPNAnchor;\r\nTopUsersByIncidents\r\n| sort by AlertCount desc\r\n| where UserName <> \"\"\r\n| project UserName, AlertCount, AnomalyCount\r\n| limit 100",
              "size": 0,
              "showAnalytics": true,
              "title": "User Entity Behavior Analytics Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "UserName",
                    "formatter": 16,
                    "formatOptions": {
                      "showIcon": true
                    }
                  },
                  {
                    "columnMatch": "AlertCount",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redBright"
                    }
                  },
                  {
                    "columnMatch": "AnomalyCount",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "yellow"
                    }
                  }
                ],
                "sortBy": [
                  {
                    "itemKey": "$gen_heatmap_AlertCount_1",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "$gen_heatmap_AlertCount_1",
                  "sortOrder": 2
                }
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where ProviderName == \"Sentinel Fusion\" or AlertName contains \"Fusion\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AlertName\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Machine Learning: Fusion Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where ProviderName == \"Azure Security Center\"\r\n| where AlertName contains \"suspicious\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AlertName\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Security Center: Heuristics Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Dynamic Threat Discovery",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Policy Enforcement Parity\r\n\r\n### TIC 3.0 Guidance\r\nConsistently applying security protections and other policies, independent of the communication mechanism, forwarding path, or endpoints used.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Policy for Consisent Security Protections and Policy\r\n\t‚Ä¢ Use Azure Blueprints for Repeatable Policy Framework Alignment with Compliance Frameworks\r\n\t‚Ä¢ Implement Azure Active Directory Policy Restrictions\r\n\r\n### Navigate \r\n\t‚Ä¢ Policy > Assignments\r\n\t‚Ä¢ Blueprints > Blueprint Definitions > Create\r\n\t‚Ä¢ Azure Active Directory > Users > Password Reset > Administrator Policy\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Policy](https://portal.azure.com/#blade/Microsoft_Azure_Policy/PolicyMenuBlade/Overview) \r\nüîÑ [Blueprints](https://portal.azure.com/#blade/Microsoft_Azure_Policy/BlueprintsMenuBlade/GetStarted)\r\nüîÑ [Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[What is Azure Policy?](https://docs.microsoft.com/azure/governance/policy/overview)\r\nüí°¬†[What is Azure Blueprints?](https://docs.microsoft.com/azure/governance/blueprints/)\r\nüí°¬†[Password Policies and Account Restrictions in Azure Active Directory](https://docs.microsoft.com/azure/active-directory/authentication/concept-sspr-policy)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.DS\r\n\t‚Ä¢ PR.IP\r\n\t‚Ä¢ PR.MA"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Create & Manage Azure Policies\r\n![Image¬†Name](https://docs.microsoft.com/azure/governance/policy/media/create-and-manage/select-assignments.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Policy](https://azure.microsoft.com/services/azure-policy/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Create Azure Blueprints\r\n![Image¬†Name](https://docs.microsoft.com/learn/azure-fundamentals/build-cloud-governance-strategy-azure/media/10-iso-27001-shared-blueprint.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Blueprints]( https://azure.microsoft.com/services/blueprints/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Configure Azure Active Directory Policy\r\n![Image¬†Name](https://docs.microsoft.com/azure/active-directory/authentication/media/howto-sspr-authenticationdata/user-authentication-contact-info.png)\r\n\r\n‚ú≥Ô∏è [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/trial/get-started-active-directory/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Policy Enforcement Parity",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Effective Use of Shared Services\r\n\r\n### TIC 3.0 Guidance\r\nEmploying shared services, where applicable, that can be individually tailored, measured to independently validate service conformance, and offer effective protections for tenants against malicious actors, both external as well as internal to the service provider.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Gain Full Transparency into Service Provider Actions and Manage Access with Azure Lighthouse\r\n\t‚Ä¢ Leverage Azure Customer Lockbox to Review, Approve or Reject Shared Data Access Requests\r\n\t‚Ä¢ Allow People Outside Your Organization to Access Your Services with Azure Active Directory: External Identities\r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Lighthouse\r\n\t‚Ä¢ Customer Lockbox for Microsoft Azure\r\n\t‚Ä¢ Azure Active Directory > External Identities\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Lighthouse](https://portal.azure.com/#blade/Microsoft_Azure_CustomerHub/LighthouseBlade) \r\nüîÑ [Customer Lockbox for Microsoft Azure](https://portal.azure.com/#blade/Microsoft_Azure_Lockbox/LockboxMenu/Overview) \r\nüîÑ [Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Get Started with Azure Lighthouse](https://azure.microsoft.com/services/azure-lighthouse/)\r\nüí°¬†[Customer Lockbox for Microsoft Azure](https://docs.microsoft.com/azure/security/fundamentals/customer-lockbox-overview)\r\nüí°¬†[What are External Identities in Azure Active Directory?](https://docs.microsoft.com/azure/active-directory/external-identities/compare-with-b2c)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.AM\r\n\t‚Ä¢ ID.GV\r\n\t‚Ä¢ ID.RM\r\n\t‚Ä¢ ID.SC\r\n\t‚Ä¢ PR.AT\r\n\t‚Ä¢ RS.CO"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Lighthouse for Service Provider Access\r\n![Image¬†Name](https://docs.microsoft.com/azure/lighthouse/media/azure-lighthouse-overview.jpg)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Lighthouse]( https://azure.microsoft.com/services/azure-lighthouse/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Use Azure Customer Lockbox for Shared Access to Resources\r\n![Image¬†Name](https://docs.microsoft.com/azure/security/fundamentals/media/customer-lockbox-overview/customer-lockbox-landing-page.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Customer Lockbox](https://aka.ms/customerlockbox/insiderprogram)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Configure Azure Active Directory: External Identities for External Organization Users\r\n![Image¬†Name](https://docs.microsoft.com/azure/active-directory/external-identities/media/what-is-b2b/identity-providers.png)\r\n\r\n‚ú≥Ô∏è [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/trial/get-started-active-directory/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Effective Use of Shared Services",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Integrated Desktop, Mobile, and Remote Policies\r\n\r\n### TIC 3.0 Guidance\r\nDefining polices such that they apply to a given agency entity no matter its location.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Active Directory Conditional Access Policies for Authentication Conditions¬†\r\n\t‚Ä¢ Control Connection of Mobile Endpoints with Microsoft Intune: Conditional Access\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SigninLogs (Azure Active Directory) ‚ú≥Ô∏è [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/trial/get-started-active-directory/) \r\n\r\n### Navigate \r\n    ‚Ä¢ Azure¬†Active¬†Directory¬†>¬†Conditional¬†Access¬†-¬†Policies\r\n\t‚Ä¢ Microsoft Endpoint Manager Admin Center > Endpoints > Conditional Access > New Policy\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)\r\nüîÑ [Microsoft Endpoint Manager Admin Center](https://devicemanagement.microsoft.com/) \r\nüîÑ [Microsoft Intune Portal](https://endpoint.microsoft.com/#blade/Microsoft_Intune_DeviceSettings/DevicesMenu/overview) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[What is Conditional Access?](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)\r\nüí°¬†[What are Common Ways to Use Conditional Access with Intune?](https://docs.microsoft.com/mem/intune/protect/conditional-access-intune-common-ways-use)¬†\r\n\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.AM\r\n\t‚Ä¢ PR.AC\r\n\t‚Ä¢ PR.DS\r\n\t‚Ä¢ PR.IP\r\n\t‚Ä¢ PR.MA"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SigninLogs",
              "size": 0,
              "showAnalytics": true,
              "title": "Sign-Ins By Location",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "map",
              "mapSettings": {
                "locInfo": "CountryRegion",
                "locInfoColumn": "Location",
                "sizeSettings": "Location",
                "sizeAggregation": "Count",
                "labelSettings": "Location",
                "legendMetric": "Location",
                "legendAggregation": "Count",
                "itemColorSettings": {
                  "nodeColorField": "Location",
                  "colorAggregation": "Count",
                  "type": "heatmap",
                  "heatmapPalette": "greenRed"
                }
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "###¬†Control Connection of Mobile Endpoints with Microsoft Intune: Conditional Access\r\n![Image¬†Name](https://docs.microsoft.com/mem/intune/protect/media/conditional-access/ca-diagram-1.png¬†¬†\"Intune Conditional Access\")¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Microsoft Endpoint Manager](https://www.microsoft.com/microsoft-365/microsoft-endpoint-Manager)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUniversalSecurityCapabilitiesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUniversalSecurityCapabilitiesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Integrated Desktop, Mobile, and Remote Policies",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##¬†Files\r\nFile-based protections including anti-malware, malicious code removal, content disarm & reconstruction, and detonation chambers.\r\n\r\n|¬†<em> TIC 3.0 vs Zero Trust </em> |\r\n|¬†:¬†|¬†: | : | : |\r\n|¬†<strong> Capabilities¬†</strong> | <strong> Microsoft Controls¬†</strong> |¬†<strong> Zero Trust Principles </strong>  | <strong> Zero Trust Pillars </strong>  |\r\n|¬†Anti-Malware¬†|¬†‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)  ‚ú≥Ô∏è [Azure Defender]( https://azure.microsoft.com/services/azure-defender/) ‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)  ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender) ‚ú≥Ô∏è [Microsoft Defender for Identity]( https://www.microsoft.com/microsoft-365/security/identity-defender) ‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)  | Assume Breach, Visibility & Analytics | Endpoints, Apps, Infrastructure, Network |\r\n|¬†Content Disarm & Reconstruction¬†|¬†‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender) ‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)  | Assume Breach, Visibility & Analytics | Data, Apps |\r\n|¬†Detonation Chamber |¬†‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)  | Assume Breach, Visibility & Analytics | Endpoints, Apps, Infrastructure, Network |\r\n|¬†Data Loss Prevention |¬†‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)  ‚ú≥Ô∏è [Microsoft 365 Defender]( https://www.microsoft.com/microsoft-365/security/microsoft-365-defender) ‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) | Verify Explicitly, Use Least Privileged Access, Assume Breach  | Data |\r\nFor more information, see the CISA: Trusted Internet Connections üí°[Core Guidance Documents](https://www.cisa.gov/trusted-internet-connections) and Microsoft's üí°[Why Zero Trust](https://www.microsoft.com/security/business/zero-trust)\r\n\r\n",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "isFilesVisible",
          "comparison": "isEqualTo",
          "value": "true"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Files Capabilities Overview",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "c61c3951-546a-40ae-a680-74638b772d80",
            "cellValue": "Anti-Malware",
            "linkTarget": "step",
            "linkLabel": "Anti-Malware",
            "style": "link"
          },
          {
            "id": "6a592926-301d-44d9-8915-359e443fbc61",
            "cellValue": "Content Disarm & Reconstruction",
            "linkTarget": "step",
            "linkLabel": "Content Disarm & Reconstruction",
            "style": "link"
          },
          {
            "id": "ec6b5ffc-7d3d-4a93-b1cf-e20af0b57f3e",
            "cellValue": "Detonation Chamber",
            "linkTarget": "step",
            "linkLabel": "Detonation Chamber",
            "style": "link"
          },
          {
            "id": "33cb9a0b-8e24-410a-afd4-81d9e201e7a3",
            "cellValue": "Data Loss Prevention_F",
            "linkTarget": "step",
            "linkLabel": "Data Loss Prevention",
            "style": "link"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isFilesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Files Capabilities Navigation"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Anti-Malware\r\n\r\n### TIC 3.0 Guidance\r\nAnti-malware protections detect the presence of malicious code and facilitate its quarantine or removal.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Defender, Microsoft Defender for Endpoint, Microsoft Defender for Office 365, and Microsoft Anti-Malware for Malware Defense\r\n\t‚Ä¢ View Aggregated Security Alerts in Azure Sentinel: Security Alerts Workbook\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityAlert (Azure Sentinel) ‚ú≥Ô∏è [Get Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)\r\nüî∑ SecurityAlert (Azure Defender) ‚ú≥Ô∏è [Get Started with Azure Defender](https://azure.microsoft.com/services/azure-defender/)\r\nüî∑ SecurityAlert (Microsoft Defender for Endpoint) ‚ú≥Ô∏è [Get Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)\r\nüî∑ SecurityAlert (Microsoft Defender for Office 365) ‚ú≥Ô∏è [Get Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)\r\nüî∑ SecurityAlert (Microsoft Defender for Identity) ‚ú≥Ô∏è [Get Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender) \r\nüî∑ SecurityAlert (Microsoft Cloud App Security) ‚ú≥Ô∏è [Get Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)\r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Sentinel > Workbooks > Security Alerts\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) \r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) \r\nüîÑ [Microsoft Defender for Identity Portal](https://portal.atp.azure.com/) \r\nüîÑ [Microsoft 365 Security Center](https://security.microsoft.com/) \r\nüîÑ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/) \r\nüîÑ [Office 365 Security & Compliance Center](https://protection.office.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Microsoft Antimalware Extension for Windows](https://docs.microsoft.com/azure/virtual-machines/extensions/iaas-antimalware-windows)\r\nüí°¬†[Microsoft Antimalware for Azure Cloud Services and Virtual Machines](https://docs.microsoft.com/azure/security/fundamentals/antimalware)\r\nüí°¬†[Microsoft Cloud App Security: Malware Detection](https://docs.microsoft.com/cloud-app-security/anomaly-detection-policy#malware-detection)\r\nüí°¬†[Microsoft Defender for Endpoint](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/microsoft-defender-advanced-threat-protection)\r\n\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.DS\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ DE.CM\r\n\t‚Ä¢ DE.DP\r\n\t‚Ä¢ RS.MI"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isFilesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where AlertName contains \"malware\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AlertName\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Malware Alerting",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isFilesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where AlertName contains \"malware\"\r\n| summarize count() by ProviderName\r\n| render piechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Malware Detected by Provider",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isFilesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Azure Antimalware Service\r\n![Image¬†Name](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/Antimalware_thumb.jpg)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Defender](https://azure.microsoft.com/services/azure-defender/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isFilesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isFilesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Anti-Malware",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Content Disarm & Reconstruction\r\n\r\n### TIC 3.0 Guidance\r\nContent disarm and reconstruction technology detects the presence of unapproved active content and facilitates its removal.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Microsoft Defender for Office 365 and Microsoft Defender for Endpoint for Active Content Mitigations \r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityAlert (Microsoft Defender for Endpoint) ‚ú≥Ô∏è [Get Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)\r\nüî∑ SecurityAlert (Microsoft Defender for Office 365) ‚ú≥Ô∏è [Get Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)\r\n\r\n### Navigate \r\n\t‚Ä¢ Office 365 Security & Compliance Center > Threat management > Policy > ATP Safe Attachments\r\n\t‚Ä¢ Microsoft 365 Security Center > Threat & Vulnerability Management\r\n### Microsoft Security Portals & Admin Centers\r\nüîÑ [Microsoft 365 Security Center](https://security.microsoft.com/) \r\nüîÑ [Office 365 Security & Compliance Center](https://protection.office.com/) \r\n\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Setup Safe Attachments Policies in Microsoft Defender for Office 365](https://docs.microsoft.com/microsoft-365/security/office-365-security/set-up-atp-safe-attachments-policies)\r\nüí°¬†[Threat and Vulnerability Management](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/next-gen-threat-and-vuln-mgt)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ DE.CM\r\n\t‚Ä¢ DE.DP"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isFilesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft Defender for Office 365: Safe Attachments\r\n![Image¬†Name](https://docs.microsoft.com/microsoft-365/media/safe-docs.png)\r\n\r\n‚ú≥Ô∏è [Get Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isFilesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where ProviderName == \"OATP\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AlertName\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Microsoft Defender for Office 365 Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isFilesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where ProviderName == \"MDATP\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AlertName\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Microsoft Defender for Endpoint Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isFilesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isFilesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Content Disarm & Reconstruction",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Detonation Chamber\r\n\r\n### TIC 3.0 Guidance\r\nDetonation chambers facilitate the detection of malicious code through the use of protected and isolated execution environments to analyze the files.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Microsoft Defender for Endpoint, Azure Sentinel, and Microsoft Defender for Office 365 for File, Attachment, & URL Detonations\r\n\r\n### Navigate \r\n\t‚Ä¢ Microsoft 365 Security Center > Alerts > Select File > Deep Analysis > Submit > Review Detonation Results\r\n\t‚Ä¢ Azure Sentinel > Incident > Investigate > Review Detonated URLs\r\n\t‚Ä¢ Office 365 Security & Compliance Center > Threat Management > Policy > Safe Attachments / ATP Safe Links\r\n\r\n### Microsoft Security Portals & Admin Centers\r\nüîÑ [Azure Portal](https://portal.azure.com/)\r\nüîÑ [Microsoft 365 Security Center](https://security.microsoft.com/) \r\nüîÑ [Office 365 Security & Compliance Center](https://protection.office.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Submit File for Deep Analysis](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/respond-file-alerts#submit-files-for-deep-analysis)\r\nüí°¬†[Using the Built-in URL Detonation in Azure Sentinel](https://techcommunity.microsoft.com/t5/azure-sentinel/using-the-new-built-in-url-detonation-in-azure-sentinel/ba-p/996229)\r\nüí°¬†[Safe Links in Microsoft Defender for Office 365](https://docs.microsoft.com/microsoft-365/security/office-365-security/atp-safe-links)\r\nüí°¬†[Safe Attachments in Microsoft Defender for Office 365](https://docs.microsoft.com/microsoft-365/security/office-365-security/atp-safe-attachments)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ DE.CM\r\n\t‚Ä¢ DE.DP\r\n\t‚Ä¢ RS.AN\r\n\t‚Ä¢ RS.MI"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isFilesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft Defender for Endpoint: Deep Analysis for Detonation Chamber Analysis\r\n![Image¬†Name](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/images/submit-file.png)\r\n\r\n‚ú≥Ô∏è [Get Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isFilesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Sentinel for URL Detonation\r\n![Image¬†Name](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/155925iA519044A8D44C53D/image-size/large)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Sentinel]( https://azure.microsoft.com/services/azure-sentinel/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isFilesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft Defender for Office 365: Safe Links & Safe Attachments for URL & Attachment Detonations\r\n![Image¬†Name](https://docs.microsoft.com/microsoft-365/media/ee8dd5ed-6b91-4248-b054-12b719e8d0ed.png)\r\n\r\n‚ú≥Ô∏è [Get Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isFilesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isFilesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Detonation Chamber",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Data Loss Prevention\r\n\r\n### TIC 3.0 Guidance\r\nData loss prevention technologies detect instances of the exfiltration, either malicious or accidental, of agency data.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Information Protection to Label/Protect Sensitive Data\r\n\t‚Ä¢ Track Data Exfiltration Alerts with Azure Sentinel: Hunting\r\n\t‚Ä¢ Leverage Microsoft 365 Defender for Endpoint Data Loss Prevention (DLP)\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ InformationProtectionLogs_CL (Azure Information Protection) ‚ú≥Ô∏è [Get Started with AIP](https://azure.microsoft.com/services/information-protection)\r\nüî∑ SecurityAlert (Azure Sentinel) ‚ú≥Ô∏è [Get Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)\r\nüî∑ SecurityAlert (Microsoft Defender for Endpoint) ‚ú≥Ô∏è [Get Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)\r\nüî∑ SecurityAlert (Microsoft Defender for Office 365) ‚ú≥Ô∏è [Get Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)\r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Information Protection > Classifications > Labels\r\n\t‚Ä¢ Azure Sentinel > Hunting > Tactics > Exfiltration\r\n\t‚Ä¢ Microsoft 365 Security & Compliance Center > Data Loss Prevention\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade) \r\nüîÑ [Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) \r\nüîÑ [Office 365 Security & Compliance Center](https://protection.office.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[How to Configure a Label for Rights Management Protection](https://docs.microsoft.com/azure/information-protection/configure-policy-protection)\r\nüí°¬†[Hunt for Threats with Azure Sentinel](https://docs.microsoft.com/azure/sentinel/hunting)\r\nüí°¬†[Learn about Microsoft 365 Endpoint Data Loss Prevention](https://docs.microsoft.com/microsoft-365/compliance/endpoint-dlp-learn-about)\r\nüí°¬†[Configure and View Alerts for DLP Polices](https://docs.microsoft.com/microsoft-365/compliance/dlp-configure-view-alerts-policies)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.DS"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isFilesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where Tactics == \"Exfiltration\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AlertName\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Data Exfiltration Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isFilesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft 365 Defender for Endpoint: Data Loss Prevention\r\n![Image¬†Name](https://docs.microsoft.com/microsoft-365/media/endpoint-dlp-learn-about-4-activity-explorer.png)\r\n\r\n‚ú≥Ô∏è [Get Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isFilesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "InformationProtectionLogs_CL\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by Activity_s, Operation_s, LabelName_s, ApplicationName_s\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Information Protection Activity",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isFilesVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isFilesVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Data Loss Prevention_F",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##¬†Email\r\nEmail-based protections including anti-phishing, anti-spam, authenticated received chain, data loss prevention, DMARC for incoming/outgoing mail, email encryption, and malicious URL protections.\r\n\r\n|¬†<em> TIC 3.0 vs Zero Trust </em> |\r\n|¬†:¬†|¬†: | : | : |\r\n|¬†<strong> Capabilities¬†</strong> | <strong> Microsoft Controls¬†</strong> |¬†<strong> Zero Trust Principles </strong>  | <strong> Zero Trust Pillars </strong>  |\r\n|¬†Anti-Phishing Protections¬†|¬†‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)  | Assume Breach | Identity, Endpoints, Data | \r\n|¬†Anti-SPAM Protections¬†| ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)  | Assume Breach | Identity, Endpoints, Data | \r\n|¬†Authenticated Received Chain |¬†‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)  | Verify Explicitly | Identities, Data |\r\n|¬†Data Loss Prevention |¬†‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)  ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)  | Assume Breach | Data |\r\n|¬†DMARC for Incoming Email |¬†‚ú≥Ô∏è [Microsoft 365 Enterprise]( https://www.microsoft.com/microsoft-365/enterprise)  | Verify Explicitly | Identities, Data |\r\n|¬†DMARC for Outgoing Email |¬†‚ú≥Ô∏è [Microsoft 365 Enterprise]( https://www.microsoft.com/microsoft-365/enterprise)  | Verify Explicitly | Identities, Data |\r\n|¬†Encryption for Email Transmission |¬†‚ú≥Ô∏è [Microsoft 365 Enterprise]( https://www.microsoft.com/microsoft-365/enterprise) ‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)  | Verify Explicitly, Use Least Privileged Access, Assume Breach | Data |\r\n| Malicious URL Protections | ‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)  | Assume Breach | Network |\r\n|¬†URL Click-Through Protection |¬†‚ú≥Ô∏è [Microsoft Defender for Office 365]( https://www.microsoft.com/microsoft-365/security/office-365-defender)  | Assume Breach | Network |\r\nFor more information, see the CISA: Trusted Internet Connections üí°[Core Guidance Documents](https://www.cisa.gov/trusted-internet-connections) and Microsoft's üí°[Why Zero Trust](https://www.microsoft.com/security/business/zero-trust)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "isEmailVisible",
          "comparison": "isEqualTo",
          "value": "true"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Email Capabilities Help",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##¬†TIC 3.0 Capabilities¬†(Not Included¬†in¬†Workbook)\r\n|¬†<em> Email PEP Security Capabilities </em>¬†|\r\n|¬†:¬†|¬†: | \r\n|¬†<strong> Capability </strong>¬†| <strong> Requirement¬†</strong> |¬†\r\n|¬†NCPS E3A Protections |¬†NCPS E3A is an intrusion prevention capability, provided by DHS, that includes an email filtering security service. |\r\nFor more information, see the CISA: Trusted Internet Connections üí°[Core Guidance Documents](https://www.cisa.gov/trusted-internet-connections)",
        "style": "error"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "isEmailVisible",
          "comparison": "isEqualTo",
          "value": "true"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "TIC 3.0 Capabilities¬†(Not Included¬†in¬†Workbook)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "75486fb8-e143-457b-881a-b1acaee05453",
            "cellValue": "Anti-Phishing Protections",
            "linkTarget": "step",
            "linkLabel": "Anti-Phishing Protections",
            "style": "link"
          },
          {
            "id": "a4879110-271e-496c-ae2f-7e30296af266",
            "cellValue": "Anti-SPAM Protections",
            "linkTarget": "step",
            "linkLabel": "Anti-SPAM Protections",
            "style": "link"
          },
          {
            "id": "bbc29b77-2e9a-4438-970f-e0abfdc8a3cc",
            "cellValue": "Authenticated Received Chain",
            "linkTarget": "step",
            "linkLabel": "Authenticated Received Chain",
            "style": "link"
          },
          {
            "id": "43972d55-2e0c-4660-ac09-91459af1713e",
            "cellValue": "Data Loss Prevention_E",
            "linkTarget": "step",
            "linkLabel": "Data Loss Prevention",
            "style": "link"
          },
          {
            "id": "d7f5b5ba-5ccc-4043-b403-f046b15a853e",
            "cellValue": "DMARC for Incoming Email",
            "linkTarget": "step",
            "linkLabel": "DMARC for Incoming Email",
            "style": "link"
          },
          {
            "id": "42784042-f170-4520-bf7f-8f765ca54584",
            "cellValue": "DMARC for Outgoing Email",
            "linkTarget": "step",
            "linkLabel": "DMARC for Outgoing Email",
            "style": "link"
          },
          {
            "id": "50c50837-7378-419f-b5ab-60a4f50a8e3c",
            "cellValue": "Encryption for Email Transmission",
            "linkTarget": "step",
            "linkLabel": "Encryption for Email Transmission",
            "style": "link"
          },
          {
            "id": "8ea80e97-f1f8-4f1f-9be1-85f5b2974254",
            "cellValue": "Malicious URL Protections",
            "linkTarget": "step",
            "linkLabel": "Malicious URL Protections",
            "style": "link"
          },
          {
            "id": "1247fbc5-40c8-4326-8e9d-dc7dc6387e65",
            "cellValue": "URL Click-Through Protection",
            "linkTarget": "step",
            "linkLabel": "URL Click-Through Protection",
            "style": "link"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEmailVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Email Capabilities"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Anti-Phishing Protections\r\n\r\n### TIC 3.0 Guidance\r\nAnti-phishing protections detect instances of phishing and prevent users from accessing them.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Microsoft Defender for Office 365 for Phishing Defense\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityAlert (Microsoft Defender for Office 365) ‚ú≥Ô∏è [Get Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)\r\n\r\n### Navigate \r\n\t‚Ä¢ Office 365 Security & Compliance Portal > Threat Management > Policy > ATP Anti-Phishing\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Office 365 Security & Compliance Center](https://protection.office.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Anti-Phishing Protection in Microsoft 365](https://docs.microsoft.com/microsoft-365/security/office-365-security/anti-phishing-protection)\r\nüí°¬†[Configure Anti-Phishing Policies in Microsoft Defender for Office 365](https://docs.microsoft.com/microsoft-365/security/office-365-security/configure-atp-anti-phishing-policies)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.AT\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ DE.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where AlertName contains \"phish\" or AlertName contains \"email\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AlertName\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Phishing Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Microsoft Defender for Office 365: Anti-Phishing\r\n![Image¬†Name](https://docs.microsoft.com/microsoft-365/media/phish_confidence_level.png)\r\n\r\n‚ú≥Ô∏è [Get Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEmailVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Anti-Phishing Protections",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Anti-SPAM Protections\r\n\r\n### TIC 3.0 Guidance\r\nAnti-SPAM protections detect and quarantine instances of SPAM.\r\n\r\n### Microsoft Recommendation \r\n\t‚Ä¢ Leverage Microsoft Defender for Office 365 for Spam Defense\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityAlert (Microsoft Defender for Office 365) ‚ú≥Ô∏è [Get Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)\r\n\r\n### Navigate \r\n\t‚Ä¢ Office 365 Security & Compliance Portal > Threat Management > Policy > Anti-Spam\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Office 365 Security & Compliance Center](https://protection.office.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Anti-Spam protection in Exchange Online Protection](https://docs.microsoft.com/microsoft-365/security/office-365-security/anti-spam-protection)\r\nüí°¬†[Configure Anti-Spam Policies in Exchange Online Protection](https://docs.microsoft.com/microsoft-365/security/office-365-security/configure-your-spam-filter-policies)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ DE.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Microsoft Defender for Office 365: Anti-Spam\r\n![Image¬†Name](https://docs.microsoft.com/microsoft-365/media/tp_emailprocessingineopt3.png)\r\n\r\n‚ú≥Ô∏è [Get Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEmailVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Anti-SPAM Protections",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Authenticated Received Chain\r\n\r\n### TIC 3.0 Guidance\r\nAuthenticated Received Chain allows for an intermediary, like a mailing list or forwarding service, to sign its own authentication of the original email, allowing downstream entities to accept the intermediary‚Äôs authentication even if the email was changed.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Microsoft Defender for Office 365 and Microsoft 365 Admin Center for Authenticated Received Chain Configurations\r\n\r\n### Navigate \r\n\t‚Ä¢ Office 365 Security & Compliance Center\r\n\t‚Ä¢ Microsoft 365 Admin Center\t\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Office 365 Security & Compliance Center](https://protection.office.com/) \r\nüîÑ [Microsoft 365 Admin Center](https://admin.microsoft.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[How Microsoft 365 Utilizes Authenticated Received Chain (ARC)](https://docs.microsoft.com/microsoft-365/security/office-365-security/use-dmarc-to-validate-email#how-microsoft-365-utilizes-authenticated-received-chain-arc)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.AC"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### How Microsoft 365 utilizes Authenticated Received Chain (ARC)\r\nAll hosted mailboxes in Microsoft 365 gain the benefit of ARC with improved deliverability of messages and enhanced anti-spoofing protection. ARC preserves the email authentication results from all participating intermediaries, or hops, when an email is routed from the originating server to the recipient mailbox. Before ARC, modifications performed by intermediaries in email routing, like forwarding rules or automatic signatures, could cause DMARC failures by the time the email reached the recipient mailbox. With ARC, the cryptographic preservation of the authentication results allows Microsoft 365 to verify the authenticity of an email's sender.\r\n\r\nFor more information, see üí°¬†[How Microsoft 365 Utilizes Authenticated Received Chain (ARC)](https://docs.microsoft.com/microsoft-365/security/office-365-security/use-dmarc-to-validate-email#how-microsoft-365-utilizes-authenticated-received-chain-arc)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEmailVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Authenticated Received Chain",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Data Loss Prevention\r\n\r\n### TIC 3.0 Guidance\r\nData loss prevention technologies detect instances of the exfiltration, either malicious or accidental, of agency data.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Information Protection to Label/Protect Sensitive Emails\r\n\t‚Ä¢ Leverage Microsoft 365 Defender for Email Data Loss Prevention (DLP)\r\n\t‚Ä¢ Leverage Microsoft 365 Defender for Email Entity Investigation\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ InformationProtectionLogs_CL (Azure Information Protection) ‚ú≥Ô∏è [Get Started with AIP](https://azure.microsoft.com/services/information-protection)\r\nüî∑ SecurityAlert (Microsoft Defender for Office 365) ‚ú≥Ô∏è [Get Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)\r\nüî∑ OfficeActivity (Microsoft Defender for Office 365) ‚ú≥Ô∏è [Get Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)\r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Information Protection > Classifications > Labels\r\n\t‚Ä¢ Office 365 Security & Compliance Portal > Data Loss Prevention\r\n\t‚Ä¢ Office 365 Security & Compliance Portal > Threat Management > Explorer\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade) \r\nüîÑ [Office 365 Security & Compliance Center](https://protection.office.com/) \r\n\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[How to Configure a Label for Rights Management Protection](https://docs.microsoft.com/azure/information-protection/configure-policy-protection)\r\nüí°¬†[Configure and View Alerts for DLP Polices](https://docs.microsoft.com/microsoft-365/compliance/dlp-configure-view-alerts-policies)\r\nüí°¬†[How DLP Works Between the Security & Compliance Center and Exchange Admin Centers](https://docs.microsoft.com/microsoft-365/compliance/how-dlp-works-between-admin-centers)\r\nüí°¬†[Email Entity Page](https://docs.microsoft.com/microsoft-365/security/office-365-security/mdo-email-entity-page)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.DS"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Azure Information Protection: Email Classifications & Labeling\r\n![Image¬†Name](https://docs.microsoft.com/azure/information-protection/media/recipients-only-label2.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Information Protection](https://azure.microsoft.com/services/information-protection/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "InformationProtectionLogs_CL\r\n| where ApplicationName_s contains \"outlook\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†LabelName_s\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Information Protection: Email DLP Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Microsoft Defender for Office 365 & Exchange Admin Center for Email DLP\r\n![Image¬†Name](https://docs.microsoft.com/microsoft-365/media/d3eaa7e7-3b16-457b-bd9c-26707f7b584f.png)\r\n\r\n‚ú≥Ô∏è [Get Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft 365 Defender for Email Entity Investigation\r\n![Image¬†Name](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/273215iF6840526C5DB856A/image-size/large?v=v2&px=999)\r\n\r\n‚ú≥Ô∏è [Get Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "OfficeActivity\r\n| where OfficeWorkload == \"Exchange\"\r\n| where UserType <> \"Regular\"\r\n| summarize count() by UserId\r\n| render piechart",
              "size": 0,
              "showAnalytics": true,
              "title": "Non-Regular User Exchange Activity by Account",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 5",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEmailVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Data Loss Prevention_E",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ DMARC for Incoming Email\r\n\r\n### TIC 3.0 Guidance\r\nDMARC protections authenticate incoming email according to the DMARC email authentication protocol defined in RFC 7489.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Microsoft Defender for Office 365 for Incoming DMARC Validations\r\n\r\n### Navigate \r\n\t‚Ä¢ Microsoft 365 Admin Center > Admin Centers > Exchange > Mail Flow > Rules\r\n\t‚Ä¢ Office 365 Security & Compliance > Settings\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Microsoft 365 Admin Center](https://admin.microsoft.com/) üîÑ [Office 365 Security & Compliance Center](https://protection.office.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Use DMARC to Validate Email](https://docs.microsoft.com/microsoft-365/security/office-365-security/use-dmarc-to-validate-email)\r\nüí°¬†[How Microsoft 365 Handles Inbound Emails that Fail DMARC](https://docs.microsoft.com/microsoft-365/security/office-365-security/use-dmarc-to-validate-email#how-microsoft-365-handles-inbound-email-that-fails-dmarc)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ PR.IP"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Incoming DMARC Implementation\r\nDomain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and Domain Keys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. Implementing DMARC with SPF and DKIM provides additional protection against spoofing and phishing email. DMARC helps receiving mail systems determine what to do with messages sent from your domain that fail SPF or DKIM checks.\r\n\r\nYou don't have to do a thing to set up DMARC for mail that you receive in Microsoft 365. We've taken care of everything for you. If you want to learn what happens to mail that fails to pass our DMARC checks. For more information, see üí°¬†[How Microsoft 365 Handles Inbound Emails that Fail DMARC](https://docs.microsoft.com/microsoft-365/security/office-365-security/use-dmarc-to-validate-email#how-microsoft-365-handles-inbound-email-that-fails-dmarc)\r\n\r\n![Image¬†Name](https://docs.microsoft.com/microsoft-365/media/tp_dmarctroublehoot.png)\r\n\r\n‚ú≥Ô∏è [Get Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEmailVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "DMARC for Incoming Email",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ DMARC for Outgoing Email\r\n\r\n### TIC 3.0 Guidance\r\nDMARC protections facilitate the authentication of outgoing email by signing the emails and ensuring that external parties may validate the email signatures. The DMARC email authentication protocol is defined in RFC7489.\r\n\r\n## Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Microsoft Defender for Office 365 for Outgoing DMARC Validations\r\n\r\n### Navigate \r\n\t‚Ä¢ Microsoft 365 Admin Center > Admin Centers > Exchange > Mail Flow > Rules\r\n\t‚Ä¢ Office 365 Security & Compliance > Settings\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Microsoft 365 Admin Center](https://admin.microsoft.com/) üîÑ [Office 365 Security & Compliance Center](https://protection.office.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Use DMARC to Validate Email](https://docs.microsoft.com/microsoft-365/security/office-365-security/use-dmarc-to-validate-email)\r\nüí°¬†[Implement DMARC for Outbound Mail from Microsoft 365](https://docs.microsoft.com/microsoft-365/security/office-365-security/use-dmarc-to-validate-email#implement-dmarc-for-outbound-mail-from-microsoft-365)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ PR.IP"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Outgoing DMARC Implementation\r\nDomain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and Domain Keys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. Implementing DMARC with SPF and DKIM provides additional protection against spoofing and phishing email. DMARC helps receiving mail systems determine what to do with messages sent from your domain that fail SPF or DKIM checks.\r\n\t\t\r\nIf you use Microsoft 365 but you aren't using a custom domain, that is, you use onmicrosoft.com, you don't need to do anything else to configure or implement DMARC for your organization. SPF is already set up for you and Microsoft 365 automatically generates a DKIM signature for your outgoing mail. For more information, see üí°¬†[Implement DMARC for Outbound Mail from Microsoft 365](https://docs.microsoft.com/microsoft-365/security/office-365-security/use-dmarc-to-validate-email#implement-dmarc-for-outbound-mail-from-microsoft-365)\r\n\t\t\r\n![Image¬†Name](https://docs.microsoft.com/microsoft-365/media/tp_dmarctroublehoot.png)\r\n\r\n‚ú≥Ô∏è [Get Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEmailVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "DMARC for Outgoing Email",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Encryption for Email Transmission\r\n\r\n### TIC 3.0 Guidance\r\nEmail services are configured to use encrypted connections, when possible, for communications between clients and other email servers.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Microsoft 365 for Email Encryption\r\n\r\n### Navigate \r\n\t‚Ä¢ Microsoft 365 Admin Center > Admin Centers > Exchange > Mail Flow > Rules\r\n\t‚Ä¢ Office 365 Security & Compliance > Settings\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Microsoft 365 Admin Center](https://admin.microsoft.com/) üîÑ [Office 365 Security & Compliance Center](https://protection.office.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Email Encryption](https://docs.microsoft.com/microsoft-365/compliance/ome)\r\nüí°¬†[How Exchange Online Uses TLS to Secure Email Connections](https://docs.microsoft.com/microsoft-365/compliance/exchange-online-uses-tls-to-secure-email-connections)\r\nüí°¬†[Define Mail Flow Rules to Encrypt Email Messages](https://docs.microsoft.com/microsoft-365/compliance/define-mail-flow-rules-to-encrypt-email)\r\nüí°¬†[Setup New Message Encryption Capabilities](https://docs.microsoft.com/microsoft-365/compliance/set-up-new-message-encryption-capabilities)\r\nüí°¬†[Define Mail Flow Rules to Encrypt Email Messages](https://docs.microsoft.com/microsoft-365/compliance/define-mail-flow-rules-to-encrypt-email)\r\nüí°¬†[Manage Office 365 Message Encryption](https://docs.microsoft.com/microsoft-365/compliance/manage-office-365-message-encryption)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ PR.DS"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Office 365 for Email Encryption\r\n![Image¬†Name](https://docs.microsoft.com/microsoft-365/media/adhocencryptionrevoke.png)\r\n\r\n‚ú≥Ô∏è [Get Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEmailVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Encryption for Email Transmission",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Malicious URL Protections\r\n\r\n### TIC 3.0 Guidance\r\nMalicious URL protections detect malicious URLs in emails and prevent users from accessing them.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Microsoft Defender for Office 365 Safe Links for Malicious URL Detections\r\n\r\n### Navigate \r\n\t‚Ä¢ Office 365 Security & Compliance > Threat Management > Policy > ATP Safe Links\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Office 365 Security & Compliance Center](https://protection.office.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Safe Links in Microsoft Defender for Office 365](https://docs.microsoft.com/microsoft-365/security/office-365-security/atp-safe-links)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ DE.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft Defender for Office 365: Safe Links for Malicious URL Detections\r\n![Image¬†Name](https://docs.microsoft.com/microsoft-365/media/tp-safe-links-for-teams-malicious.png)\r\n\r\n‚ú≥Ô∏è [Get Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEmailVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Malicious URL Protections",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ URL Click-Through Protection\r\n\r\n### TIC 3.0 Guidance\r\nURL click-through protections ensure that when a URL from an email is clicked, the requester is directed to a protection that verifies the security of the URL destination before permitting access.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Microsoft Defender for Office 365 Safe Links for URL Click-Through Protections\r\n\r\n### Navigate \r\n\t‚Ä¢ Office 365 Security & Compliance > Threat Management > Policy > ATP Safe Links\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Office 365 Security & Compliance Center](https://protection.office.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Safe Links in Microsoft Defender for Office 365](https://docs.microsoft.com/microsoft-365/security/office-365-security/atp-safe-links)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ DE.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft Defender for Office 365: Safe Links for URL Click-Through Protections\r\n![Image¬†Name](https://docs.microsoft.com/microsoft-365/media/ee8dd5ed-6b91-4248-b054-12b719e8d0ed.png)\r\n\r\n‚ú≥Ô∏è [Get Microsoft Defender for Office 365](https://www.microsoft.com/microsoft-365/security/office-365-defender)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEmailVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEmailVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "URL Click-Through Protection",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##¬†Web\r\nWeb-based protections including break/inspect, active content mitigation, certificate blacklisting/consensus, content filtering, authenticated proxy, data loss prevention, DNS-over-HTTPS filtering, RFC compliance enforcement, domain category filtering, domain reputation filtering, bandwidth control, malicious content filtering, and access control.\r\n\r\n|¬†<em> TIC 3.0 vs Zero Trust </em> |\r\n|¬†:¬†|¬†: | : | : |\r\n|¬†<strong> Capabilities¬†</strong> | <strong> Microsoft Controls¬†</strong> |¬†<strong> Zero Trust Principles </strong>  | <strong> Zero Trust Pillars </strong>  |\r\n|¬†Break and Inspect¬†|¬†‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/)  | Verify Explicitly, Use Least Privileged Access, Assume Breach | Network | \r\n|¬†Active Content Mitigation¬†|¬†‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)  | Assume Breach | Network | \r\n|¬†Certificate Denylisting |¬†‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/)  | Verify Explicitly | Network |  \r\n|¬†Content Filtering |¬†‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)  | Assume Breach | Endpoints, Network | \r\n|¬†Authenticated Proxy |¬†‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) ‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)  | Very Explicitly | Identities, Network | \r\n|¬†Data Loss Prevention |¬†‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/)  ‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)  | Assume Breach | Data | \r\n|¬†DNS-over-HTTPS Filtering |¬†‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)  | Verify Explicitly | Endpoints, Network | \r\n|¬†RFC Compliance Enforcement |¬†‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)  | Use Least Privileged Access, Assume Breach | Network | \r\n|¬†Domain Category Filtering |¬†‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/)  | Assume Breach | Network | \r\n|¬†Domain Reputation Filter |¬†‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/)  | Assume Breach | Network |\r\n|¬†Bandwidth Control |¬†‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/)  | Assume Breach | Network | \r\n|¬†Malicious Content Filtering |¬†‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/) ‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)  | Assume Breach | Network | \r\n|¬†Access Control |¬†‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) ‚ú≥Ô∏è [Azure Defender]( https://azure.microsoft.com/services/azure-defender/)  | Verify Explicitly, Use Least Privileged Access | Identities, Network | \r\nFor more information, see the CISA: Trusted Internet Connections üí°[Core Guidance Documents](https://www.cisa.gov/trusted-internet-connections) and Microsoft's üí°[Why Zero Trust](https://www.microsoft.com/security/business/zero-trust)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "isWebVisible",
          "comparison": "isEqualTo",
          "value": "true"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Web Capabilities Guide",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "02e1e8dc-ada0-4398-a18e-ee6a27a4398c",
            "cellValue": "Break and Inspect",
            "linkTarget": "step",
            "linkLabel": "Break and Inspect",
            "style": "link"
          },
          {
            "id": "73c46479-2507-480d-81c2-59b8eb2dde4c",
            "cellValue": "Active Content Mitigation",
            "linkTarget": "step",
            "linkLabel": "Active Content Mitigation",
            "style": "link"
          },
          {
            "id": "899e3919-5a81-48ad-9fe1-2b30ea75e063",
            "cellValue": "Certificate Denylisting",
            "linkTarget": "step",
            "linkLabel": "Certificate Denylisting",
            "style": "link"
          },
          {
            "id": "134c9530-0a39-49e3-af06-57a55a4405a2",
            "cellValue": "Content Filtering",
            "linkTarget": "step",
            "linkLabel": "Content Filtering",
            "style": "link"
          },
          {
            "id": "654216c3-dd72-4350-936e-fbddc7403bfe",
            "cellValue": "Authenticated Proxy",
            "linkTarget": "step",
            "linkLabel": "Authenticated Proxy",
            "style": "link"
          },
          {
            "id": "53b5caf3-9696-403b-9aba-501f81f28a78",
            "cellValue": "Data Loss Prevention_W",
            "linkTarget": "step",
            "linkLabel": "Data Loss Prevention",
            "style": "link"
          },
          {
            "id": "1399dbe0-3ec8-4aca-a6f2-159076019a67",
            "cellValue": "DNS-over-HTTPS Filtering",
            "linkTarget": "step",
            "linkLabel": "DNS-over-HTTPS Filtering",
            "style": "link"
          },
          {
            "id": "4c24ab6e-8548-40ad-8e13-6f57a9216e8f",
            "cellValue": "RFC Compliance Enforcement",
            "linkTarget": "step",
            "linkLabel": "RFC Compliance Enforcement",
            "style": "link"
          },
          {
            "id": "3330274e-62a3-4080-818e-e69976148766",
            "cellValue": "Domain Category Filtering",
            "linkTarget": "step",
            "linkLabel": "Domain Category Filtering",
            "style": "link"
          },
          {
            "id": "281a70fe-cc00-4620-acad-fa927c48575b",
            "cellValue": "Domain Reputation Filter",
            "linkTarget": "step",
            "linkLabel": "Domain Reputation Filter",
            "style": "link"
          },
          {
            "id": "8089a515-f341-40d7-9826-4d88a34f5f93",
            "cellValue": "Bandwidth Control",
            "linkTarget": "step",
            "linkLabel": "Bandwidth Control",
            "style": "link"
          },
          {
            "id": "a3175efa-dcda-4782-b216-e9bbdc6a8903",
            "cellValue": "Malicious Content Filtering",
            "linkTarget": "step",
            "linkLabel": "Malicious Content Filtering",
            "style": "link"
          },
          {
            "id": "421a85e7-424d-4bbb-8c60-cda8e43ba959",
            "cellValue": "Access Control_W",
            "linkTarget": "step",
            "linkLabel": "Access Control",
            "style": "link"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isWebVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Web Selector"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Break and Inspect\r\n\r\n### TIC 3.0 Guidance\r\nBreak-and-Inspect systems, or encryption proxies, terminate encrypted traffic, logging or performing policy enforcement against the plaintext, and re-encrypting the traffic, if applicable, before transmitting to the final destination.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Firewall Premium for TLS Inspection\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ AzureDiagnostics (Azure Firewall) ‚ú≥Ô∏è [Get Started with Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)\r\n\r\n### Navigate \r\n    ‚Ä¢ Firewalls > Add\r\n    ‚Ä¢ Firewall Manager > Azure Firewall Policies\r\n    ‚Ä¢ Firewall Policies > Add\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Firewalls](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FazureFirewalls) \r\nüîÑ [Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview) \r\nüîÑ [Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FfirewallPolicies) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Azure Firewall Premium Features](https://docs.microsoft.com/azure/firewall/premium-features)\r\nüí°¬†[Inspect Traffic with Azure Firewall](https://docs.microsoft.com/azure/private-link/inspect-traffic-with-azure-firewall)\r\nüí°¬†[Tutorial: Deploy and Configure Azure Firewall Using the Azure Portal](https://docs.microsoft.com/azure/firewall/tutorial-firewall-deploy-portal)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT\r\n    ‚Ä¢ DE.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureDiagnostics \r\n| where ResourceType == \"AZUREFIREWALLS\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†Category\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Firewall Rule Category Count",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Firewall Premium for TLS Inspection\r\n![Image¬†Name](https://docs.microsoft.com/azure/firewall/media/premium-features/premium-overview.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isWebVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Break and Inspect",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Active Content Mitigation\r\n\r\n### TIC 3.0 Guidance\r\nActive content mitigation protections detect the presence of unapproved active content and facilitate its removal.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Web Application Firewall to Mitigate Active Content\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ AzureDiagnostics (Azure Web Application Firewall) ‚ú≥Ô∏è [Get Started with Azure Web Application Firewall](https://azure.microsoft.com/services/web-application-firewall/)\r\n\r\n### Navigate \r\n\t‚Ä¢ Web Application Firewall Policies (WAF) > Create\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Web Application Firewall Policies](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)  \r\n###¬†Microsoft¬†Reference¬†\r\nüí°[What is Azure Web Application Firewall on Azure Application Gateway?](https://docs.microsoft.com/azure/web-application-firewall/ag/ag-overview)\r\nüí°[Azure Web Application Firewall on Azure Front Door](https://docs.microsoft.com/azure/web-application-firewall/afds/afds-overview)\r\n\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ DE.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let FakeData = (datatable (Message: string, ruleName_s: string, clientIp_s: string, clientIP_s: string, action_s: string, transactionId_s: string, trackingReference_s: string) [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]);\r\nFakeData\r\n| union AzureDiagnostics\r\n| where (ResourceType == \"APPLICATIONGATEWAYS\" or ResourceType == \"FRONTDOORS\" or ResourceType == \"CDNWEBAPPLICATIONFIREWALLPOLICIES\") and (\"Application Gateway\" == \"All\" or (ResourceType == \"APPLICATIONGATEWAYS\" and \"Application Gateway\" contains \"application gateway\") or (ResourceType == \"FRONTDOORS\" and \"Application Gateway\" contains \"azure front door\") or (ResourceType == \"CDNWEBAPPLICATIONFIREWALLPOLICIES\" and \"Application Gateway\" contains \"cdn\")) and (\"SOC-NS-AG-WAFV2 - 1129440\" == \"All\" or Resource in ('SOC-NS-AG-WAFV2'))\r\n| where Category == \"FrontdoorWebApplicationFirewallLog\" or OperationName == \"ApplicationGatewayFirewall\" or Category == \"WebApplicationFirewallLogs\"\r\n| extend Action = iif(action_s == \"Blocked\", Action = \"Block\", action_s)\r\n| extend Action = iif(Action == \"Detected\", Action = \"Log\", Action)\r\n| where '*' == Action or '*' == \"*\" \r\n| where '*' == requestUri_s or '*' == \"*\"\r\n| extend Rule = strcat(ruleName_s, Message), ClientIP = strcat(clientIp_s, clientIP_s)\r\n| extend Rule= iif(Rule contains \"Mandatory rule. Cannot be disabled.\", strcat_array(split(Rule, \"Mandatory rule. Cannot be disabled. Inbound \", 1), \"\"), Rule) // Removes initial component for mandatory rule \r\n| extend Rule = iif(Rule contains \"Total Inbound Score\", strcat_array(array_concat(split(Rule, \" - SQLI=\", 0), parse_json('[\") -\"]'), split(Rule, \"):\", 1)), \"\"), Rule) // Removes smaller information if more info is available for anomaly score\r\n| summarize count() by Rule\r\n| top 50 by count_ desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure WAF Events",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Rule",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "warning",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "count_",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "redDark"
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Web Application Firewall for Active Content Mitigation\r\n![Image¬†Name](https://docs.microsoft.com/azure/web-application-firewall/media/ag-overview/waf1.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Web Application Firewall](https://azure.microsoft.com/services/web-application-firewall/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isWebVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Active Content Mitigation",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Certificate Denylisting\r\n\r\n### TIC 3.0 Guidance\r\nCertificate denylisting protections prevent communication with entities that use a set of known bad certificates.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Firewall to Deny Traffic to Web Entities with Known Bad Certificates\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ AzureDiagnostics (Azure Firewall) ‚ú≥Ô∏è [Get Started with Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)\r\n\r\n### Navigate \r\n    ‚Ä¢ Firewalls > Add\r\n    ‚Ä¢ Firewall Manager > Azure Firewall Policies\r\n    ‚Ä¢ Firewall Policies > Add\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Firewalls](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FazureFirewalls) \r\nüîÑ [Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview) \r\nüîÑ [Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FfirewallPolicies)\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Certificates Used by Azure Firewall Premium](https://docs.microsoft.com/azure/firewall/premium-certificates)\r\nüí°¬†[Tutorial: Deploy and Configure Azure Firewall Using the Azure Portal](https://docs.microsoft.com/azure/firewall/tutorial-firewall-deploy-portal)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ DE.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureDiagnostics \r\n| where ResourceType == \"AZUREFIREWALLS\"\r\n| where msg_s contains \"cert\" and msg_s contains \"deny\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†Category\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Firewall Bad Certificate Denys",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Firewall Premium to Deny Traffic to Web Entities with Known Bad Certificates\r\n![Image¬†Name](https://docs.microsoft.com/azure/firewall/media/premium-certificates/certificate-process.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isWebVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Certificate Denylisting",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Content Filtering\r\n\r\n### TIC 3.0 Guidance\r\nContent filtering protections detect the presence of unapproved content and facilitate its removal or denial of access.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Microsoft Defender for Endpoint for Web Content Defense\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityAlert (Microsoft Defender for Endpoint) ‚ú≥Ô∏è [Get Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)\r\n\r\n### Navigate \r\n\t‚Ä¢ Microsoft 365 Security Center > Settings > General > Advanced Features > Web Threat Protection\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Microsoft 365 Security Center](https://security.microsoft.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Protect Your Organization Against Web Threats](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/web-threat-protection)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ DE.CM\r\n\t‚Ä¢ DE.DP"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where ProviderName == \"MDATP\"\r\n| where AlertName contains \"URL\" or AlertName contains \"web\" or AlertName contains \"indicator\" or Description contains \"URL\" or AlertType contains \"NetworkProtectionBlocked\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AlertName\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Microsoft Defender for Endpoint: Web Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft Defender for Endpoint for Web Content Filtering\r\n![Image¬†Name](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/images/web-protection.png)\r\n\r\n‚ú≥Ô∏è [Get Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isWebVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Content Filtering",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Authenticated Proxy\r\n\r\n### TIC 3.0 Guidance\r\nAuthenticated proxies require entities to authenticate with the proxy before making use of it, enabling user, group, and location-aware security controls.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Active Directory Application Proxy and Microsoft Cloud App Security for Authenticated Proxies \r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Active Directory > Enterprise Applications > All Applications > Select App > Application Proxy\r\n\t‚Ä¢ Azure Active Directory > Conditional Access > New Policy\r\n\t‚Ä¢ Microsoft Cloud App Security > Policies\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) \r\nüîÑ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Plan an Azure AD Application Proxy Deployment](https://docs.microsoft.com/azure/active-directory/manage-apps/application-proxy-deployment-plan)\r\nüí°¬†[Configure Real-Time Application Access Monitoring with Microsoft Cloud App Security and Azure Active Directory](https://docs.microsoft.com/azure/active-directory/manage-apps/application-proxy-integrate-with-microsoft-cloud-application-security)\r\nüí°¬†[Protect Apps with Microsoft Cloud App Security Conditional Access App Control](https://docs.microsoft.com/cloud-app-security/proxy-intro-aad)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.AC"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Active Directory Application Proxy and Microsoft Cloud App Security for Authenticated Proxies\r\n![Image¬†Name](https://docs.microsoft.com/azure/active-directory/manage-apps/media/app-proxy-deployment-plan/link-translation.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)\r\n‚ú≥Ô∏è [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/trial/get-started-active-directory/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isWebVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Authenticated Proxy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Data Loss Prevention\r\n\r\n### TIC 3.0 Guidance\r\nData loss prevention technologies detect instances of the exfiltration, either malicious or accidental, of agency data.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Microsoft Cloud App Security and Azure Information Protection for Web Data Loss Prevention\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityAlert (Microsoft Cloud App Security) ‚ú≥Ô∏è [Get Started with Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)\r\nüî∑ InformationProtectionLogs_CL (Azure Information Protection) ‚ú≥Ô∏è [Get Started with Azure Information Protection](https://azure.microsoft.com/services/information-protection)\r\n\r\n### Navigate \r\n\t‚Ä¢ Microsoft Cloud App Security > Control > Policies > Information Protection > Create Policy\r\n\t‚Ä¢ Microsoft Cloud App Security > Settings > Azure Information Protection > Inspect Protected Files\r\n\t‚Ä¢ Azure Information Protection > Classifications > Labels\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/)\r\nüîÑ [Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Microsoft Cloud App Security: File Policies](https://docs.microsoft.com/cloud-app-security/data-protection-policies)\r\nüí°¬†[Content Inspection for Protected Files](https://docs.microsoft.com/cloud-app-security/content-inspection)\r\nüí°¬†[How to Configure a Label for Rights Management Protection](https://docs.microsoft.com/azure/information-protection/configure-policy-protection)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.DS"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where ProviderName == \"MCAS\"\r\n| where AlertName contains \"share\" or AlertName contains \"download\" or AlertName contains \"upload\" or AlertName contains \"inbox\" or AlertName contains \"label\" or AlertName contains \"info\" or AlertName contains \"data\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AlertName\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Web Data Loss Prevention Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft Cloud App Security and Azure Information Protection for Web Data Loss Prevention\r\n![Image¬†Name](https://docs.microsoft.com/cloud-app-security/media/create-policy-from-information-protection-tab.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)\r\n‚ú≥Ô∏è [Get Started with Azure Information Protection](https://azure.microsoft.com/services/information-protection/)\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isWebVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Data Loss Prevention_W",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ DNS-over-HTTPS Filtering\r\n\r\n### TIC 3.0 Guidance\r\nDNS-over-HTTPS filtering prevents entities from using the DNS-over-HTTPS protocol, possibly evading DNS-based protections.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Mitigate DNS-over-HTTPS with Agent-Based Web Filters such as Microft Defender for Endpoint: Web Content Filtering\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityAlert (Microsoft Defender for Endpoint) ‚ú≥Ô∏è [Get Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)\r\n\r\n### Navigate \r\n    ‚Ä¢ Microsoft 365 Security Center > Settings > General > Advanced Features > Web Content Filtering\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Microsoft 365 Security Center](https://security.microsoft.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Web Content Filtering](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/web-content-filtering)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ DE.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where ProviderName == \"MDATP\"\r\n| where AlertName contains \"URL\" or AlertName contains \"web\" or AlertName contains \"indicator\" or Description contains \"URL\" or AlertType contains \"NetworkProtectionBlocked\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AlertName\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Microsoft Defender for Endpoint: URL Blocks",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Mitigate DNS-over-HTTPS with Agent-Based Web Filters such as Microsoft Defender for Endpoint: Web Content Filtering\r\n![Image¬†Name](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/images/web-protection-report-details.png)\r\n\r\n‚ú≥Ô∏è [Get Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isWebVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "DNS-over-HTTPS Filtering",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ RFC Compliance Enforcement\r\n\r\n### TIC 3.0 Guidance\r\nRFC compliant enforcement technologies ensure that traffic complies with protocol definitions.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Web Application Firewall for RFC Compliance Enforcement\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ AzureDiagnostics (Azure Web Application Firewall) ‚ú≥Ô∏è [Get Started with Azure Web Application Firewall](https://azure.microsoft.com/services/web-application-firewall/)\r\n\r\n### Navigate \r\n    ‚Ä¢ Web Application Firewall Policies (WAF) > Create\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Web Application Firewall Policies](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)  \r\n###¬†Microsoft¬†Reference¬†\r\nüí°[What is Azure Web Application Firewall on Azure Application Gateway?](https://docs.microsoft.com/azure/web-application-firewall/ag/ag-overview)\r\nüí°[Tutorial: Create an Application Gateway with a Web Application Firewall using the Azure Portal](https://docs.microsoft.com/azure/web-application-firewall/ag/application-gateway-web-application-firewall-portal)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureDiagnostics \r\n| where Category == \"ApplicationGatewayFirewallLog\"\r\n| where details_file_s contains \"rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†Message\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure WAF: Protocol Enforcement Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Web Application Firewall for RFC Compliance Enforcement\r\n![Image¬†Name](https://docs.microsoft.com/azure/web-application-firewall/media/application-gateway-web-application-firewall-portal/scenario-waf.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Web Application Firewall](https://azure.microsoft.com/services/web-application-firewall/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isWebVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "RFC Compliance Enforcement",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Domain Category Filtering\r\n\r\n### TIC 3.0 Guidance\r\nDomain category filtering technologies allow for classes of domains (e.g. banking, medical) to receive a different set of security protections.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Firewall Premium for Domain Category Filtering\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ AzureDiagnostics (Azure Firewall) ‚ú≥Ô∏è [Get Started with Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)\r\n\r\n### Navigate \r\n    ‚Ä¢ Firewalls > Add\r\n    ‚Ä¢ Firewall Manager > Azure Firewall Policies\r\n    ‚Ä¢ Firewall Policies > Add > Application Rule > Add a Rule Collection\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Firewalls](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FazureFirewalls) \r\nüîÑ [Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview) \r\nüîÑ [Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FfirewallPolicies)\t\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Azure Firewall: Web Categories](https://docs.microsoft.com/azure/firewall/premium-deploy#web-categories-testing)  \r\nüí°¬†[Azure Firewall Premium Features](https://docs.microsoft.com/azure/firewall/premium-features)  \r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.AC\r\n\t‚Ä¢ PR.IP"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let materializedData =\r\n    materialize(\r\n    AzureDiagnostics\r\n    | where Category == \"AzureFirewallApplicationRule\"\r\n    | where Resource in~ (split(\"SOC-NS-FW\", \", \"))\r\n    | project msg_s, Resource, TimeGenerated);\r\nunion\r\n    (\r\n    materializedData\r\n    | where msg_s has \"Web Category:\" and msg_s has \". Url\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Url:\" Url \". Action: \" Action \". Rule Collection:\" RuleCollection \". Rule:\" Rule \". Web Category:\" WebCategory\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s has \"Web Category:\" and msg_s !has \". Url\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Rule Collection:\" RuleCollection \". Rule:\" Rule \". Web Category:\" WebCategory\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\" and msg_s !has \". Url\" and msg_s !has \"Rule Collection\" and msg_s !has \" Reason: \"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". \" RuleCollection \". \" Rule\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\" and msg_s !has \". Url\" and msg_s !has \"Rule Collection\" and msg_s !has \"TLS extension was missing\"\r\n    | where msg_s has \" Reason:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \". Action: \" Action \". Reason: \" Rule \".\"\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\" and msg_s !has \". Url\" and msg_s !has \"TLS extension was missing\" and msg_s !has \"No rule matched\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\" and msg_s !has \". Url\" and msg_s !has \"Rule Collection\" and msg_s !has \" Reason: \"\r\n    | where msg_s has \"Rule Collection Group\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Policy:\" Policy \". Rule Collection Group:\" RuleCollectionGroup \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    )\r\n| where isnotempty(WebCategory)\r\n| where Action == \"Allow\"\r\n| where '*' == SourceIP or '*' == \"*\"\r\n| summarize count() by WebCategory\r\n| render piechart\r\n\r\n\r\n\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Firewall: Web Categorization",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Firewall Premium for Web Category Filtering\r\n![Image¬†Name](https://docs.microsoft.com/azure/firewall/media/premium-deploy/web-categories.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isWebVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Domain Category Filtering",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Domain Reputation Filter\r\n\r\n### TIC 3.0 Guidance\r\nDomain reputation filtering protections are a form of domain denylisting based on a domain‚Äôs reputation, as defined by either the agency or an external entity.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Firewall Premium for Domain Reputation Filtering via Threat Intelligence\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ AzureDiagnostics (Azure Firewall) ‚ú≥Ô∏è [Get Started with Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)\r\n\r\n### Navigate \r\n    ‚Ä¢ Firewalls > Add\r\n    ‚Ä¢ Firewall Manager >  Azure Firewall Policies > Threat Intelligence > Create Azure Firewall Policy > Threat Intelligence\r\n\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Firewalls](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FazureFirewalls) \r\nüîÑ [Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Azure Firewall Threat Intelligence-Based Filtering](https://docs.microsoft.com/azure/firewall/threat-intel)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureDiagnostics\r\n| where Category == \"AzureFirewallNetworkRule\"\r\n| where OperationName == \"AzureFirewallThreatIntelLog\"\r\n| where Resource in~ (split(\"FW-PREM, SOC-NS-FW\", \", \"))\r\n| parse msg_s with Protocol \" request from\" SourceIP \":\" SourcePortInt: int \" to\" TargetIP \":\" TargetPortInt: int *\r\n| where msg_s contains \"*\" or '*' == \"*\"\r\n| parse msg_s with * \". Action: \" Action1a\r\n| parse msg_s with * \" was \" Action1b \" to \" NatDestination\r\n| parse msg_s with Protocol2 \" request from\" SourceIP2 \" to\" TargetIP2 \". Action:\" Action2\r\n| parse msg_s with Protocol_s 'request from ' SourceHost_s ':' SourcePort_s 'to ' DestinationHost_s ':' DestinationPort_s 'was' Action_s 'to' DNATDestination\r\n| parse msg_s with Protocol_S 'request from ' SourceHost_S ':' SourcePort_S 'to ' DestinationHost_S ':' DestinationPort_S '. Action:' Action_S\r\n| extend Protocol = strcat(Protocol_s, Protocol_S), SourceHost = strcat(SourceHost_s, SourceHost_S), SourcePort = strcat(SourcePort_s, SourcePort_S), DestinationHost = strcat(DestinationHost_s, DestinationHost_S), DestinationPort = strcat(DestinationPort_s, DestinationPort_S), Action = strcat(Action_s, Action_S)\r\n| extend SourcePort = tostring(SourcePortInt), TargetPort = tostring(TargetPortInt)\r\n| extend Action = case(Action1a == \"\", case(Action1b == \"\", Action2, Action1b), Action1a), Protocol = case(Protocol == \"\", Protocol2, Protocol), SourceIP = case(SourceIP == \"\", SourceIP2, SourceIP), TargetIP = case(TargetIP == \"\", TargetIP2, TargetIP), SourcePort = case(SourcePort == \"\", \"N/A\", SourcePort), TargetPort = case(TargetPort == \"\", \"N/A\", TargetPort), NatDestination = case(NatDestination == \"\", \"N/A\", NatDestination)\r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by Action\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Firewall: Threat Intelligence Blocks",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Firewall Premium for Domain Reputation Filtering via Threat Intelligence\r\n![Image¬†Name](https://docs.microsoft.com/azure/firewall/media/threat-intel/threat-intel-ui.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isWebVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Domain Reputation Filter",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Bandwidth Control\r\n\r\n### TIC 3.0 Guidance\r\nBandwidth control technologies allow for limiting the amount of bandwidth used by different classes of domains.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Firewall Premium: Web Categories for Bandwidth Control\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ AzureDiagnostics (Azure Firewall) ‚ú≥Ô∏è [Get Started with Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)\r\n\r\n### Navigate \r\n    ‚Ä¢ Firewalls > Add\r\n    ‚Ä¢ Firewall Policy >  Application Rule > Add a Rule Collection > Include Destination Type = High-Bandwidth\r\n\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Firewalls](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FazureFirewalls) \r\nüîÑ [Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FfirewallPolicies) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Azure Firewall: Web Categories](https://docs.microsoft.com/azure/firewall/premium-deploy#web-categories-testing)  \r\nüí°¬†[Azure Firewall Premium Features](https://docs.microsoft.com/azure/firewall/premium-features)  \r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "Bandwidth Control",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let materializedData =\r\n    materialize(\r\n    AzureDiagnostics\r\n    | where Category == \"AzureFirewallApplicationRule\"\r\n    | where Resource in~ (split(\"SOC-NS-FW\", \", \"))\r\n    | project msg_s, Resource, TimeGenerated);\r\nunion\r\n    (\r\n    materializedData\r\n    | where msg_s has \"Web Category:\" and msg_s has \". Url\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Url:\" Url \". Action: \" Action \". Rule Collection:\" RuleCollection \". Rule:\" Rule \". Web Category:\" WebCategory\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s has \"Web Category:\" and msg_s !has \". Url\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Rule Collection:\" RuleCollection \". Rule:\" Rule \". Web Category:\" WebCategory\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\" and msg_s !has \". Url\" and msg_s !has \"Rule Collection\" and msg_s !has \" Reason: \"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". \" RuleCollection \". \" Rule\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\" and msg_s !has \". Url\" and msg_s !has \"Rule Collection\" and msg_s !has \"TLS extension was missing\"\r\n    | where msg_s has \" Reason:\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \". Action: \" Action \". Reason: \" Rule \".\"\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\" and msg_s !has \". Url\" and msg_s !has \"TLS extension was missing\" and msg_s !has \"No rule matched\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    ),\r\n    (\r\n    materializedData\r\n    | where msg_s !has \"Web Category:\" and msg_s !has \". Url\" and msg_s !has \"Rule Collection\" and msg_s !has \" Reason: \"\r\n    | where msg_s has \"Rule Collection Group\"\r\n    | parse msg_s with Protocol \" request from \" SourceIP \":\" SourcePort \" to \" FQDN \":\" DestinationPort \". Action: \" Action \". Policy:\" Policy \". Rule Collection Group:\" RuleCollectionGroup \". Rule Collection: \" RuleCollection \". Rule: \" Rule\r\n    )\r\n| where isnotempty(WebCategory)\r\n| where Action == \"Allow\"\r\n| where '*' == SourceIP or '*' == \"*\"\r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by WebCategory\r\n| render areachart\r\n\r\n\r\n\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Firewall: Browsing Sessions by Web Categorization",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isWebVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Bandwidth Control",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Malicious Content Filtering\r\n\r\n### TIC 3.0 Guidance\r\nMalicious content filtering protections detect the presence of malicious content and facilitate its removal.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Web Application Firewall and Azure Firewall Premium for Malicious Content Filtering\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ AzureDiagnostics (Azure Web Application Firewall) ‚ú≥Ô∏è [Get Started with Azure Web Application Firewall](https://azure.microsoft.com/services/web-application-firewall/)\r\nüî∑ AzureDiagnostics (Azure Firewall) ‚ú≥Ô∏è [Get Started with Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)\r\n\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Web Application Firewall Policies](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers) \r\n\r\n###¬†Microsoft¬†Reference¬†\r\nüí°[What is Azure Web Application Firewall on Azure Application Gateway?](https://docs.microsoft.com/azure/web-application-firewall/ag/ag-overview)\r\nüí°[Azure Web Application Firewall on Azure Front Door](https://docs.microsoft.com/azure/web-application-firewall/afds/afds-overview)\r\nüí°¬†[Azure Firewall Premium Features](https://docs.microsoft.com/azure/firewall/premium-features)  \r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.DS\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ PR.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureDiagnostics\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†Category\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure WAF: Web Protection Rules Triggered",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isWebVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Malicious Content Filtering",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Access Control\r\n\r\n### TIC 3.0 Guidance\r\nAccess control technologies allow an agency to define policies limiting what actions may be performed by connected users and entities.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Active Directory Role Based Access Control for User/Group Permissions\r\n\t‚Ä¢ Use Azure Active Directory: Privileged Identity Management for Administrator Controls\r\n\t‚Ä¢ Leverage Azure Defender: Just In Time Access for Network Access Control\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ AuditLogs¬†(Azure Active Directory: PIM) ‚ú≥Ô∏è [Get Started with Azure Active Directory](https://azure.microsoft.com/services/active-directory/) \r\nüî∑ SecurityRecommendation¬†(Azure Security Center) ‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/security-center/) \r\n\r\n### Navigate \r\n    ‚Ä¢ Azure Active Directory > Roles & Adminstrators\r\n\t‚Ä¢ Azure Active Directory > Privileged Identity Management > Manage Access\r\n\t‚Ä¢ Security Center > Azure Defender > Just-in-Time VM Access\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) \r\nüîÑ [Privileged Identity Management](https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart) \r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Overview of Role-Based Access Control in Azure Active Directory](https://docs.microsoft.com/azure/active-directory/roles/custom-overview)\r\nüí°¬†[What is Azure AD Privileged Identity Management?](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure)\r\nüí°¬†[Secure Your Management Ports With Just-In-Time Access](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-configure)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.AC"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AuditLogs\r\n| where Identity == \"MS-PIM\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†OperationName\r\n| render areachart \r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Privileged Identity Management Actions",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Configure Just-In-Time Access\r\n![Image¬†Name](https://docs.microsoft.com/azure/security-center/media/security-center-just-in-time/jit-select-activity-log.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/security-center/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationName contains \"just-in-time\" \r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†RecommendationName\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Security Center: JIT Recommenations",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isWebVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isWebVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Access Control_W",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##¬†Networking\r\nNetwork-based protections including network access controls, IP denylisting, host containment, network segmentation, and microsegmentation. \r\n\r\n|¬†<em> TIC 3.0 vs Zero Trust </em> |\r\n|¬†:¬†|¬†: | : | : |\r\n|¬†<strong> Capabilities¬†</strong> | <strong> Microsoft Controls¬†</strong> |¬†<strong> Zero Trust Principles </strong>  | <strong> Zero Trust Pillars </strong>  |\r\n|¬†Access Control¬†|¬†‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/) ‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/) ‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/) ‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/) ‚ú≥Ô∏è [VPN Gateway]( https://azure.microsoft.com/services/vpn-gateway/) ‚ú≥Ô∏è [Azure ExpressRoute]( https://azure.microsoft.com/services/expressroute/) | Use Least Privileged Access | Infrastructure, Network | \r\n|¬†IP Denylisting¬†|¬†‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)  ‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/)  | Use Least Privileged Access | Infrastructure, Network |  \r\n|¬†Host Containment¬†|¬†‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)  ‚ú≥Ô∏è [Azure Logic Apps](https://azure.microsoft.com/services/logic-apps/)  ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)  | Assume Breach | Endpoints, Infrastructure, Network | \r\n|¬†Network Segmentation¬†|¬†‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/)  | Assume Breach | Infrastructure, Network | \r\n|¬†Microsegmentation¬†|¬†‚ú≥Ô∏è [Virtual Network]( https://azure.microsoft.com/services/virtual-network/) ‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/)  ‚ú≥Ô∏è [Application Gateway]( https://azure.microsoft.com/services/application-gateway/) ‚ú≥Ô∏è [Azure Web Application Firewall]( https://azure.microsoft.com/services/web-application-firewall/)  | Assume Breach | Infrastructure, Network | \r\nFor more information, see the CISA: Trusted Internet Connections üí°[Core Guidance Documents](https://www.cisa.gov/trusted-internet-connections) and Microsoft's üí°[Why Zero Trust](https://www.microsoft.com/security/business/zero-trust)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "isNetworkingVisible",
          "comparison": "isEqualTo",
          "value": "true"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Networking Capabilities Guide",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "24c6c093-03b1-48d3-8446-b62c7768ab91",
            "cellValue": "Access Control_N",
            "linkTarget": "step",
            "linkLabel": "Access Control",
            "style": "link"
          },
          {
            "id": "49076f2b-dc1e-4fc8-8a35-415b2bd20baa",
            "cellValue": "IP Denylisting",
            "linkTarget": "step",
            "linkLabel": "IP Denylisting",
            "style": "link"
          },
          {
            "id": "36a87896-a2b9-4050-82d5-36891c43b497",
            "cellValue": "Host Containment",
            "linkTarget": "step",
            "linkLabel": "Host Containment",
            "style": "link"
          },
          {
            "id": "baf36c82-aa55-42e8-88df-60bf3051c347",
            "cellValue": "Network Segmentation",
            "linkTarget": "step",
            "linkLabel": "Network Segmentation",
            "style": "link"
          },
          {
            "id": "2fcbeaa9-e652-4d47-a07b-0c3b9bc6b266",
            "cellValue": "Microsegmentation",
            "linkTarget": "step",
            "linkLabel": "Microsegmentation",
            "style": "link"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isNetworkingVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Networking Capabilities Selector"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Access Control\r\n\r\n### TIC 3.0 Guidance\r\nAccess control protections prevent the ingest, egress, or transiting of unauthorized network traffic.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Use Azure Security Center Recommendations to Restrict Unauthorized Traffic\r\n\t‚Ä¢ Leverage Network Security Groups to Prevent Unauthorized Internal Traffic\r\n\t‚Ä¢ Use Azure Firewall and Azure Web Appliation Firewall to Restrict Unauthorized External Traffic\r\n\t‚Ä¢ Leverage VPN Gateway for Secure Access to Workloads\r\n\t‚Ä¢ Use Azure ExpressRoute to Extend On-premises Networks into the Microsoft Cloud Over Private Connections\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityRecommendation¬†(Azure Security Center) ‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/security-center/) \r\nüî∑ AzureDiagnostics (Network Security Groups) ‚ú≥Ô∏è [Get Started with Virtual Network](https://azure.microsoft.com/services/virtual-network/)\r\nüî∑ AzureDiagnostics (Azure Firewall) ‚ú≥Ô∏è [Get Started with Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)\r\nüî∑ AzureDiagnostics (Azure Web Application Firewall) ‚ú≥Ô∏è [Get Started with Azure Web Application Firewall](https://azure.microsoft.com/services/web-application-firewall/)\r\n\r\n### Navigate \r\n\t‚Ä¢ Security Center > Recommendations > Restrict Unauthorized Network Traffic / Secure Management Ports\r\n\t‚Ä¢ Network Security Groups > Add\r\n\t‚Ä¢ Firewalls > Add\r\n\t‚Ä¢ Web Application Firewall Policies (WAF) > Create\r\n\t‚Ä¢ Virtual Network Gateways > Add\r\n\t‚Ä¢ ExpressRoute Circuits > Add\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) üîÑ [Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups) üîÑ [Firewalls](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FazureFirewalls) üîÑ [Web Application Firewall Policies](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers) üîÑ [Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways) üîÑ [ExpressRoute Circuits](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FexpressRouteCircuits)  \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Security Recommendations in Azure Security Center](https://docs.microsoft.com/azure/security-center/security-center-recommendations)\r\nüí°¬†[Network Security Groups](https://docs.microsoft.com/azure/virtual-network/network-security-groups-overview)\r\nüí°¬†[Tutorial: Deploy and Configure Azure Firewall Using the Azure Portal](https://docs.microsoft.com/azure/firewall/tutorial-firewall-deploy-portal)\r\nüí°[Tutorial: Create an Application Gateway with a Web Application Firewall using the Azure Portal](https://docs.microsoft.com/azure/web-application-firewall/ag/application-gateway-web-application-firewall-portal)\r\nüí°[Tutorial: Create and Manage a VPN Gateway using Azure Portal]( https://docs.microsoft.com/azure/vpn-gateway/tutorial-create-gateway-portal)\r\nüí°[What is Azure ExpressRoute?]( https://docs.microsoft.com/azure/expressroute/expressroute-introduction)\r\n\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.AC\r\n\t‚Ä¢ PR.IP\r\n\t‚Ä¢ DE.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationName contains \"network\" or RecommendationName contains \"firewall\" or RecommendationName contains \"ports\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†RecommendationName\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Security Center Recommendations: Network Traffic",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 5184000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureDiagnostics\r\n| where OperationName == \"NetworkSecurityGroupEvents\"\r\n| summarize count() by ruleName_s\r\n| sort by count_ desc \r\n| render piechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Network Security Groups: Rules Triggered",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 5184000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureDiagnostics\r\n| where Category contains \"AzureFirewall\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†OperationName\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Firewall + Azure WAF Actions",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 5184000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage VPN Gateway for Secure Access to Workloads\r\n![Image Name]( https://docs.microsoft.com/azure/vpn-gateway/media/design/vpngateway-site-to-site-connection-diagram.png)\r\n\r\n‚ú≥Ô∏è [Get Started with VPN Gateway]( https://azure.microsoft.com/services/vpn-gateway/) \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 4",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Use Azure ExpressRoute to Extend On-premises Networks into the Microsoft Cloud Over Private Connections\r\n![Image Name]( https://docs.microsoft.com/azure/expressroute/media/expressroute-introduction/expressroute-connection-overview.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure ExpressRoute]( https://azure.microsoft.com/services/expressroute)\r\n\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 4 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isNetworkingVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Access Control_N",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ IP Denylisting\r\n\r\n### TIC 3.0 Guidance\r\nIP denylisting protections prevent the ingest or transiting of traffic received from or destined to a denylisted IP address.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Sentinel Threat Intelligence to Ingest Indicators for IP Denylisting\r\n\t‚Ä¢ Use Azure Firewall Threat Intelligence to Denylist IPs\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ ThreatIntelligenceIndicator (Azure Sentinel) ‚ú≥Ô∏è [Get Started with Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)\r\nüî∑ AzureDiagnostics (Azure Firewall) ‚ú≥Ô∏è [Get Started with Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)\r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Sentinel > Threat Intelligence\r\n\t‚Ä¢ Firewall Manager > Azure Firewall Policies > Create Azure Firewall Policy > Threat Intelligence\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel) \r\nüîÑ [Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Connect Data from Threat Intelligence Providers](https://docs.microsoft.com/azure/sentinel/connect-threat-intelligence)\r\nüí°¬†[Azure Firewall Threat Intelligence Configuration](https://docs.microsoft.com/azure/firewall-Manager/threat-intelligence-settings)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ DE.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "\tAzureDiagnostics\r\n\t| where Category == \"AzureFirewallNetworkRule\"\r\n\t| where OperationName == \"AzureFirewallThreatIntelLog\"\r\n\t| where Resource in~ (split(\"FW-PREM, SOC-NS-FW\", \", \"))\r\n\t| parse msg_s with Protocol \" request from\" SourceIP \":\" SourcePortInt: int \" to\" TargetIP \":\" TargetPortInt: int *\r\n\t| where msg_s contains \"*\" or '*' == \"*\"\r\n\t| parse msg_s with * \". Action: \" Action1a\r\n\t| parse msg_s with * \" was \" Action1b \" to \" NatDestination\r\n\t| parse msg_s with Protocol2 \" request from\" SourceIP2 \" to\" TargetIP2 \". Action:\" Action2\r\n\t| parse msg_s with Protocol_s 'request from ' SourceHost_s ':' SourcePort_s 'to ' DestinationHost_s ':' DestinationPort_s 'was' Action_s 'to' DNATDestination\r\n\t| parse msg_s with Protocol_S 'request from ' SourceHost_S ':' SourcePort_S 'to ' DestinationHost_S ':' DestinationPort_S '. Action:' Action_S\r\n\t| extend Protocol = strcat(Protocol_s, Protocol_S), SourceHost = strcat(SourceHost_s, SourceHost_S), SourcePort = strcat(SourcePort_s, SourcePort_S), DestinationHost = strcat(DestinationHost_s, DestinationHost_S), DestinationPort = strcat(DestinationPort_s, DestinationPort_S), Action = strcat(Action_s, Action_S)\r\n\t| extend SourcePort = tostring(SourcePortInt), TargetPort = tostring(TargetPortInt)\r\n\t| extend Action = case(Action1a == \"\", case(Action1b == \"\", Action2, Action1b), Action1a), Protocol = case(Protocol == \"\", Protocol2, Protocol), SourceIP = case(SourceIP == \"\", SourceIP2, SourceIP), TargetIP = case(TargetIP == \"\", TargetIP2, TargetIP), SourcePort = case(SourcePort == \"\", \"N/A\", SourcePort), TargetPort = case(TargetPort == \"\", \"N/A\", TargetPort), NatDestination = case(NatDestination == \"\", \"N/A\", NatDestination)\r\n\t| summarize by TimeGenerated, Protocol, Action, SourcePort, TargetPort, SourceHost, DestinationHost, DestinationPort, NatDestination, ResourceId, ResourceGroup, SubscriptionId\r\n\t| where Action contains \"Deny\"\r\n\t| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by Action\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Firewall: Threat Intelligence IP Blocks",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 5184000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Azure Firewall: IP Denylisting via Threat Intelligence\r\n![Image¬†Name](https://docs.microsoft.com/azure/firewall/media/threat-intel/firewall-threat.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "ThreatIntelligenceIndicator\r\n| extend IndicatorType = iif(isnotempty(EmailSourceIpAddress) or isnotempty(NetworkDestinationIP) or isnotempty(NetworkIP) or isnotempty(NetworkSourceIP) or isnotempty(NetworkCidrBlock), \"IP\",\r\n\t    iff(isnotempty(Url), \"URL\",\r\n\t    iff(isnotempty(EmailRecipient) or isnotempty(EmailSenderAddress), \"Email\",\r\n\t    iff(isnotempty(FileHashValue), \"File\",\r\n\t    iff(isnotempty(DomainName) or isnotempty(EmailSourceDomain), \"Domain\",\r\n\t    \"Other\")))))\r\n| where IndicatorType == \"IP\"\r\n| make-series count() default=0 on TimeGenerated from ago(30d) to now() step 1d by IndicatorType\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Sentinel: Threat Intelligence IP Indicators Ingested",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 5184000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isNetworkingVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "IP Denylisting",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Host Containment\r\n\r\n### TIC 3.0 Guidance\r\nHost containment protections enable a network to revoke or quarantine a host‚Äôs access to the network.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Security Center & Azure Logic Apps for Automated Host Containment\r\n\t‚Ä¢ Use Microsoft Defender for Endpoint for Endpoint Isolation & Response\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ AzureActivity¬†(Azure Logic Apps) ‚ú≥Ô∏è [Get Started with Azure Logic Apps](https://azure.microsoft.com/services/logic-apps/) \r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Security Center > Security Alerts > Select Alert > Take Action > Trigger Automated Response\r\n\tÔøΩÔøΩ Microsoft 365 Security Center > Alerts > Select Alert > Isolate Endpoint\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) \r\nüîÑ [Microsoft 365 Security Center](https://security.microsoft.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[How to Isolate an Azure VM Using Azure Security Center‚Äôs Workflow Automation](https://techcommunity.microsoft.com/t5/azure-security-center/how-to-isolate-an-azure-vm-using-azure-security-center-s/ba-p/1250985)\r\nüí°¬†[Isolate Endpoints from the Network](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/respond-machine-alerts#isolate-endpoints-from-the-network)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.AC\r\n\t‚Ä¢ PR.IP\r\n\t‚Ä¢ PR.PT"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureActivity\r\n| where ResourceProvider == \"Microsoft.Logic\"\r\n| where Resource contains \"isolate\"\r\n| summarize count() by Resource\r\n| render piechart",
              "size": 0,
              "showAnalytics": true,
              "title": "Containment Logic Apps Triggered",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 5184000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Automatically Isolate Azure VMs with Azure Security Center & Azure Logic Apps\r\n![Image¬†Name](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/179279i7B186CEEB0EF7660/image-size/large)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/security-center/) \r\n‚ú≥Ô∏è [Get Started with Azure Logic Apps](https://azure.microsoft.com/services/logic-apps/) \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Use Microsoft Defender for Endpoint for Endpoint Isolation & Response\r\n![Image¬†Name](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/images/isolate-device.png)\r\n\r\n‚ú≥Ô∏è [Get Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isNetworkingVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Host Containment",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Network Segmentation\r\n\r\n### TIC 3.0 Guidance\r\nNetwork segmentation separates a given network into subnetworks, facilitating security controls between the subnetworks, and decreasing the attack surface of the network.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Implement Network Segmentation with Azure Virtual Networks \r\n\r\n### Navigate \r\n\t‚Ä¢ Virtual Networks > Create\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Implement Network Segmentation Patterns on Azure](https://docs.microsoft.com/azure/architecture/framework/security/design-network-segmentation)\r\nüí°¬†[What is Azure Virtual Network?](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.AC"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Implement Network Segmentation with Azure Virtual Networks\r\n![Image¬†Name](https://docs.microsoft.com/azure/architecture/framework/security/images/hub-and-spoke.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Virtual Network]( https://azure.microsoft.com/services/virtual-network/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isNetworkingVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Network Segmentation",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Microsegmentation\r\n\r\n### TIC 3.0 Guidance\r\nMicrosegmentation divides the network, either physically or virtually, according to the communication needs of application and data workflows, facilitating security controls to protect the data.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Implement Microsegmentation with Azure Virtual Networks, Azure Application Security Groups, Network Security Groups, Azure Firewall, and Azure Web Application Firewall\r\n\r\n### Navigate \r\n\t‚Ä¢ Virtual Networks > Create\r\n    ‚Ä¢ Application Security Groups > Create\r\n\t‚Ä¢ Network Security Groups > Add\r\n    ‚Ä¢ Firewalls > Add\r\n\t‚Ä¢ Web Application Firewall Policies (WAF) > Create\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Virtual Networks](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks) \r\nüîÑ [Application Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FvirtualNetworks) \r\nüîÑ [Network Security Groups](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FNetworkSecurityGroups) \r\nüîÑ [Firewalls](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FazureFirewalls) \r\nüîÑ [Web Application Firewall Policies](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers)\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Network Security & Containment](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview)\r\nüí°¬†[What is Azure Virtual Network?](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview)\r\nüí°¬†[Tutorial: Deploy and Configure Azure Firewall using the Azure Portal](https://docs.microsoft.com/azure/firewall/tutorial-firewall-deploy-portal)\r\nüí°¬†[Application Security Groups](https://docs.microsoft.com/azure/virtual-network/application-security-groups)\r\nüí°¬†[Tutorial: Filter Network Traffic with a Network Security Group using the Azure portal](https://docs.microsoft.com/azure/virtual-network/tutorial-filter-network-traffic)\r\nüí°¬†[What is Azure Web Application Firewall?](https://docs.microsoft.com/azure/web-application-firewall/overview)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.AC\r\n\t‚Ä¢ PR.DS\r\n\t‚Ä¢ PR.IP\r\n\t‚Ä¢ PR.PT"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Implement Microsegmentation with Azure Virtual Networks, Azure Application Security Groups, Network Security Groups, Azure Firewall, and Azure Web Application Firewall\r\n![Image¬†Name](https://docs.microsoft.com/azure/architecture/framework/security/images/ref-entp-design-az-network-security.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Virtual Network]( https://azure.microsoft.com/services/virtual-network/) \r\n‚ú≥Ô∏è [Get Started with Application Gateway](https://azure.microsoft.com/services/application-gateway/) \r\n‚ú≥Ô∏è [Get Started with Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)\r\n‚ú≥Ô∏è [Get Started with Azure Web Application Firewall](https://azure.microsoft.com/services/web-application-firewall/)\r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isNetworkingVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isNetworkingVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Microsegmentation",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##¬†Resiliency\r\nResiliency measures including DDoS protections, elastic expansion, and regional delivery.\r\n\r\n|¬†<em> TIC 3.0 vs Zero Trust </em> |\r\n|¬†:¬†|¬†: | : | : |\r\n|¬†<strong> Capabilities¬†</strong> | <strong> Microsoft Controls¬†</strong> |¬†<strong> Zero Trust Principles </strong>  | <strong> Zero Trust Pillars </strong>  |\r\n|¬†DDoS Protections¬†|¬†‚ú≥Ô∏è [Azure DDoS Protection]( https://azure.microsoft.com/services/ddos-protection/)  |  Assume Breach | Data, Apps, Infrastructure, Network | \r\n|¬†Elastic Expansion¬†|¬†‚ú≥Ô∏è [Azure Virtual Machine Scale Sets]( https://azure.microsoft.com/services/virtual-machine-scale-sets/) ‚ú≥Ô∏è [Azure SQL Database]( https://azure.microsoft.com/services/sql-database/) ‚ú≥Ô∏è [Load Balancer]( https://azure.microsoft.com/services/load-balancer/) ‚ú≥Ô∏è [Traffic Manager]( https://azure.microsoft.com/services/traffic-manager/)  | Assume Breach | Infrastructure | \r\n|¬†Regional Delivery¬†| ‚ú≥Ô∏è [Azure Availability Zones]( https://azure.microsoft.com/global-infrastructure/availability-zones/)  | Assume Breach | Infrastructure | \r\nFor more information, see the CISA: Trusted Internet Connections üí°[Core Guidance Documents](https://www.cisa.gov/trusted-internet-connections) and Microsoft's üí°[Why Zero Trust](https://www.microsoft.com/security/business/zero-trust)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "isResiliencyVisible",
          "comparison": "isEqualTo",
          "value": "true"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Resiliency Capabilities Guide",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "e728810c-697f-4b67-a00e-1941c3b84194",
            "cellValue": "DDoS Protections",
            "linkTarget": "step",
            "linkLabel": "DDoS Protections",
            "style": "link"
          },
          {
            "id": "38a64817-5a62-418f-8944-041ab50fee2c",
            "cellValue": "Elastic Expansion",
            "linkTarget": "step",
            "linkLabel": "Elastic Expansion",
            "style": "link"
          },
          {
            "id": "b984f173-f46a-412d-a835-d4a2f66709b8",
            "cellValue": "Regional Delivery",
            "linkTarget": "step",
            "linkLabel": "Regional Delivery",
            "style": "link"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isResiliencyVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Resiliency Capabilities Selector"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ DDoS Protections\r\n\r\n### TIC 3.0 Guidance\r\nDDoS protections mitigate the effects of distributed denial of service attacks.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure DDoS Standard for DDoS Defense\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityAlert¬†(Azure DDoS Standard) ‚ú≥Ô∏è [Get Started with Azure DDoS Protection](https://azure.microsoft.com/services/ddos-protection) \r\n\r\n### Navigate \r\n\t‚Ä¢ DDoS Protection Plans > Create\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [DDoS Protection Plans](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FddosProtectionPlans) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Azure DDoS Protection Standard Overview](https://docs.microsoft.com/azure/ddos-protection/ddos-protection-overview)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isResiliencyVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where AlertName contains \"DoS\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AlertName\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure DDoS Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isResiliencyVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Azure DDoS Standard Protection\r\n![Image¬†Name](https://docs.microsoft.com/azure/ddos-protection/media/ddos-best-practices/image-5.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure DDoS Protection](https://azure.microsoft.com/services/ddos-protection) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isResiliencyVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isResiliencyVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "DDoS Protections",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "#### Requirement\r\nüî∑ Elastic Expansion\r\n\r\n### TIC 3.0 Guidance\r\nElastic expansion enables agencies to dynamically expand the resources available for services as conditions require.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Create Virtual Machine Scale Sets for Elastic Expansion\r\n\t‚Ä¢ Leverage Azure SQL Database: Elastic Pools for Elastic Expansion of Databases\r\n\t‚Ä¢ Leverage Azure Load Balancer to Distribute Incoming Traffic Across Resources\r\n\t‚Ä¢ Leverage Azure Traffic Manager to Distribute Application Traffic Across Regions\r\n\t\r\n### Navigate \r\n\t‚Ä¢ Virtual Machine Scale Sets > Add\r\n\t‚Ä¢ Azure SQL > Create\r\n\t‚Ä¢ Load Balancers > Add\r\n\t‚Ä¢ Traffic Manager Profiles > Create\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Virtual Machine Scale Sets](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Compute%2FvirtualMachineScaleSets) üîÑ [Azure SQL](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Sql%2Fazuresql) üîÑ [Load Balancer](https://portal.azure.com/#blade/Microsoft_Azure_Network/LoadBalancingHubMenuBlade/loadBalancers) üîÑ [Traffic Manager Profiles](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2Ftrafficmanagerprofiles)\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[What are Virtual Machine Scale Sets?](https://docs.microsoft.com/azure/virtual-machine-scale-sets/overview)¬†\r\nüí°¬†[Elastic Pools Help You Manage and Scale Multiple Databases in Azure SQL Database](https://www.cisa.gov/trusted-internet-connections)\r\nüí°¬†[What is Azure Load Balancer?](https://docs.microsoft.com/azure/load-balancer/load-balancer-overview)\r\nüí°¬†[What is Traffic Manager?](https://docs.microsoft.com/azure/traffic-Manager/traffic-Manager-overview)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.AM\r\n\t‚Ä¢ PR.DS"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isResiliencyVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Create Virtual Machine Scale Sets for Elastic Expansion\r\n![Image¬†Name](https://docs.microsoft.com/azure/virtual-machine-scale-sets/media/virtual-machine-scale-sets-instance-ids/vmssinstances.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Virtual Machine Scale Sets](https://azure.microsoft.com/services/virtual-machine-scale-sets/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isResiliencyVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure SQL Database: Elastic Pools for Elastic Expansion of Databases\r\n![Image¬†Name](https://docs.microsoft.com/azure/azure-sql/database/media/elastic-pool-overview/create-elastic-pool.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Azure SQL Database](https://azure.microsoft.com/services/sql-database/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isResiliencyVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Traffic Manager to Distribute Application Traffic Across Regions\r\n![Image¬†Name](https://docs.microsoft.com/azure/traffic-Manager/media/traffic-Manager-routing-methods/priority.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Traffic Manager](https://azure.microsoft.com/services/traffic-Manager/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isResiliencyVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Load Balancer to Distribute Incoming Traffic Across Resources\r\n![Image¬†Name](https://docs.microsoft.com/azure/load-balancer/media/cross-region-overview/cross-region-load-balancer.png)\r\n\r\n‚ú≥Ô∏è [Get Started with Load Balancer](https://azure.microsoft.com/services/load-balancer/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isResiliencyVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isResiliencyVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Elastic Expansion",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Regional Delivery\r\n\r\n### TIC 3.0 Guidance\r\nRegional delivery technologies enable the deployment of agency services across geographically diverse locations.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Availability Zones for Redundancy\r\n\r\n### Navigate \r\n\t‚Ä¢ Availability Sets > Create\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Availability Sets](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FavailabilitySets) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Building Solutions for High Availability Using Availability Zones](https://docs.microsoft.com/azure/architecture/high-availability/building-solutions-for-high-availability)¬†\r\nüí°¬†[Azure Infrastructure Availability](https://docs.microsoft.com/azure/security/fundamentals/infrastructure-availability)¬†\r\n\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.AM\r\n\t‚Ä¢ PR.AC\r\n\t‚Ä¢ PR.DS"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isResiliencyVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Availability Zones for Security Control Redundancy\r\n![Image¬†Name](https://docs.microsoft.com/azure/architecture/high-availability/images/high-availability-001.png¬†¬†\"Azure infrastructure availability\")¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Availability Zones](https://azure.microsoft.com/global-infrastructure/availability-zones/) \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isResiliencyVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isResiliencyVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Regional Delivery",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##¬†DNS\r\nDNS measures including DNS blackholing, DNSSEC for clients, and DNSSEC for domains. \r\n\r\n|¬†<em> TIC 3.0 vs Zero Trust </em> |\r\n|¬†:¬†|¬†: | : | : |\r\n|¬†<strong> Capabilities¬†</strong> | <strong> Microsoft Controls¬†</strong> |¬†<strong> Zero Trust Principles </strong>  | <strong> Zero Trust Pillars </strong>  |\r\n|¬†DNS Sinkholing¬†|¬†‚ú≥Ô∏è [Azure Active Directory Domain Services]( https://azure.microsoft.com/services/active-directory-ds/) ‚ú≥Ô∏è [Azure DNS]( https://azure.microsoft.com/services/dns/) | Verify Explicitly | Network |\r\n|¬†DNSSEC for Agency Clients¬†|¬†‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/) ‚ú≥Ô∏è [Windows Server](https://www.microsoft.com/p/windows-server-2019-standard-cal/dg7gmgf0dvss)  | Verify Explicitly | Network |\r\n|¬†DNSSEC for Agency Domains¬†|¬†‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/) | Verify Explicitly | Network |\r\nFor more information, see the CISA: Trusted Internet Connections üí°[Core Guidance Documents](https://www.cisa.gov/trusted-internet-connections) and Microsoft's üí°[Why Zero Trust](https://www.microsoft.com/security/business/zero-trust)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "isDNSVisible",
          "comparison": "isEqualTo",
          "value": "true"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "DNS Capability Guide",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##¬†Not Included¬†in¬†Workbook\r\n|¬†<em> DNS PEP Security Capabilities¬†</em> |\r\n|¬†:¬†|¬†: | \r\n|¬†<strong> Capability¬†</strong> | <strong> Requirement </strong>¬†|¬† \r\n|¬†NCPS E3A DNS Protections¬†|¬†NCPS E3A is an intrusion prevention capability, provided by DHS, that includes a DNS Sinkholing security service. | \r\nFor more information, see the CISA: Trusted Internet Connections üí°[Core Guidance Documents](https://www.cisa.gov/trusted-internet-connections)",
        "style": "error"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "isDNSVisible",
          "comparison": "isEqualTo",
          "value": "true"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "DNS Capability Not Included in Workbook",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "9641ace6-28a6-492a-a264-cf997a0b2929",
            "cellValue": "DNS Sinkholing",
            "linkTarget": "step",
            "linkLabel": "DNS Sinkholing",
            "style": "link"
          },
          {
            "id": "58350f74-c87b-4110-aa84-2d34f0b7b76d",
            "cellValue": "DNSSEC for Agency Clients",
            "linkTarget": "step",
            "linkLabel": "DNSSEC for Agency Clients",
            "style": "link"
          },
          {
            "id": "69514c8d-8a19-48db-a53d-02c1e12cf332",
            "cellValue": "DNSSEC for Agency Domains",
            "linkTarget": "step",
            "linkLabel": "DNSSEC for Agency Domains",
            "style": "link"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isDNSVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "DNS Capability Selector"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ DNS Sinkholing\r\n\r\n### TIC 3.0 Guidance\r\nDNS sinkholing protections are a form of denylisting that protect clients from accessing malicious domains by responding to DNS queries for those domains.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Manage DNS Records with Azure DNS\r\n\t‚Ä¢ Configure DNS Sinkholes with Azure Active Directory Domain Services\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ DnsEvents¬†(Azure DNS) ‚ú≥Ô∏è [Get Started with Azure DNS](https://azure.microsoft.com/services/dns/) \r\n\r\n### Navigate \r\n\t‚Ä¢ DNS Zones > Create\r\n\t‚Ä¢ Azure AD Domain Services > Create\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [DNS Zones](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Network%2FdnsZones) üîÑ [Windows Admin Center](https://www.microsoft.com/evalcenter/evaluate-windows-admin-center)\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[What is Azure DNS?](https://docs.microsoft.com/azure/dns/dns-overview)\r\nüí°¬†[Administer DNS and Create Conditional Forwarders in an Azure Active Directory Domain Services Managed Domain](https://docs.microsoft.com/azure/active-directory-domain-services/manage-dns)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDNSVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "DnsEvents\r\n| extend IPAddresses = iif(IPAddresses == \"\", \"empty\", IPAddresses)\r\n| where \"All\" == \"All\" or IPAddresses in ('All')\r\n| where SubType == 'LookupQuery' and isnotempty(MaliciousIP)\r\n| summarize Attempts = count() by Computer, RemoteIPCountry, IndicatorThreatType\r\n| order by Attempts desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Malicious DNS Events",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDNSVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Configure DNS Sinkholes with Azure Active Directory Domain Services\r\n![Image¬†Name](https://docs.microsoft.com/azure/active-directory-domain-services/media/manage-dns/dns-Manager.png)¬†\r\n\r\n ‚ú≥Ô∏è [Get Started with Azure Active Directory Domain Services](https://azure.microsoft.com/services/active-directory-ds/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDNSVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Manage DNS Records with Azure DNS\r\n![Image¬†Name](https://docs.microsoft.com/azure/networking/media/disaster-recovery-dns-traffic-Manager/create-dns-zone-records.png)¬†\r\n\r\n ‚ú≥Ô∏è [Get Started with Azure DNS](https://azure.microsoft.com/services/dns/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDNSVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isDNSVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "DNS Sinkholing",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ DNSSEC for Agency Clients\r\n\r\n### TIC 3.0 Guidance\r\nDNSSEC protections ensure that domain name lookups from agency clients, whether for internal or external domains, are validated.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Configure Azure Firewall as a Reverse DNS Proxy\r\n\t‚Ä¢ Leverage Windows Server: DNS Role to Configure DNS-based Authentications of Named Entities (DANE) for DNS client verifications\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ AzureDiagnostics¬†(Azure Firewall) ‚ú≥Ô∏è [Get Started with Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/) \r\n### Navigate \r\n\t‚Ä¢ Select Workload Virtual Machine > Settings > Networking > Network Interface > Settings > DNS Servers > Custom > Enter Internal IP of Azure Firewall\r\n\t‚Ä¢ Windows Server > Server Manager > Add Roles & Features > Role-based or Feature-based Installation > Select Server > Server Roles: Select \"DNS Server\" > Add Features > Install\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Virtual Machines](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Compute%2FVirtualMachines) \r\nüîÑ [Firewall Manager](https://portal.azure.com/#blade/Microsoft_Azure_HybridNetworking/FirewallManagerMenuBlade/firewallManagerOverview) \r\nüîÑ [Windows Admin Center](https://www.microsoft.com/evalcenter/evaluate-windows-admin-center)\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Enabling Central Visibility For DNS Using Azure Firewall Custom DNS and DNS Proxy](https://techcommunity.microsoft.com/t5/azure-network-security/enabling-central-visibility-for-dns-using-azure-firewall-custom/ba-p/2156331)\r\nüí°¬†[DANE Support](https://docs.microsoft.com/windows-server/networking/dns/what-s-new-in-dns-server#dane-support)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDNSVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureDiagnostics\r\n| where Category == \"AzureFirewallDnsProxy\"\r\n| parse msg_s with \"DNS Request: \" ClientIP \":\" ClientPort \" - \" QueryID \" \" Request_Type \" \" Request_Class \" \" Request_Name \". \" Request_Protocol \" \" Request_Size \" \" EDNSO_DO \" \" EDNS0_Buffersize \" \" Responce_Code \" \" Responce_Flags \" \" Responce_Size \" \" Response_Duration\r\n| project-away msg_s\r\n| summarize by TimeGenerated, ResourceId, ClientIP, ClientPort, QueryID, Request_Type, Request_Class, Request_Name, Request_Protocol, Request_Size, EDNSO_DO, EDNS0_Buffersize, Responce_Code, Responce_Flags, Responce_Size, Response_Duration, SubscriptionId\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†Request_Type\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Firewall: DNS Proxy",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDNSVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 2",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Azure Firewall Reverse DNS Proxy Architecture\r\n![Image¬†Name](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/256538iF0388DA036B66A83/image-size/large)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/) "
            },
            "customWidth": "50",
            "name": "text - 3 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Windows Server for DNS-based Authentications of Named Entities (DANE) for DNS client verifications\r\nYou can use DANE support (RFC 6394 and 6698) to specify to your DNS clients what CA they should expect certificates to be issued from for domains names hosted in your DNS server. This prevents a form of man-in-the-middle attack where someone is able to corrupt a DNS cache and point a DNS name to their own IP address.\r\n\t\r\nFor instance, imagine you host a secure website that uses SSL at www.contoso.com by using a certificate from a well-known authority named CA1. Someone might still be able to get a certificate for www.contoso.com from a different, not-so-well-known, certificate authority named CA2. Then, the entity hosting the fake www.contoso.com website might be able to corrupt the DNS cache of a client or server to point www.contoto.com to their fake site. The end user will be presented a certificate from CA2, and may simply acknowledge it and connect to the fake site. With DANE, the client would make a request to the DNS server for contoso.com asking for the TLSA record and learn that the certificate for www.contoso.com was issues by CA1. If presented with a certificate from another CA, the connection is aborted.\r\n\t\r\nFor more information, see üí°¬†[DANE Support](https://docs.microsoft.com/windows-server/networking/dns/what-s-new-in-dns-server#dane-support)"
            },
            "customWidth": "50",
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isDNSVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "DNSSEC for Agency Clients",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ DNSSEC for Agency Domains\r\n\r\n### TIC 3.0 Guidance\r\nDNSSEC protections ensure that all agency domain names are secured using DNSSEC, enabling external entities to validate their resolution the domain names\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Security Center for DNSSEC Recommendations\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityRegulatoryCompliance¬†(Azure Security Center) ‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/security-center/) \r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Security Center > Recommendations\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) \r\nüîÑ [Microsoft 365 Admin Center](https://admin.microsoft.com/) \r\nüîÑ [Windows Admin Center](https://www.microsoft.com/evalcenter/evaluate-windows-admin-center)\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Security Recommendations in Azure Security Center](https://docs.microsoft.com/azure/security-center/security-center-recommendations)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDNSVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRegulatoryCompliance\r\n| where RecommendationName contains \"dnssec\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†RecommendationName\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Security Center: DNSSEC Recommendations",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDNSVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isDNSVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "DNSSEC for Agency Domains",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##¬†Intrusion Detection\r\nIntrusion Detection measures including endpoint detection & response, intrusion protection systems, adaptive access control, deception platforms, and certificate transparency log monitoring.\r\n\r\n|¬†<em> TIC 3.0 vs Zero Trust </em> |\r\n|¬†:¬†|¬†: | : | : |\r\n|¬†<strong> Capabilities¬†</strong> | <strong> Microsoft Controls¬†</strong> |¬†<strong> Zero Trust Principles </strong>  | <strong> Zero Trust Pillars </strong>  |\r\n|¬†Endpoint Detection and Response¬†|¬†‚ú≥Ô∏è [Microsoft Defender for Endpoint]( https://www.microsoft.com/microsoft-365/security/endpoint-defender)  | Assume Breach | Endpoints, Infrastructure | \r\n|¬†Intrusion Protection Systems (IPS)¬†|¬†‚ú≥Ô∏è [Azure Firewall]( https://azure.microsoft.com/services/azure-firewall/)  | Assume Breach | Network | \r\n|¬†Adaptive Access Control¬†|¬†‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) | Verify Explicitly, Use Least Privileged Access | Identities | \r\n|¬†Deception Platforms¬†|¬†‚ú≥Ô∏è [Microsoft Defender for Identity]( https://www.microsoft.com/microsoft-365/security/identity-defender)  | Identities | Assume Breach | \r\n|¬†Certificate Transparency Log Monitoring¬†|¬†‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)  | Verify Explicitly | Infrastructure, Apps |  \r\nFor more information, see the CISA: Trusted Internet Connections üí°[Core Guidance Documents](https://www.cisa.gov/trusted-internet-connections) and Microsoft's üí°[Why Zero Trust](https://www.microsoft.com/security/business/zero-trust)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "isIntrusionDetectionVisible",
          "comparison": "isEqualTo",
          "value": "true"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Intrusion Detection Capability Guide",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "732ea879-9952-465c-b6a5-f85cef33927f",
            "cellValue": "Endpoint Detection and Response",
            "linkTarget": "step",
            "linkLabel": "Endpoint Detection and Response",
            "style": "link"
          },
          {
            "id": "d09eb27c-cab6-4ae8-978f-5bcc50a361f5",
            "cellValue": "Intrusion Protection Systems (IPS)",
            "linkTarget": "step",
            "linkLabel": "Intrusion Protection Systems (IPS)",
            "style": "link"
          },
          {
            "id": "e22ab1a8-ded0-43e0-b8df-68d75ca8d073",
            "cellValue": "Adaptive Access Control",
            "linkTarget": "step",
            "linkLabel": "Adaptive Access Control",
            "style": "link"
          },
          {
            "id": "5a55295b-0d64-4e5f-a84e-25a7bad66f5f",
            "cellValue": "Deception Platforms",
            "linkTarget": "step",
            "linkLabel": "Deception Platforms",
            "style": "link"
          },
          {
            "id": "2674ad60-398d-42aa-a24d-7cbe20aa79a7",
            "cellValue": "Certificate Transparency Log Monitoring",
            "linkTarget": "step",
            "linkLabel": "Certificate Transparency Log Monitoring",
            "style": "link"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isIntrusionDetectionVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Intrusion Detection Capability Selector"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Endpoint Detection and Response\r\n\r\n### TIC 3.0 Guidance\r\nEndpoint detection and response tools combine endpoint and network event data to aid in the detection of malicious activity.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Microsoft Defender for Endpoint for Endpoint Detection & Response (EDR) Capabilities\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityAlert (Microsoft Defender for Endpoint) ‚ú≥Ô∏è [Get Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender)\r\n\r\n### Navigate \r\n\t‚Ä¢ Microsoft 365 Security Center > Threat & Vulnerability Management\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Microsoft 365 Security Center](https://security.microsoft.com/)\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Overview of Endpoint Detection and Response](https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/overview-endpoint-detection-response)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ DE.AE\r\n\t‚Ä¢ DE.CM\r\n    ‚Ä¢ RS.AN"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isIntrusionDetectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where ProviderName == \"MDATP\"\r\n| summarize count() by AlertName\r\n| render piechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Microsoft Defender for Endpoint Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isIntrusionDetectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isIntrusionDetectionVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Endpoint Detection and Response",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Intrusion Protection Systems (IPS)\r\n\r\n### TIC 3.0 Guidance\r\nIntrusion protection systems detect malicious activity, attempt to stop the activity, and report the activity.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Firewall Premium for IPS\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ AzureDiagnostics¬†(Azure Firewall)  ‚ú≥Ô∏è [Get Started with Azure Firewall](https://azure.microsoft.com/services/azure-firewall/) \r\n\r\n### Navigate \r\n    ‚Ä¢ Firewalls > Add\r\n\t‚Ä¢ Firewall Policies > IDPS\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Firewalls](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FazureFirewalls) \r\nüîÑ [Firewall Policies](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FfirewallPolicies) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Azure Firewall Premium: IDPS](https://docs.microsoft.com/azure/firewall/premium-features#idps)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ DE.AE\r\n\t‚Ä¢ DE.CM\r\n\t‚Ä¢ DE.DP\r\n\t‚Ä¢ RS.AN"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isIntrusionDetectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureDiagnostics\r\n| where Category == \"AzureFirewallNetworkRule\"\r\n| where OperationName == \"AzureFirewallIDSLog\"\r\n| parse msg_s with * \"TCP request from \" Source \" to \" Destination \". Action: \" ActionTaken \". Rule: \" IDPSSig \". IDS: \" IDSMessage \". Priority: \" Priority \". Classification: \" Classification\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†OperationName\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Firewall: IDPS Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isIntrusionDetectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Firewall Premium for IPS\r\n![Image¬†Name](https://docs.microsoft.com/azure/firewall/media/premium-features/premium-overview.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Firewall](https://azure.microsoft.com/services/azure-firewall/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isIntrusionDetectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isIntrusionDetectionVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Intrusion Protection Systems (IPS)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "#### Requirement\r\nüî∑ Adaptive Access Control\r\n\r\n### TIC 3.0 Guidance\r\nAdaptive access control technologies factor in additional context, like security risk, operational needs, and other heuristics, when evaluating access control decisions.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Active Directory for Adaptive Access Control\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SigninLogs¬†(Azure Active Directory) ‚ú≥Ô∏è [Get Started with Azure Active Directory: Premium Trial](https://azure.microsoft.com/trial/get-started-active-directory/) \r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Active Directory > Security > Conditional Access > + New Policy\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[What is Conditional Access?](https://docs.microsoft.com/azure/active-directory/conditional-access/overview)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.AC\r\n    ‚Ä¢ DE.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isIntrusionDetectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let data = SigninLogs\r\n    | where AppDisplayName in ('*') or '*' in ('*')\r\n    | where UserDisplayName in ('*') or '*' in ('*')\r\n    | extend CAStatus = case(ConditionalAccessStatus == \"success\", \"Successful\",\r\n        ConditionalAccessStatus == \"failure\", \"Failed\",                                     \r\n        ConditionalAccessStatus == \"notApplied\", \"Not applied\",                                     \r\n        isempty(ConditionalAccessStatus), \"Not applied\", \r\n        \"Disabled\")\r\n    | mvexpand ConditionalAccessPolicies\r\n    | extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0])\r\n    | extend CAGrantControl = case(CAGrantControlName contains \"MFA\", \"Require MFA\", \r\n        CAGrantControlName contains \"Terms of Use\", \"Require Terms of Use\", \r\n        CAGrantControlName contains \"Privacy\", \"Require Privacy Statement\", \r\n        CAGrantControlName contains \"endpoint\", \"Require endpoint Compliant\", \r\n        CAGrantControlName contains \"Azure AD Joined\", \"Require Hybird Azure AD Joined endpoint\", \r\n        CAGrantControlName contains \"Apps\", \"Require Approved Apps\",\r\n        \"Other\");\r\ndata\r\n| summarize Count = dcount(Id) by CAStatus\r\n| join kind = inner (data\r\n    | make-series Trend = dcount(Id) default = 0 on TimeGenerated in range(ago(14d), now(), 6h) by CAStatus\r\n    )\r\n    on CAStatus\r\n| project-away CAStatus1, TimeGenerated\r\n| order by Count desc",
              "size": 0,
              "showAnalytics": true,
              "title": "Conditional Access Status",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "CAStatus",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "Count",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "maximumFractionDigits": 2,
                      "maximumSignificantDigits": 3
                    }
                  }
                },
                "secondaryContent": {
                  "columnMatch": "Trend",
                  "formatter": 9,
                  "formatOptions": {
                    "palette": "blue"
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isIntrusionDetectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage AAD Conditional Access for Adaptive Access Control\r\n![Image¬†Name](https://docs.microsoft.com/azure/active-directory/conditional-access/media/overview/conditional-access-overview-how-it-works.png)¬†\r\n\r\n‚ú≥Ô∏è [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/trial/get-started-active-directory/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isIntrusionDetectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let details = dynamic({\"Name\": \"\", \"Type\": \"*\"});\r\nlet data = SigninLogs\r\n    | extend AppDisplayName = iff(AppDisplayName == '', 'Unknown', AppDisplayName)\r\n    | where AppDisplayName in ('*') or '*' in ('*')\r\n    | where UserDisplayName in ('*') or '*' in ('*')\r\n    | extend Country = tostring(LocationDetails.countryOrRegion)\r\n    | extend City = tostring(LocationDetails.city)\r\n    | extend errorCode = Status.errorCode\r\n    | extend SigninStatus = case(errorCode == 0, \"Success\", errorCode == 50058, \"Pending user action\", errorCode == 50140, \"Pending user action\", errorCode == 51006, \"Pending user action\", errorCode == 50059, \"Pending user action\", errorCode == 65001, \"Pending user action\", errorCode == 52004, \"Pending user action\", errorCode == 50055, \"Pending user action\", errorCode == 50144, \"Pending user action\", errorCode == 50072, \"Pending user action\", errorCode == 50074, \"Pending user action\", errorCode == 16000, \"Pending user action\", errorCode == 16001, \"Pending user action\", errorCode == 16003, \"Pending user action\", errorCode == 50127, \"Pending user action\", errorCode == 50125, \"Pending user action\", errorCode == 50129, \"Pending user action\", errorCode == 50143, \"Pending user action\", errorCode == 81010, \"Pending user action\", errorCode == 81014, \"Pending user action\", errorCode == 81012, \"Pending user action\", \"Failure\")\r\n    | where SigninStatus == '*' or '*' == '*' or '*' == 'All Sign-ins'\r\n    | where details.Type == '*' or (details.Type == 'Country' and Country == details.Name) or (details.Type == 'City' and City == details.Name);\r\ndata\r\n| top 200 by TimeGenerated desc\r\n| extend TimeFromNow = now() - TimeGenerated\r\n| extend TimeAgo = strcat(case(TimeFromNow < 2m, strcat(toint(TimeFromNow / 1m), ' seconds'), TimeFromNow < 2h, strcat(toint(TimeFromNow / 1m), ' minutes'), TimeFromNow < 2d, strcat(toint(TimeFromNow / 1h), ' hours'), strcat(toint(TimeFromNow / 1d), ' days')), ' ago')\r\n| project User = UserDisplayName, ['Sign-in Status'] = strcat(iff(SigninStatus == 'Success', '‚úîÔ∏è', '‚ùå'), ' ', SigninStatus), ['Sign-in Time'] = TimeAgo, App = AppDisplayName, ['Error code'] = errorCode, ['Result type'] = ResultType, ['Result signature'] = ResultSignature, ['Result description'] = ResultDescription, ['Conditional access policies'] = ConditionalAccessPolicies, ['Conditional access status'] = ConditionalAccessStatus, ['Operating system'] = DeviceDetail.operatingSystem, Browser = DeviceDetail.browser, ['Country or region'] = LocationDetails.countryOrRegion, ['State'] = LocationDetails.state, ['City'] = LocationDetails.city, ['Time generated'] = TimeGenerated, Status, ['User principal name'] = UserPrincipalName\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Location Sign-in Details",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isIntrusionDetectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isIntrusionDetectionVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Adaptive Access Control",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Deception Platforms\r\n\r\n### TIC 3.0 Guidance\r\nDeception platform technologies provide decoy environments, from individual machines to entire networks, that can be used to deflect attacks away from the operational systems supporting agency missions/business functions.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Use Microsoft Defender for Identity to Deploy/Monitor Honeytokens for Deception-Based Detections\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityAlert¬†(Microsoft Defender for Identity) ‚ú≥Ô∏è [Get Started with Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender) \r\n\r\n### Navigate \r\n\t‚Ä¢ Defender for Identity Portal > Configuration > Detection > Entity Tags > Honeytoken\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Microsoft Defender for Identity Portal](https://portal.atp.azure.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Manage Sensitive or Honeytoken Accounts](https://docs.microsoft.com/defender-for-identity/manage-sensitive-honeytoken-accounts)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ DE.AE\r\n\t‚Ä¢ RS.AN"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isIntrusionDetectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where ProviderName == \"Azure Advanced Threat Protection\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AlertName\r\n|¬†render¬†areachart \r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Microsoft Defender for Identity Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isIntrusionDetectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Use Microsoft Defender for Identity to Deploy/Monitor Honeytokens for Deception-Based Detections\r\n![Image¬†Name](https://docs.microsoft.com/defender-for-identity/media/entity-tags.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Microsoft Defender for Identity](https://www.microsoft.com/microsoft-365/security/identity-defender)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isIntrusionDetectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isIntrusionDetectionVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Deception Platforms",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Certificate Transparency Log Monitoring\r\n\r\n### TIC 3.0 Guidance\r\nCertificate transparency log monitoring allows agencies to discover when new certificates are issued for agency domains.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Key Vault to Configure Certificate Transparency\r\n\t‚Ä¢ Use Azure Security Center Recommendations to Monitor Certificate/Key Settings\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityRecommendation¬†(Azure Security Center) ‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/security-center/) \r\nüî∑ SecurityRecommendation¬†(Key Vault) ‚ú≥Ô∏è [Get Started with Key Vault](https://azure.microsoft.com/services/key-vault/) \r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Key Vault > Settings > Certificates > Completed > Select Certificate > Confirm Enablement > Issuance Policy > Advanced Policy Configuration > Certificate Transparency \r\n\t‚Ä¢ Azure Security Center > Recommendations\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults) \r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Get Started with Key Vault Certificates](https://docs.microsoft.com/azure/key-vault/certificates/certificate-scenarios)\r\nüí°¬†[Security Recommendations in Azure Security Center](https://docs.microsoft.com/azure/security-center/security-center-recommendations)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ DE.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isIntrusionDetectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n|where RecommendationName == \"Azure Defender for Key Vault should be enabled\"\r\nor RecommendationName == \"Ensure access keys are rotated every 90 days or less\"\r\nor RecommendationName == \"Ensure no root account access key exists\"\r\nor RecommendationName == \"Web apps should request an SSL certificate for all incoming requests\"\r\nor RecommendationName == \"Private endpoint should be configured for Key Vault\"\r\nor RecommendationName == \"Diagnostic logs in Key Vault should be enabled\"\r\nor RecommendationName == \"Key vaults should have purge protection enabled\"\r\nor RecommendationName == \"Key vaults should have soft delete enabled\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step¬†1d¬†by¬†RecommendationName\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Security Center Recommendations for Keys/Certificates",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isIntrusionDetectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where AlertType startswith \"KV_\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AlertType\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Key Vault Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isIntrusionDetectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Manage Certificate Transparency with Azure Key Vault\r\n![Image¬†Name](https://docs.microsoft.com/azure/key-vault/media/azure-key-vault.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Key Vault](https://azure.microsoft.com/services/key-vault/) \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isIntrusionDetectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isIntrusionDetectionVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Certificate Transparency Log Monitoring",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##¬†Enterprise\r\nEnterprise-based controls including security orchestration automation & response, shadow IT detection, and virtual private networks. \r\n\r\n|¬†<em> TIC 3.0 vs Zero Trust </em> |\r\n|¬†:¬†|¬†: | : | : |\r\n|¬†<strong> Capabilities¬†</strong> | <strong> Microsoft Controls¬†</strong> |¬†<strong> Zero Trust Principles </strong>  | <strong> Zero Trust Pillars </strong>  |\r\n|¬†Security Orchestration, Automation, and Response (SOAR)¬†|¬†‚ú≥Ô∏è [Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/) ‚ú≥Ô∏è [Azure Logic Apps](https://azure.microsoft.com/services/logic-apps/) ‚ú≥Ô∏è [Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/) | Automation | Assume Breach | \r\n|¬†Shadow IT Detection¬†|¬†‚ú≥Ô∏è [Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)  ‚ú≥Ô∏è [Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender) ‚ú≥Ô∏è [Azure Defender for IoT](https://azure.microsoft.com/services/azure-defender-for-iot/)   | Verify Explicitly | Use Least Privileged Access | \r\n|¬†Virtual Private Network (VPN)¬†|¬†‚ú≥Ô∏è [VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/)  | Verify Explicitly | Use Least Privileged Access | \r\nFor more information, see the CISA: Trusted Internet Connections üí°[Core Guidance Documents](https://www.cisa.gov/trusted-internet-connections) and Microsoft's üí°[Why Zero Trust](https://www.microsoft.com/security/business/zero-trust)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "isEnterpriseVisible",
          "comparison": "isEqualTo",
          "value": "true"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Enterprise Capabilities Guide",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "d492afb3-4b6e-482e-8d63-6f8e42b9c8b5",
            "cellValue": "Security Orchestration, Automation, and Response (SOAR)",
            "linkTarget": "step",
            "linkLabel": "Security Orchestration, Automation, and Response (SOAR)",
            "style": "link"
          },
          {
            "id": "d600f262-56b1-46d3-990f-1237edaa8eb5",
            "cellValue": "Shadow IT Detection",
            "linkTarget": "step",
            "linkLabel": "Shadow IT Detection",
            "style": "link"
          },
          {
            "id": "008f3aaa-4b7d-4b10-a000-3b249bffa4f4",
            "cellValue": "Virtual Private Network (VPN)",
            "linkTarget": "step",
            "linkLabel": "Virtual Private Network (VPN)",
            "style": "link"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEnterpriseVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Enterprise Capabilities Selector"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Security Orchestration, Automation, and Response (SOAR)\r\n\r\n### TIC 3.0 Guidance\r\nSecurity Orchestration, Automation, and Response (SOAR) tools define, prioritize, and automate the response to security incidents.\r\n\r\n### Microsoft Recommendation  \r\n    ‚Ä¢ Leverage Azure Sentinel Playbooks for Security Orchestration Automation & Response\r\n    ‚Ä¢ Use Azure Resource Graph to Monitor Configured Playbooks\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ Resources (Azure Resource Graph) ‚ú≥Ô∏è [Get Started with Azure Resource Graph](https://azure.microsoft.com/features/resource-graph/) üî∑ AzureActivity¬†(Azure Sentinel: Playbooks) ‚ú≥Ô∏è [Get Started with Azure Logic Apps](https://azure.microsoft.com/services/logic-apps/) \r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Sentinel > Playbooks\r\n\t‚Ä¢ Azure Resource Graph\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Sentinel](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/microsoft.securityinsightsarg%2Fsentinel)\r\nüîÑ [Azure Resource Graph Explorer](https://portal.azure.com/#blade/HubsExtension/ArgQueryBlade)  \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Tutorial: Setup Automated Threat Responses in Azure Sentinel](https://docs.microsoft.com/azure/sentinel/tutorial-respond-threats-playbook)\r\nüí°¬†[What is Azure Resource Graph?](https://docs.microsoft.com/azure/governance/resource-graph/overview)\r\n\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ DE.AE\r\n\t‚Ä¢ DE.CM\r\n\t‚Ä¢ DE.DP\r\n\t‚Ä¢ RS.CO\r\n\t‚Ä¢ RS.AN\r\n\t‚Ä¢ RC.RP"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEnterpriseVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "resources\r\n|¬†where¬†type¬†==¬†\"microsoft.logic/workflows\"\r\n|¬†extend¬†Connection¬†=¬†parse_json(properties)[\"parameters\"][\"$connections\"][\"value\"]\r\n|¬†where¬†Connection¬†has¬†\"managedApis/azuresentinel\"\r\n| project id, type, resourceGroup",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Sentinel (SOAR) Playbooks Configured",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "showExportToExcel": true,
              "queryType": 1,
              "resourceType": "microsoft.resourcegraph/resources",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEnterpriseVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AzureActivity\r\n| where ResourceProvider == \"Microsoft.Logic\"\r\n| summarize count() by Resource\r\n| sort by count_ desc \r\n| render barchart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Sentinel (SOAR) Playbooks Triggered",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEnterpriseVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Sentinel Playbooks for Security Orchestration Automation & Response\r\n![Image¬†Name](https://docs.microsoft.com/azure/sentinel/media/tutorial-respond-threats-playbook/logic-app.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Sentinel](https://azure.microsoft.com/services/azure-sentinel/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEnterpriseVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEnterpriseVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Security Orchestration, Automation, and Response (SOAR)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Shadow IT Detection\r\n\r\n### TIC 3.0 Guidance\r\nShadow IT detection systems detect the presence of unauthorized software and systems in use by an agency.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Discover & Manage Shadow IT with Microsoft Cloud App Security\r\n\t‚Ä¢ Leverage Azure Security Center: Recommendations for Asset Agents to Identity Shadow Assets\r\n\t‚Ä¢ Use Microsoft Defender for Endpoint to Discover Unmanaged Assets\r\n\t‚Ä¢ Leverage Azure Defender for IoT for Continuous Asset Discovery of IoT/OT Devices\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityAlert¬†(Microsoft Cloud App Security) ‚ú≥Ô∏è [Get Started with Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security) üî∑ SecurityRecommendation (Azure Security Center) ‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/security-center/) \r\n\r\n### Navigate \r\n\t‚Ä¢ Microsoft Cloud App Security > Manage Cloud Apps / Conditional Access Control\r\n    ‚Ä¢ Azure Security Center > Recommendations\t\r\n\t‚Ä¢ Microsoft 365 Security Center > Settings > Device Discovery > On\r\n    ‚Ä¢ Azure Defender for IoT > Onboard Subscription / Set Up A Sensor\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Microsoft Cloud App Security Portal](https://portal.cloudappsecurity.com/) \r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0)\r\nüîÑ [Microsoft 365 Security Center](https://security.microsoft.com/) \r\nüîÑ [Azure Defender for IoT](https://portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard/Getting_Started)  \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Tutorial: Discover and Manage Shadow IT in Your Network](https://docs.microsoft.com/cloud-app-security/tutorial-shadow-it)\r\nüí° [Review Your Security Recommendations](https://docs.microsoft.com/azure/security-center/security-center-recommendations)\r\nüí° [Endpoint Discovery - Navigating Your Way Through Unmanaged Devices](https://techcommunity.microsoft.com/t5/microsoft-defender-for-endpoint/endpoint-discovery-navigating-your-way-through-unmanaged-devices/ba-p/2248909)\r\nüí° [Device Discovery Overview](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/device-discovery)\r\nüí° [Welcome to Azure Defender for IoT](https://docs.microsoft.com/azure/defender-for-iot/overview)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.IP\r\n\t‚Ä¢ PR.MA\r\n\t‚Ä¢ DE.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEnterpriseVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityAlert\r\n| where ProductName == \"Microsoft Cloud App Security\"\r\n| where AlertType contains \"DISCOVERY\"\r\n| extend AppId = tostring(parse_json(Entities)[0].AppId)\r\n| where AppId == 'All' or 'All' == \"All\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†AlertName\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Microsoft Cloud App Security: Shadow IT Alerts",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEnterpriseVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n| where RecommendationName contains \"agent\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†RecommendationName\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Security Center: Recommendations for Asset Agents",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEnterpriseVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Discover & Manage Shadow IT with Microsoft Cloud App Security\r\n![Image¬†Name](https://docs.microsoft.com/cloud-app-security/media/shadow-it-lifecycle.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Microsoft Cloud App Security](https://www.microsoft.com/microsoft-365/enterprise-mobility-security/cloud-app-security)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEnterpriseVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Use Microsoft Defender for Endpoint to Discover Unmanaged Assets\r\n![Image¬†Name](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/271944i96F40CC05F52EB6B/image-size/large?v=v2&px=999)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Microsoft Defender for Endpoint](https://www.microsoft.com/microsoft-365/security/endpoint-defender) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEnterpriseVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Defender for IoT for Continuous Asset Discovery and Threat Detection for Internet of Things (IoT) and Operational Technology (OT) Devices\r\n![Image¬†Name](https://techcommunity.microsoft.com/t5/image/serverpage/image-id/226961i89A8F8C37529FC47/image-size/large?v=v2&px=999)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Defender for IoT](https://azure.microsoft.com/services/azure-defender-for-iot/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEnterpriseVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEnterpriseVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Shadow IT Detection",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Virtual Private Network (VPN)\r\n\r\n### TIC 3.0 Guidance\r\nVirtual private network (VPN) solutions provide a secure communications mechanism between networks that may traverse across unprotected or public networks.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure VPN Gateway for Virtual Private Network Protections\r\n\r\n### Navigate \r\n\t‚Ä¢ Virtual Network Gateways > Add\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Virtual Network Gateways](https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Network%2FvirtualNetworkGateways)\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[What is VPN Gateway?](https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-about-vpngateways)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.AC\r\n\t‚Ä¢ PR.DS\r\n\t‚Ä¢ PR.IP\r\n\t‚Ä¢ PR.MA\r\n\t‚Ä¢ PR.PT"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEnterpriseVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure VPN Gateway for Virtual Private Network Protections\r\n![Image¬†Name](https://docs.microsoft.com/azure/networking/media/backend-interoperability/testsetup.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with VPN Gateway](https://azure.microsoft.com/services/vpn-gateway/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isEnterpriseVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isEnterpriseVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Virtual Private Network (VPN)",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##¬†Unified Communications & Collaboration\r\nUCC measures including identity verification, encrypted communications, connection terminations, and data loss prevention. \r\n\r\n|¬†<em> TIC 3.0 vs Zero Trust </em> |\r\n|¬†:¬†|¬†: | : | : |\r\n|¬†<strong> Capabilities¬†</strong> | <strong> Microsoft Controls¬†</strong> |¬†<strong> Zero Trust Principles </strong>  | <strong> Zero Trust Pillars </strong>  |\r\n|¬†UCC Identity Verification¬†|¬†‚ú≥Ô∏è [Microsoft Teams](https://www.microsoft.com/microsoft-teams/group-chat-software)  | Verify Explicitly | Identities | \r\n|¬†UCC Encrypted Communication¬†|¬†‚ú≥Ô∏è [Microsoft Teams](https://www.microsoft.com/microsoft-teams/group-chat-software)  | Assume Breach | Data | \r\n|¬†UCC Connection Termination¬†|¬†‚ú≥Ô∏è [Microsoft Teams](https://www.microsoft.com/microsoft-teams/group-chat-software)  | Verify Explicitly, Use Least Privileged Access | Identities | \r\n|¬†UCC Data Loss Prevention¬†|¬†‚ú≥Ô∏è [Microsoft 365 Compliance Management]( https://www.microsoft.com/microsoft-365/enterprise/compliance-management) ‚ú≥Ô∏è [Microsoft 365 Compliance: Communication Compliance](https://www.microsoft.com/microsoft-365/business/compliance-solutions) | Assume Breach | Data |\r\nFor more information, see the CISA: Trusted Internet Connections üí°[Core Guidance Documents](https://www.cisa.gov/trusted-internet-connections) and Microsoft's üí°[Why Zero Trust](https://www.microsoft.com/security/business/zero-trust)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "isUnifiedCommunicationsCollaborationVisible",
          "comparison": "isEqualTo",
          "value": "true"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Unified Communications & Collaboration Capabilities Guide",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "fdf75962-e198-458c-a72e-e09df349b23a",
            "cellValue": "UCC Identity Verification",
            "linkTarget": "step",
            "linkLabel": "UCC Identity Verification",
            "style": "link"
          },
          {
            "id": "d0d78efd-c1d1-4444-9dd9-dc8e7654895c",
            "cellValue": "UCC Encrypted Communication",
            "linkTarget": "step",
            "linkLabel": "UCC Encrypted Communication\t",
            "style": "link"
          },
          {
            "id": "bd2d8df1-8c53-48ea-97a6-11d0e04c1201",
            "cellValue": "UCC Connection Termination",
            "linkTarget": "step",
            "linkLabel": "UCC Connection Termination",
            "style": "link"
          },
          {
            "id": "792ebae5-b8f3-4842-b97d-d57514d1a22c",
            "cellValue": "UCC Data Loss Prevention",
            "linkTarget": "step",
            "linkLabel": "UCC Data Loss Prevention",
            "style": "link"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUnifiedCommunicationsCollaborationVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Unified Communications & Collaboration Capabilities Selector"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ UCC Identity Verification\r\n\r\n### TIC 3.0 Guidance\r\nIdentity verification ensures that access to the virtual meeting is limited to appropriate individuals. Waiting room features, where the meeting host authorizes vetted individuals to join the meeting can also be utilized.\r\n\r\n### Microsoft Recommendation  \r\nLeverage Microsoft Teams for UCC Identity Verification. Microsoft Teams provides Trustworthy by Design defenses against Identity Spoofing. Spoofing occurs when the attacker determines and uses an IP address of a network, computer, or network component without being authorized to do so. A successful attack allows the attacker to operate as if the attacker is the entity normally identified by the IP address.\r\n\r\nTLS authenticates all parties and encrypts all traffic. Using TLS prevents an attacker from performing IP address spoofing on a specific connection (for example, mutual TLS connections). An attacker could still spoof the address of the DNS server. However, because authentication in Teams is performed with certificates, an attacker would not have a valid certificate required to spoof one of the parties in the communication.\r\nFor More Information, see üí°¬†[Identity Spoofing (IP Address Spoofing)](https://docs.microsoft.com/microsoftteams/teams-security-guide#identity-spoofing-ip-address-spoofing)\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ OfficeActivity¬†(Microsoft Teams) ‚ú≥Ô∏è [Get Started with Microsoft Teams](https://www.microsoft.com/microsoft-teams/group-chat-software) \r\n\r\n### Navigate \r\n    ‚Ä¢ Microsoft 365 Admin Center > Admin Centers > Teams > Teams Admin Center > Meetings\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Microsoft 365 Admin Center](https://admin.microsoft.com/)\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Security and Microsoft Teams](https://docs.microsoft.com/microsoftteams/teams-security-guide)\r\nüí°¬†[Identity Models and Authentication for Microsoft Teams](https://docs.microsoft.com/microsoftteams/identify-models-authentication)\r\nüí°¬†[Azure Sentinel and Microsoft Teams](https://docs.microsoft.com/microsoftteams/teams-sentinel-guide)\r\nüí°¬†[Microsoft Teams Meeting Attendance Report](https://docs.microsoft.com/microsoftteams/teams-analytics-and-reports/meeting-attendance-report)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.AC"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUnifiedCommunicationsCollaborationVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "OfficeActivity\r\n| where RecordType == \"MicrosoftTeams\"\r\n| where Operation == \"MemberAdded\"\r\n| extend DisplayName_ = tostring(Members[0].DisplayName)\r\n| summarize count() by DisplayName_\r\n| sort by count_ desc \r\n| render columnchart",
              "size": 0,
              "showAnalytics": true,
              "title": "Microsoft Teams Meetings: Members Added",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUnifiedCommunicationsCollaborationVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "OfficeActivity\r\n| where RecordType == \"MicrosoftTeams\"\r\n| where Operation == \"TeamsSessionStarted\"\r\n| where UserId contains \"@\"\r\n| summarize count() by UserId\r\n| sort by count_ desc\r\n| render barchart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Microsoft Teams Meetings: Teams Sessions Initiated",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUnifiedCommunicationsCollaborationVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "OfficeActivity\r\n| where RecordType == \"MicrosoftTeams\"\r\n| summarize count() by Operation\r\n| render piechart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Microsoft Teams Meetings: Operation Count",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUnifiedCommunicationsCollaborationVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3 - Copy - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Microsoft Teams: Information Protection Architecture\r\n![Image¬†Name](https://docs.microsoft.com/microsoftteams/media/overview_of_security_and_compliance_in_microsoft_teams_image1.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Microsoft Teams](https://www.microsoft.com/microsoft-teams/group-chat-software) \r\n"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUnifiedCommunicationsCollaborationVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUnifiedCommunicationsCollaborationVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "UCC Identity Verification",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ UCC Encrypted Communication\r\n\r\n### TIC 3.0 Guidance\r\nCommunication between virtual meeting participants and any data exchanged is encrypted at rest and in transit. Some UCC offerings support end-to-end encryption, where encryption is performed on the clients and can only be decrypted by the other authenticated participants and cannot be decrypted by the UCC vendor.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Microsoft Teams for UCC Enrypted Communicaton \r\n\t‚Ä¢ Network communications in Teams are encrypted by default\r\n\t‚Ä¢ By requiring all servers to use certificates and by using OAUTH, TLS, Secure Real-Time Transport Protocol (SRTP), all Teams data is protected on the network \r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ OfficeActivity¬†(Microsoft Teams) ‚ú≥Ô∏è [Get Started with Microsoft Teams](https://www.microsoft.com/microsoft-teams/group-chat-software) \r\n\r\n### Navigate \r\n    ‚Ä¢ Microsoft 365 Admin Center > Admin Centers > Teams > Teams Admin Center > Meetings\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Microsoft 365 Admin Center](https://admin.microsoft.com/)\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Security and Microsoft Teams](https://docs.microsoft.com/microsoftteams/teams-security-guide)\r\nüí°¬†[Azure Sentinel and Microsoft Teams](https://docs.microsoft.com/microsoftteams/teams-sentinel-guide)\r\nüí°¬†[Trustworthy by Default](https://docs.microsoft.com/microsoftteams/teams-security-guide#trustworthy-by-default)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ PR.DS"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUnifiedCommunicationsCollaborationVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "OfficeActivity\r\n| where RecordType == \"MicrosoftTeams\"\r\n| where Operation == \"TeamsSessionStarted\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†Operation\r\n| render areachart\r\n",
              "size": 0,
              "showAnalytics": true,
              "title": "Microsoft Teams: Sessions Started",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUnifiedCommunicationsCollaborationVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUnifiedCommunicationsCollaborationVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "UCC Encrypted Communication",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ UCC Connection Termination\r\n\r\n### TIC 3.0 Guidance\r\nMechanisms that ensure the meeting host can positively control participation. These can include inactivity timeouts, on-demand prompts, unique access codes for each meeting, host participant eviction, and even meeting duration limits.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Microsoft Teams for UCC Connection Termination Controls via Meeting Policies\r\n\r\n### Navigate \r\n    ‚Ä¢ Microsoft 365 Admin Center > Admin Centers > Teams > Teams Admin Center > Meetings > Meeting Policies\r\n\t‚Ä¢ Microsoft 365 Admin Center > Admin Centers > Teams > Teams Admin Center > Endpoints > Teams Rooms\r\n\t‚Ä¢ Microsoft 365 Admin Center > Admin Centers > Teams > Teams Admin Center > Meetings > Edit Meeting > Remove Participant\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Microsoft 365 Admin Center](https://admin.microsoft.com/)\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Manage Meeting Policies in Teams](https://docs.microsoft.com/microsoftteams/meeting-policies-in-teams)\r\nüí°¬†[Manage Microsoft Teams Rooms](https://docs.microsoft.com/microsoftteams/rooms/rooms-manage)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.AC\r\n\t‚Ä¢ PR.IP\r\n\t‚Ä¢ PR.AT"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUnifiedCommunicationsCollaborationVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft Teams for UCC Connection Termination Controls via Meeting Policies\r\n![Image¬†Name](https://docs.microsoft.com/microsoftteams/media/designated-presenter-role.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Microsoft Teams](https://www.microsoft.com/microsoft-teams/group-chat-software) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUnifiedCommunicationsCollaborationVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUnifiedCommunicationsCollaborationVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "UCC Connection Termination",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ UCC Data Loss Prevention\r\n\r\n### TIC 3.0 Guidance\r\nMechanisms for controlling the sharing of information between UCC participants, intentional or incidental. This may be integrated into additional agency data loss prevention technologies and can include keyword matching, attachment file type or existence prohibitions, attachment size limitations, or even audio/visual filters.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Microsoft 365 Defender: Compliance Policies for Microsoft Teams Data Loss Prevention\r\n\t‚Ä¢ Leverage Microsoft 365 Compliance Center: Communication Compliance to Protect & Monitor Sensitive Data in Unified Communications\r\n\r\n### Navigate \r\n\t‚Ä¢ M365 Security & Compliance Center > Data Loss Prevention > Policy > Create a Policy\r\n\t‚Ä¢ Microsoft 365 Compliance Center > Catalog > Communication Compliance > View > Open Solution\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Microsoft 365 Security Center](https://security.microsoft.com/) \r\nüîÑ [Microsoft 365 Compliance Center](https://compliance.microsoft.com/) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Data Loss Prevention and Microsoft Teams](https://docs.microsoft.com/microsoft-365/compliance/dlp-microsoft-teams)\r\nüí°[Communication Compliance in Microsoft 365](https://docs.microsoft.com/microsoft-365/compliance/communication-compliance-solution-overview)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.DS"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUnifiedCommunicationsCollaborationVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft 365 Compliance Management: Policies for Microsoft Teams Data Loss Prevention\r\n![Image¬†Name](https://docs.microsoft.com/microsoft-365/media/dlp-teams-createnewpolicy-template.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUnifiedCommunicationsCollaborationVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft 365 Compliance: Communication Compliance to Protect & Monitor Sensitive Data in Unified Communications\r\n![Image Name](https://docs.microsoft.com/microsoft-365/media/communication-compliance-filter-detail-controls.png) \r\n\r\n‚ú≥Ô∏è [Get Started with Microsoft 365 Compliance: Communication Compliance](https://www.microsoft.com/microsoft-365/business/compliance-solutions)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isUnifiedCommunicationsCollaborationVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isUnifiedCommunicationsCollaborationVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "UCC Data Loss Prevention",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 1,
      "content": {
        "json": "##¬†Data Protection\r\nData protection measures including access control, protections for data at rest, protections for data in transit, data loss prevention, and data access & use telemetry. \r\n\r\n|¬†<em> TIC 3.0 vs Zero Trust </em> |\r\n|¬†:¬†|¬†: | : | : |\r\n|¬†<strong> Capabilities¬†</strong> | <strong> Microsoft Controls¬†</strong> |¬†<strong> Zero Trust Principles </strong>  | <strong> Zero Trust Pillars </strong>  |\r\n|¬†Access Control¬†| ‚ú≥Ô∏è [Azure Active Directory](https://azure.microsoft.com/services/active-directory/) | Verify Explicitly | Identities |\r\n|¬†Protections for Data at Rest¬†|¬†‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)  | Assume Breach | Data |\r\n|¬†Protections for Data in Transit¬†|¬†‚ú≥Ô∏è [Key Vault](https://azure.microsoft.com/services/key-vault/) ‚ú≥Ô∏è [Azure Security Center](https://azure.microsoft.com/services/security-center/)  | Assume Breach | Data | \r\n|¬†Data Loss Prevention¬†|¬†‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/) ‚ú≥Ô∏è [Azure Purview]( https://azure.microsoft.com/services/purview/) ‚ú≥Ô∏è [Microsoft 365 Compliance Management](https://www.microsoft.com/microsoft-365/enterprise/compliance-management) | Use Least Privileged Access, Assume Breach | Data |\r\n|¬†Data Access and Use Telemetry¬†|¬†‚ú≥Ô∏è [Azure Information Protection](https://azure.microsoft.com/services/information-protection/) ‚ú≥Ô∏è [Microsoft 365 Compliance Center](https://www.microsoft.com/microsoft-365/enterprise/compliance-management) | Use Least Privileged Access, Assume Breach | Data |\r\nFor more information, see the CISA: Trusted Internet Connections üí°[Core Guidance Documents](https://www.cisa.gov/trusted-internet-connections) and Microsoft's üí°[Why Zero Trust](https://www.microsoft.com/security/business/zero-trust)",
        "style": "info"
      },
      "conditionalVisibilities": [
        {
          "parameterName": "isDataProtectionVisible",
          "comparison": "isEqualTo",
          "value": "true"
        },
        {
          "parameterName": "Help",
          "comparison": "isEqualTo",
          "value": "Yes"
        }
      ],
      "name": "Data Protection Capabilities Guide",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "9c4b9c9f-7222-4a89-8f5e-bf41698143fb",
            "cellValue": "Access Control_DP",
            "linkTarget": "step",
            "linkLabel": "Access Control",
            "style": "link"
          },
          {
            "id": "51c9b125-5b22-48b0-ae6d-2504c7efb4cd",
            "cellValue": "Protections for Data at Rest",
            "linkTarget": "step",
            "linkLabel": "Protections for Data at Rest",
            "style": "link"
          },
          {
            "id": "1327dfc1-236b-4f1a-b92c-7b4a6999d964",
            "cellValue": "Protections for Data in Transit",
            "linkTarget": "step",
            "linkLabel": "Protections for Data in Transit",
            "style": "link"
          },
          {
            "id": "b0db0ea1-f337-4c8c-9d17-3cb221dc4378",
            "cellValue": "Data Loss Prevention_DP",
            "linkTarget": "step",
            "linkLabel": "Data Loss Prevention ",
            "style": "link"
          },
          {
            "id": "6f3d353f-c9dc-4197-836b-98243db6c707",
            "cellValue": "Data Access and Use Telemetry",
            "linkTarget": "step",
            "linkLabel": "Data Access and Use Telemetry",
            "style": "link"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isDataProtectionVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Data Protection Capabilities Selector"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Access Control\r\n\r\n### TIC 3.0 Guidance\r\nAccess control technologies allow an agency to define policies concerning the allowable activities of users and entities to data and resources.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Active Directory to Manage Access Control\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ AuditLogs¬†(Azure Active Directory) ‚ú≥Ô∏è [Get Started with Azure Active Directory](https://azure.microsoft.com/services/active-directory/) \r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Active Directory > Users / Groups / Roles and Adminstrators\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Active Directory](https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/Overview)\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[How Access Management in Azure AD works](https://docs.microsoft.com/azure/active-directory/fundamentals/active-directory-manage-groups#how-access-management-in-azure-ad-works)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.AC\r\n\t‚Ä¢ PR.IP\r\n\t‚Ä¢ DE.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "AuditLogs\r\n| summarize Runs = count(), Success = countif(Result == 'success'), Fails = countif(Result != 'success') by OperationName // Summarize the total, successful and failed operations by name\r\n| extend SuccessRate = (Success * 100 / Runs) // Calculate the percentage of succesful operations against the total\r\n| join (\r\n    AuditLogs\r\n    | where Result == 'success'\r\n    | make-series TrendList = count() on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by OperationName \r\n    )\r\n    on OperationName\r\n| project OperationName, Runs, SuccessRate, TrendList\r\n| top 10 by Runs desc // Show the top 10 of most run operations",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure User Activity Logs",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "OperationName",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "Runs",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                },
                "secondaryContent": {
                  "columnMatch": "TrendList",
                  "formatter": 9,
                  "formatOptions": {
                    "palette": "blue"
                  }
                },
                "showBorder": false
              }
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Active Directory to Manage Access Control\r\n![Image¬†Name](https://docs.microsoft.com/azure/active-directory/fundamentals/media/active-directory-manage-groups/active-directory-access-management-works.png)¬†\r\n\r\n‚ú≥Ô∏è [Enable Azure Active Directory Premium Trial](https://azure.microsoft.com/trial/get-started-active-directory/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isDataProtectionVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Access Control_DP",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Protections for Data at Rest\r\n\r\n### TIC 3.0 Guidance\r\nData protection at rest aims to secure data stored on any endpoint or storage medium.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Key Vault for Data at Rest Encryption Configurations\r\n\t‚Ä¢ Use Azure Security Center Recommendations to Configure Data at Rest Protections\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityRecommendation¬†(Azure Security Center) ‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/security-center/) \r\n\r\n### Navigate \r\n\t‚Ä¢ Key Vaults > Create\r\n\t‚Ä¢ Azure Security Center > Recommendations > Enable Encryption at Rest\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults) \r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Azure Data Encryption at Rest](https://docs.microsoft.com/azure/security/fundamentals/encryption-atrest)\r\nüí°¬†[About Azure Key Vault](https://docs.microsoft.com/azure/key-vault/general/overview)\r\nüí°¬†[Use Azure Security Center Recommendations to Enhance Security](https://docs.microsoft.com/azure/security-center/security-center-using-recommendations)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.DS"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n|where RecommendationName == \"Disk encryption should be applied on virtual machines\"\r\nor RecommendationName == \"Transparent Data Encryption on SQL databases should be enabled\"\r\nor RecommendationName == \"Ensure AWS Config is enabled in all regions\"\r\nor RecommendationName == \"Ensure CloudTrail logs are encrypted at rest using AWS KMS CMKs\"\r\nor RecommendationName == \"Ensure rotation for customer created CMKs is enabled\"\r\nor RecommendationName == \"AWS Security Hub should be enabled in every region in your AWS accounts\"\r\nor RecommendationName == \"CloudTrail logs should be encrypted at rest using AWS KMS CMKs\"\r\nor RecommendationName == \"AWS Config should be enabled\"\r\nor RecommendationName == \"SQL servers should use customer-managed keys to encrypt data at rest\"\r\nor RecommendationName == \"Container registries should be encrypted with a customer-managed key (CMK)\"\r\nor RecommendationName == \"Storage accounts should use customer-managed key (CMK) for encryption\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†RecommendationName\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Security Center: Data at Rest Recommenations",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Key Vault for Data at Rest Encryption Configurations\r\n![Image¬†Name](https://docs.microsoft.com/azure/security/fundamentals/media/encryption-atrest/azure-security-encryption-atrest-fig1.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Key Vault](https://azure.microsoft.com/services/key-vault/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isDataProtectionVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Protections for Data at Rest",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Protections for Data in Transit\r\n\r\n### TIC 3.0 Guidance\r\nData protection in transit, or data in motion, aims to secure data that is actively moving from one location to another, such as across the internet or through a private enterprise network.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Key Vault for Data in Transit Encryption Configurations\r\n\t‚Ä¢ Use Azure Security Center Recommendations to Configure Data in Transit Protections\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ SecurityRecommendation¬†(Azure Security Center) ‚ú≥Ô∏è [Get Started with Azure Security Center](https://azure.microsoft.com/services/security-center/) \r\n\r\n### Navigate \r\n\t‚Ä¢ Key Vaults > Create\r\n\t‚Ä¢ Azure Security Center > Recommendations > Enable Encryption in Transit\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Key Vaults](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.KeyVault%2Fvaults) \r\nüîÑ [Azure Security Center](https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0) \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[Azure Data Encryption in Transit](https://docs.microsoft.com/azure/security/fundamentals/encryption-overview#encryption-of-data-in-transit)\r\nüí°¬†[About Azure Key Vault](https://docs.microsoft.com/azure/key-vault/general/overview)\r\nüí°¬†[Use Azure Security Center Recommendations to Enhance Security](https://docs.microsoft.com/azure/security-center/security-center-using-recommendations)\r\nüí°¬†[Encryption for Data in Transit](https://docs.microsoft.com/compliance/assurance/assurance-encryption-in-transit)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.DS"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityRecommendation\r\n|where RecommendationName == \"Web Application should only be accessible over HTTPS\"\r\nor RecommendationName == \"Function App should only be accessible over HTTPS\"\r\nor RecommendationName == \"Secure transfer to storage accounts should be enabled\"\r\nor RecommendationName == \"TLS should be updated to the latest version for your web app\"\r\nor RecommendationName == \"TLS should be updated to the latest version for your function app\"\r\nor RecommendationName == \"FTPS should be required in your function App\"\r\nor RecommendationName == \"FTPS should be required in your web App\"\r\nor RecommendationName == \"Application Load Balancer should be configured to redirect all HTTP requests to HTTPS\"\r\nor RecommendationName == \"S3 buckets should require requests to use Secure Socket Layer\"\r\nor RecommendationName == \"S3 buckets should have server-side encryption enabled\"\r\nor RecommendationName == \"AWS Config should be enabled\"\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†RecommendationName\r\n| render areachart",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Security Center: Data in Transit Recommenations",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isDataProtectionVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Protections for Data in Transit",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Data Loss Prevention\r\n\r\n### TIC 3.0 Guidance\r\nData loss prevention technologies detect instances of the exfiltration, either malicious or accidental, of agency data.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Leverage Azure Information Protection for Data Loss Prevention\r\n\t‚Ä¢ Use Azure Purview for Unified Data Governance Service Supporting Management of On-premises, Multicloud, and Software-as-a-Service (SaaS) Data\r\n\t‚Ä¢ Leverage Microsoft Defender for Office 365 for Data Loss Prevention\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ InformationProtectionLogs_CL¬†(Azure Information Protection) ‚ú≥Ô∏è [Get Started with Azure Information Protection](https://azure.microsoft.com/services/information-protection/) \r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Information Protection > Usage Report\r\n\t‚Ä¢ Azure Purview > Overview\r\n\t‚Ä¢ Microsoft 365 Compliance Center > Data Loss Prevention\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade) \r\nüîÑ [Purview Accounts](https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.Purview%2FAccounts) \r\nüîÑ [Microsoft 365 Compliance Center](https://compliance.microsoft.com/) \t\r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[What is Azure Information Protection?](https://docs.microsoft.com/azure/information-protection/what-is-information-protection)\r\nüí°¬†[Quickstart: Deploying the Azure Information Protection (AIP) Unified Labeling Client](https://docs.microsoft.com/azure/information-protection/quickstart-deploy-client)\r\nüí°¬†[Azure Information Protection (AIP) Labeling, Classification, and Protection](https://docs.microsoft.com/azure/information-protection/aip-classification-and-protection)\r\nüí°¬†[What is Azure Purview?](https://docs.microsoft.com/azure/purview/overview)\r\nüí°¬†[Overview of Data Loss Prevention](https://docs.microsoft.com/microsoft-365/compliance/data-loss-prevention-policies)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ PR.DS"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "InformationProtectionLogs_CL\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†Activity_s, Operation_s, LabelName_s, ApplicationName_s\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Information Protection: DLP Actions",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Azure Information Protection for Data Loss Prevention\r\n![Image¬†Name](https://docs.microsoft.com/microsoft-365/media/powered-by-intelligent-platform.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Information Protection](https://azure.microsoft.com/services/information-protection/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Use Azure Purview for Unified Data Governance Service Supporting Management of On-premises, Multicloud, and Software-as-a-Service (SaaS) Data\r\n![Image¬†Name](https://docs.microsoft.com/azure/purview/media/create-a-custom-classification-and-classification-rule/classification.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Purview](https://azure.microsoft.com/services/purview/) "
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft 365 Compliance Center for Data Loss Prevention\r\n![Image¬†Name](https://docs.microsoft.com/microsoft-365/media/943fd01c-d7aa-43a9-846d-0561321a405e.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Microsoft 365 Compliance Center](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isDataProtectionVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Data Loss Prevention_DP",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "### Requirement\r\nüî∑ Data Access and Use Telemetry\r\n\r\n### TIC 3.0 Guidance\r\nIdentify agency sensitive data stored, processed, or transmitted, including those located at a service provider. Enforce detailed logging for access or changes to sensitive data.\r\n\r\n### Microsoft Recommendation  \r\n\t‚Ä¢ Use Azure Information Protction to Discover, Monitor, and Control Sensitive Data\r\n\t‚Ä¢ Leverage Microsoft 365 Compliance Center for Data Loss Prevention\t\r\n\r\n###¬†Required¬†Log¬†(Log¬†Source)\r\nüî∑ InformationProtectionLogs_CL¬†(Azure Information Protection) ‚ú≥Ô∏è [Get Started with Azure Information Protection](https://azure.microsoft.com/services/information-protection/) \r\n\r\n### Navigate \r\n\t‚Ä¢ Azure Information Protection > Activity Logs\r\n    ‚Ä¢ Microsoft 365 Compliance Center > Data Loss Prevention\r\n### Microsoft Security Portals, Features, & Admin Centers\r\nüîÑ [Azure Information Protection](https://portal.azure.com/#blade/Microsoft_Azure_InformationProtection/DataClassGroupEditBlade/quickstartBlade) \r\nüîÑ [Microsoft 365 Compliance Center](https://compliance.microsoft.com/)  \r\n###¬†Microsoft¬†Reference¬†\r\nüí°¬†[What is Azure Information Protection?](https://docs.microsoft.com/azure/information-protection/what-is-information-protection)\r\nüí°¬†[Tutorial: Discovering Your Sensitive Content with the Azure Information Protection (AIP) scanner](https://docs.microsoft.com/azure/information-protection/tutorial-scan-networks-and-content)\r\nüí°¬†[Quickstart: Deploying the Azure Information Protection (AIP) Unified Labeling Client](https://docs.microsoft.com/azure/information-protection/quickstart-deploy-client)\r\nüí°¬†[Azure Information Protection (AIP) Labeling, Classification, and Protection](https://docs.microsoft.com/azure/information-protection/aip-classification-and-protection)\r\nüí°¬†[Overview of Data Loss Prevention](https://docs.microsoft.com/microsoft-365/compliance/data-loss-prevention-policies)\r\n###¬†Trusted Internet Connections\r\nüí°¬†[TIC 3.0 Model](https://www.cisa.gov/trusted-internet-connections)\r\n### NIST CSF Mapping\r\n\t‚Ä¢ ID.AM\r\n\t‚Ä¢ PR.AC\r\n\t‚Ä¢ PR.DS\r\n\t‚Ä¢ PR.PT\r\n\t‚Ä¢ DE.AE\r\n    ‚Ä¢ DE.CM"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "InformationProtectionLogs_CL\r\n| make-series count() default=0 on TimeGenerated from {TimeRange:start} to {TimeRange:end} step 1d by¬†ApplicationName_s\r\n| render areachart ",
              "size": 0,
              "showAnalytics": true,
              "title": "Azure Information Protection Logging by Application",
              "noDataMessage": "An Empty Panel Provides Opportunity To Explore This Control Further and Implement Solutions                                                                                                                                               ‚Ä¢    Confirm Licensing, Availability, and Health of Respective Offerings                                                                                                                                                ‚Ä¢    Confirm Log Source is Onboarded to Azure Sentinel Workspace                                                                                                                                                     ‚Ä¢    Adjust the Time Paramenter for a Larger Data-Set                                                                                                                                                                          ‚Ä¢    Panels Can Display 'No Data' if All Recommendations are Fully Implemented, See Azure Security Center Recommendations                                                                                                                                   ‚Ä¢    Third Party Tooling: Adjust Respective Panel KQL Query for Third Pary Tooling Requirements",
              "timeContext": {
                "durationMs": 7776000000
              },
              "timeContextFromParameter": "TimeRange",
              "showExportToExcel": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ]
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "query - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Use Azure Information Protection to Discover, Monitor, and Control Sensitive Data\r\n![Image¬†Name](https://docs.microsoft.com/azure/information-protection/media/qs-tutor/content-scan-job-data-discovery.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Azure Information Protection](https://azure.microsoft.com/services/information-protection/)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3",
            "styleSettings": {
              "maxWidth": "50"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "### Leverage Microsoft 365 Compliance Center for Data Loss Prevention\r\n![Image¬†Name](https://docs.microsoft.com/microsoft-365/media/943fd01c-d7aa-43a9-846d-0561321a405e.png)¬†\r\n\r\n‚ú≥Ô∏è [Get Started with Microsoft 365 Compliance Center](https://www.microsoft.com/microsoft-365/enterprise/compliance-management)"
            },
            "customWidth": "50",
            "conditionalVisibility": {
              "parameterName": "isDataProtectionVisible",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "text - 3 - Copy",
            "styleSettings": {
              "maxWidth": "50"
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "isDataProtectionVisible",
        "comparison": "isEqualTo",
        "value": "true"
      },
      "name": "Data Access and Use Telemetry",
      "styleSettings": {
        "showBorder": true
      }
    }
  ],
  "fromTemplateId": "sentinel-ZeroTrust(TIC3.0)",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
