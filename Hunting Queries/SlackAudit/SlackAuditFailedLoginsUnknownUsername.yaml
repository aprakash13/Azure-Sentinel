id: d61ba8f2-e0fa-44ca-b9b9-8f938ebea98c
name: SlackAudit - Failed logins with unknown username
description: |
  'This query shows attempts of failed logins with unknown username.'
tactics: CredentialAccess
relevantTechniques: T1110
query: |
  let lbtime = 24h;
  let lbperiod = 60d;
  let known_users = SlackAudit
  | where TimeGenerated > ago(lbperiod)
  | where DvcAction =~ 'user_login'
  | where isnotempty(SrcUserName)
  | summarize makeset(SrcUserName);
  SlackAudit
  | where TimeGenerated > ago(lbtime)
  | where DvcAction =~ 'user_login_failed'
  | where isnotempty(SrcUserName)
  | where SrcUserName !in (known_users)
  | project SrcUserName, SrcIpAddr