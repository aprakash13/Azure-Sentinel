// Usage Instruction :
// Paste below query in log analytics, click on Save button and select as Function from drop down by specifying function name and alias as Cloudflare.
// Function usually takes 10-15 minutes to activate. You can then use function alias from any other queries (e.g. Cloudflare | take 10).
// Reference : Using functions in Azure monitor log queries : https://docs.microsoft.com/azure/azure-monitor/log-query/functions
Cloudflare_CL
| extend
    ClientPort_d=column_ifexists('ClientPort_d', ''),
    EdgeResponseBytes_d=column_ifexists('EdgeResponseBytes_d', ''),
    ClientIP_s=column_ifexists('ClientIP_s', ''),
    ClientRequestUserAgent_s=column_ifexists('ClientRequestUserAgent_s', ''),
    FirewallMatchesActions_s=column_ifexists('FirewallMatchesActions_s', ''),
    Action_s=column_ifexists('Action_s', ''),
    ClientTlsCipher_s=column_ifexists('ClientTlsCipher_s', ''),
    OriginIP_s=column_ifexists('OriginIP_s', ''),
    Event_s=column_ifexists('Event_s', ''),
    Status_d=column_ifexists('Status_d', ''),
    ClientProto_s=column_ifexists('ClientProto_s', ''),
    OriginBytes_d=column_ifexists('OriginBytes_d', ''),
    ClientSSLCipher_s=column_ifexists('ClientSSLCipher_s', ''),
    OriginPort_d=column_ifexists('OriginPort_d', ''),
    ClientSSLProtocol_s=column_ifexists('ClientSSLProtocol_s', ''),
    Kind_s=column_ifexists('Kind_s', ''),
    Source_s=column_ifexists('Source_s', ''),
    RuleID_s=column_ifexists('RuleID_s', ''),
    ClientRequestReferer_s=column_ifexists('ClientRequestReferer_s', ''),
    ClientSrcPort_d=column_ifexists('ClientSrcPort_d', ''),
    FirewallMatchesRuleIDs_s=column_ifexists('FirewallMatchesRuleIDs_s', ''),
    ClientRequestBytes_d=column_ifexists('ClientRequestBytes_d', ''),
    ClientRequestMethod_s=column_ifexists('ClientRequestMethod_s', ''),
    ClientDeviceType_s=column_ifexists('ClientDeviceType_s', ''),
    ClientRequestHost_s=column_ifexists('ClientRequestHost_s', ''),
    ClientBytes_d=column_ifexists('ClientBytes_d', ''),
    ClientTlsProtocol_s=column_ifexists('ClientTlsProtocol_s', ''),
    OriginResponseStatus_d=column_ifexists('OriginResponseStatus_d', ''),
    EdgeResponseContentType_s=column_ifexists('EdgeResponseContentType_s', ''),
    ClientCountry_s=column_ifexists('ClientCountry_s', '')
| project-rename
    ClientPort=ClientPort_d,
    EdgeResponseBytes=EdgeResponseBytes_d,
    ClientIP=ClientIP_s,
    ClientRequestUserAgent=ClientRequestUserAgent_s,
    FirewallMatchesActions=FirewallMatchesActions_s,
    Action=Action_s,
    ClientTlsCipher=ClientTlsCipher_s,
    OriginIP=OriginIP_s,
    Event=Event_s,
    Status=Status_d,
    ClientProto=ClientProto_s,
    OriginBytes=OriginBytes_d,
    ClientSSLCipher=ClientSSLCipher_s,
    OriginPort=OriginPort_d,
    ClientSSLProtocol=ClientSSLProtocol_s,
    Kind=Kind_s,
    Source=Source_s,
    RuleID=RuleID_s,
    ClientRequestReferer=ClientRequestReferer_s,
    ClientSrcPort=ClientSrcPort_d,
    FirewallMatchesRuleIDs=FirewallMatchesRuleIDs_s,
    ClientRequestBytes=ClientRequestBytes_d,
    ClientRequestMethod=ClientRequestMethod_s,
    ClientDeviceType=ClientDeviceType_s,
    ClientRequestHost=ClientRequestHost_s,
    ClientBytes=ClientBytes_d,
    ClientTlsProtocol=ClientTlsProtocol_s,
    OriginResponseStatus=OriginResponseStatus_d,
    EdgeResponseContentType=EdgeResponseContentType_s,
    ClientCountry=ClientCountry_s