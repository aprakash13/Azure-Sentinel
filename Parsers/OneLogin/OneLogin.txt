// Usage Instruction : 
// Paste below query in log analytics, click on Save button and select as Function from drop down by specifying function name and alias as OneLoginEvents
// Function usually takes 10-15 minutes to activate. You can then use function alias from any other queries (e.g. OneLoginEvents| take 10).
// Reference : Using functions in Azure monitor log queries : https://docs.microsoft.com/azure/azure-monitor/log-query/functions


oneLogin_CL 
| extend account_id = tostring(parse_json(key_s)[0].account_id) 
| extend actor_system = tostring(parse_json(key_s)[0].actor_system) 
| extend actor_user_id = tostring(parse_json(key_s)[0].actor_user_id) 
| extend actor_user_name = tostring(parse_json(key_s)[0].actor_user_name) 
| extend adc_id = tostring(parse_json(key_s)[0].adc_id) 
| extend adc_name = tostring(parse_json(key_s)[0].adc_name) 
| extend api_credential_name = tostring(parse_json(key_s)[0].api_credential_name) 
| extend app_id = tostring(parse_json(key_s)[0].app_id) 
| extend app_name = tostring(parse_json(key_s)[0].app_name) 
| extend assumed_by_superadmin_or_reseller = tostring(parse_json(key_s)[0].assumed_by_superadmin_or_reseller) 
| extend assuming_acting_user_id = tostring(parse_json(key_s)[0].assuming_acting_user_id) 
| extend authentication_factor_description = tostring(parse_json(key_s)[0].authentication_factor_description) 
| extend authentication_factor_id = tostring(parse_json(key_s)[0].authentication_factor_id) 
| extend authentication_factor_type = tostring(parse_json(key_s)[0].authentication_factor_type) 
| extend certificate_id = tostring(parse_json(key_s)[0].certificate_id) 
| extend certificate_name = tostring(parse_json(key_s)[0].certificate_name) 
| extend client_id = tostring(parse_json(key_s)[0].client_id) 
| extend id = tostring(parse_json(tostring(parse_json(key_s)[0].create))._id) 
| extend custom_message = tostring(parse_json(key_s)[0].custom_message) 
| extend directory_id = tostring(parse_json(key_s)[0].directory_id) 
| extend directory_name = tostring(parse_json(key_s)[0].directory_name) 
| extend directory_sync_run_id = tostring(parse_json(key_s)[0].directory_sync_run_id) 
| extend entity = tostring(parse_json(key_s)[0].entity) 
| extend error_description = tostring(parse_json(key_s)[0].error_description) 
| extend event_location_id = tostring(parse_json(key_s)[0].event_location_id) 
| extend event_timestamp = tostring(parse_json(key_s)[0].event_timestamp) 
| extend event_type_id = tostring(parse_json(key_s)[0].event_type_id) 
| extend group_id = tostring(parse_json(key_s)[0].group_id) 
| extend group_name = tostring(parse_json(key_s)[0].group_name) 
| extend imported_user_id = tostring(parse_json(key_s)[0].imported_user_id) 
| extend imported_user_name = tostring(parse_json(key_s)[0].imported_user_name) 
| extend ipaddr = tostring(parse_json(key_s)[0].ipaddr) 
| extend job_id = tostring(parse_json(key_s)[0].job_id) 
| extend job_name = tostring(parse_json(key_s)[0].job_name) 
| extend login_id = tostring(parse_json(key_s)[0].login_id) 
| extend login_name = tostring(parse_json(key_s)[0].login_name) 
| extend mapping_id = tostring(parse_json(key_s)[0].mapping_id) 
| extend mapping_name = tostring(parse_json(key_s)[0].mapping_name) 
| extend note_id = tostring(parse_json(key_s)[0].note_id) 
| extend note_title = tostring(parse_json(key_s)[0].note_title) 
| extend notes = tostring(parse_json(key_s)[0].notes) 
| extend object_id = tostring(parse_json(key_s)[0].object_id) 
| extend otp_device_id = tostring(parse_json(key_s)[0].otp_device_id) 
| extend otp_device_name = tostring(parse_json(key_s)[0].otp_device_name) 
| extend param = tostring(parse_json(key_s)[0].param) 
| extend policy_id = tostring(parse_json(key_s)[0].policy_id) 
| extend policy_name = tostring(parse_json(key_s)[0].policy_name) 
| extend policy_type = tostring(parse_json(key_s)[0].policy_type) 
| extend privilege_id = tostring(parse_json(key_s)[0].privilege_id) 
| extend privilege_name = tostring(parse_json(key_s)[0].privilege_name) 
| extend proxy_agent_id = tostring(parse_json(key_s)[0].proxy_agent_id) 
| extend proxy_agent_name = tostring(parse_json(key_s)[0].proxy_agent_name) 
| extend proxy_ip = tostring(parse_json(key_s)[0].proxy_ip) 
| extend radius_config_id = tostring(parse_json(key_s)[0].radius_config_id) 
| extend radius_config_name = tostring(parse_json(key_s)[0].radius_config_name) 
| extend report_id = tostring(parse_json(key_s)[0].report_id) 
| extend report_name = tostring(parse_json(key_s)[0].report_name) 
| extend resolution = tostring(parse_json(key_s)[0].resolution) 
| extend resolved_at = tostring(parse_json(key_s)[0].resolved_at) 
| extend resolved_by_user_id = tostring(parse_json(key_s)[0].resolved_by_user_id) 
| extend resource_type_id = tostring(parse_json(key_s)[0].resource_type_id) 
| extend risk_cookie_id = tostring(parse_json(key_s)[0].risk_cookie_id) 
| extend risk_reasons = tostring(parse_json(key_s)[0].risk_reasons) 
| extend risk_score = tostring(parse_json(key_s)[0].risk_score) 
| extend role_id = tostring(parse_json(key_s)[0].role_id) 
| extend role_name = tostring(parse_json(key_s)[0].role_name) 
| extend self_registration_profile_id = tostring(parse_json(key_s)[0].self_registration_profile_id) 
| extend self_registration_profile_name = tostring(parse_json(key_s)[0].self_registration_profile_name) 
| extend service_directory_id = tostring(parse_json(key_s)[0].service_directory_id) 
| extend service_job_id = tostring(parse_json(key_s)[0].service_job_id) 
| extend service_job_name = tostring(parse_json(key_s)[0].service_job_name) 
| extend solved = tostring(parse_json(key_s)[0].solved) 
| extend task_id = tostring(parse_json(key_s)[0].task_id) 
| extend task_name = tostring(parse_json(key_s)[0].task_name) 
| extend trusted_idp_id = tostring(parse_json(key_s)[0].trusted_idp_id) 
| extend trusted_idp_name = tostring(parse_json(key_s)[0].trusted_idp_name) 
| extend user_agent = tostring(parse_json(key_s)[0].user_agent) 
| extend user_agent_id = tostring(parse_json(key_s)[0].user_agent_id) 
| extend user_field_id = tostring(parse_json(key_s)[0].user_field_id) 
| extend user_field_name = tostring(parse_json(key_s)[0].user_field_name) 
| extend user_id = tostring(parse_json(key_s)[0].user_id) 
| extend user_name = tostring(parse_json(key_s)[0].user_name) 
| extend uuid = tostring(parse_json(key_s)[0].uuid) 