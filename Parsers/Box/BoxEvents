// Usage Instruction :
// Paste below query in log analytics, click on Save button and select as Function from drop down by specifying function name and alias as BoxEvents.
// Function usually takes 10-15 minutes to activate. You can then use function alias from any other queries (e.g. BoxEvents | take 10).
// Reference : Using functions in Azure monitor log queries : https://docs.microsoft.com/azure/azure-monitor/log-query/functions
BoxEvents_CL
| extend
    created_by_id_s=column_ifexists('created_by_id_s', ''),
    created_by_login_s=column_ifexists('created_by_login_s', ''),
    created_by_name_s=column_ifexists('created_by_name_s', ''),
    event_type_s=column_ifexists('event_type_s', ''),
    session_id_s=column_ifexists('session_id_s', ''),
    created_at_t=column_ifexists('created_at_t', ''),
    ip_address_s=column_ifexists('ip_address_s', ''),
    source_parent_name_s=column_ifexists('source_parent_name_s', ''),
    additional_details_size_d=column_ifexists('additional_details_size_d', '')
| project-rename
    SrcUserSid=created_by_id_s,
    SrcUserUpn=created_by_login_s,
    SrcUserName=created_by_name_s,
    EventType=event_type_s,
    UserSessionId=session_id_s,
    EventEndTime=created_at_t,
    SrcIpAddr=ip_address_s,
    FileDirectory=source_parent_name_s,
    FileSize=additional_details_size_d