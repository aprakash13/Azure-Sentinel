id: f64c43c5-940f-4bff-aa4f-96c408f9037d
name: Cognni High Risk Incidents
description: |
  'This query identifies high risk Cognni incidents, incoming events with Severity == 3'
severity: High
requiredDataConnectors:
  - connectorId: CognniSentinelDataConnector
    dataTypes:
      - CognniIncidents_CL
queryFrequency: 5h
queryPeriod: 5h
triggerOperator: gt
triggerThreshold: 0
tactics:
  - Collection
relevantTechniques:
  - T1530
query: |
  let highRisk = 3;
  union CognniIncidents_CL 
  | where Severity == highRisk
  | where TimeGenerated >= ago(5h)
  | extend AccountCustomEntity = userId_s
entityMappings:
  - entityType: Account
    fieldMappings:
      - identifier: FullName
        columnName: AccountCustomEntity
