id: 4f0c91c3-1690-48f0-b538-4282dd5417a4
name: McAfee ePO - Update failed
description: |
  'Detects when update failed event occurs.'
severity: Medium
requiredDataConnectors:
  - connectorId: McAfeeePO
    dataTypes:
      - Syslog
queryFrequency: 1h
queryPeriod: 1h
triggerOperator: gt
triggerThreshold: 0
tactics:
  - DefenseEvasion
query: |
  let lbtime = 1h;
  McAfeeEPOEvent
  | where TimeGenerated > ago(lbtime)
  | where EventId in ('2402', '1119', '1123')
  | extend IPCustomEntity = DvcIpAddr, HostCustomEntity = DvcHostname
entityMappings:
  - entityType: IP
    fieldMappings:
      - identifier: Address
        columnName: IPCustomEntity
  - entityType: Host
    fieldMappings:
      - identifier: FullName
        columnName: HostCustomEntity
