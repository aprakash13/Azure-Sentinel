id: ab352f0d-7c55-4ab2-a22e-b1c2d995e193
name: OracleDBAudit - SQL injection patterns
description: |
  'Detects common known SQL injection patterns used in automated scripts.'
severity: Medium
requiredDataConnectors:
  - connectorId: OracleDatabaseAudit
    dataTypes:
      - Syslog
queryFrequency: 10m
queryPeriod: 10m
triggerOperator: gt
triggerThreshold: 0
tactics:
  - InitialAccess
query: |
  let lbtime = 10m;
  OracleDatabaseAuditEvent
  | where TimeGenerated > ago(lbtime)
  | where isnotempty(DstUserName)
  | where Action contains "admin' --" or Action contains "admin' #" or Action contains "admin'/*" or Action contains "0=1" or Action contains "1=0" or Action contains "1=1" or Action contains "1=2" or Action contains "' or 1=1--" or Action contains "' or 1=1#" or Action contains "' or 1=1/*" or Action contains "') or '1'='1--" or Action contains "') or ('1'='1--"
  | project SrcIpAddr, DstUserName, Action
  | extend AccountCustomEntity = DstUserName
  | extend IPCustomEntity = SrcIpAddr
entityMappings:
  - entityType: Account
    fieldMappings:
      - identifier: FullName
        columnName: AccountCustomEntity
  - entityType: IP
    fieldMappings:
      - identifier: Address
        columnName: IPCustomEntity