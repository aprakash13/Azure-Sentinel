# Import Azure Sentinel Analytics Rules
*Author: Tiander Turpijn - Microsoft*
<br/><br/>

**Objective:** Import Analytics Rules to an existing Azure Sentinel Workspace <br/>


This sample imports 3 kinds Azure Sentinel Analytics Rules:
* Scheduled 
* MicrosoftSecurityIncidentCreation
* Fusion

> Note: ML Behavior Analytics rules are during this preview not supported, but will be supported upon GA

### Requirements
The script assumes (and validates) that you have previously exported your rules to a specific local folder.<br/>
A separate file should exist per rule kind, as for example, generated by [this sample script](https://github.com/Azure/Azure-Sentinel/tree/master/Tools/Az.SecurityInsights-Samples/Alert%20Rules/Export%20Analytics%20Rules). 
<br/><br/>

#### Script Parameters
The script will prompt you for the following parameter values:
* *subscriptionId* - the subscription ID where your Azure Sentinel workspace resides in
* *resourceGroupName* - the Azure resource group name where the Azure Sentinel workspace resides in
* *workspaceName* - the name of the Azure Sentinel workspace
* *ruleImportPath* - the name of the folder where your rule files are stored, for example **c:\SentinelRules\Export**
* *ScheduleRules* - the name of your JSON file which holds your Schedules rules, for example **ScheduleRules.json**
* *FusionRules* - the name of your JSON file which holds your Fusion rules, for example **Fusion.json**
* *SecurityIncidentCreationRules* - the name of your JSON file which holds your Microsoft Security Incident Creation Rules, for example **SecurityIncidentCreationRules.json**
<br/><br/>

**Prerequisites:**
The following Azure PowerShell modules are required and will be installed if missing:
* Az.Accounts
* Az.SecurityInsights
<br/><br/>

#### Running the script 
After your have downloaded the sample script, you can run the script with parameters as follows:
```powershell
.\importAzureSentinelRules.ps1 -subscriptionId "382b2a53-c53c-4092-8d4a-7210f6a44a0c" -resourceGroupName "mySentinelRG" -workspaceName "Sentinelworkspace" -ruleImportPath "C:\SentinelRules\Import" -ScheduleRules "Scheduled.json" `
-FusionRules "Fusion.json" -SecurityIncidentCreationRules "MicrosoftSecurityIncidentCreation.json"
```









